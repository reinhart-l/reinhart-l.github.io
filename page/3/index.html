<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Across the Cosmos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="I&#39;ve seen things you people wouldn&#39;t believe. Attack ships on fire off the shoulder of Orion. I watched C-beams glitter in the dark near the Tannhauser Gate. All those moments... will be lost in time.">
<meta property="og:type" content="website">
<meta property="og:title" content="Across the Cosmos">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Across the Cosmos">
<meta property="og:description" content="I&#39;ve seen things you people wouldn&#39;t believe. Attack ships on fire off the shoulder of Orion. I watched C-beams glitter in the dark near the Tannhauser Gate. All those moments... will be lost in time.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Reinhart">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Across the Cosmos" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Across the Cosmos</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-CodeForces Round 730 D1. RPD and Rap Sheet (Easy Version)é¢˜è§£" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/08/CodeForces%20Round%20730%20D1.%20RPD%20and%20Rap%20Sheet%20(Easy%20Version)%E9%A2%98%E8%A7%A3/" class="article-date">
  <time class="dt-published" datetime="2021-07-08T10:26:23.000Z" itemprop="datePublished">2021-07-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/08/CodeForces%20Round%20730%20D1.%20RPD%20and%20Rap%20Sheet%20(Easy%20Version)%E9%A2%98%E8%A7%A3/">CodeForces Round 730 D1. RPD and Rap Sheet (Easy Version)é¢˜è§£</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a href="https://codeforces.com/contest/1543">Codeforces Round #730 (Div. 2)</a></p>
<h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„:"></a>é¢˜æ„:</h2><p>tç»„æ•°æ®,æ¯ç»„ç»™ä¸€ä¸ªnå’Œk,(easy versioné‡Œé¢k&#x3D;2) æ¯ä¸€æ¬¡ç³»ç»Ÿä¼šè¾“å…¥ä¸€ä¸ªåˆå§‹çš„å¯†ç (åˆå§‹å¯†ç æ˜¯ä¸€ä¸ªåœ¨$[0,n-1]$çš„éšæœºå€¼),ä½ å¯ä»¥æœ€å¤šè¾“å‡ºnæ¬¡è¯¢é—®,å¦‚æœçŒœå¯¹äº†å¯†ç ç³»ç»Ÿä¼šè¾“å…¥1,å¦åˆ™è¾“å…¥0.ä½†å¯†ç ä¸æ˜¯ä¸å˜çš„,æ¯æ¬¡ä¼šæ ¹æ®å¦‚ä¸‹å…¬å¼å˜åŒ–<br>$$<br>æ—§å¯†ç \bigoplusæ–°å¯†ç &#x3D;è¯¢é—®å€¼<br>$$</p>
<h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£:"></a>é¢˜è§£:</h2><p>è®¾åˆå§‹å¯†ç ä¸ºX,ç¬¬iæ¬¡è¯¢é—®å€¼ä¸º$P_i$,æ–°å¯†ç ä¸ºY</p>
<p>æ ¹æ®å¼‚æˆ–çš„äº¤æ¢å¾‹å¾—åˆ°<br>$$<br>æ—§å¯†ç \bigoplusæ–°å¯†ç &#x3D;è¯¢é—®å€¼\to æ—§å¯†ç \bigoplusè¯¢é—®å€¼&#x3D;æ–°å¯†ç \to X\bigoplus P_i&#x3D;Y<br>$$<br>æ ¹æ®å¼‚æˆ–çš„ç»“åˆå¾‹<br>$$<br>(((X\bigoplus P_1) \bigoplus P_2 )\bigoplus â€¦ P_i)&#x3D;X\bigoplus (P_1 \bigoplus P_2 \bigoplus â€¦ P_i)<br>$$<br><strong>æ‰€ä»¥å¯ä»¥æŠŠåˆå§‹å¯†ç æ¯æ¬¡å¼‚æˆ–ä¸€ä¸ªè¯¢é—®å€¼å¾—åˆ°ä¸€ä¸ªæ–°å¯†ç ç®€åŒ–ä¸ºæ˜¯åœ¨å¼‚æˆ–äº†ä¸€å †è¯¢é—®å€¼åå¾—åˆ°ä¸€ä¸ªæ–°å¯†ç .</strong></p>
<p>ç°åœ¨æˆ‘ä»¬å‡è®¾$P_i&#x3D;(i-1)\bigoplus P_1 \bigoplus P_2 \bigoplus â€¦ P_{i-1}$</p>
<p>å¯ä»¥å¾—åˆ°<br>$$<br>P_{X+1}&#x3D;X\bigoplus (P_1 \bigoplus P_2 \bigoplus â€¦ P_i\bigoplusâ€¦ P_{X})<br>$$<br>æˆ‘ä»¬æƒŠå¥‡çš„å‘ç°åˆå§‹å¯†ç Xå¼‚æˆ–ä¸Šå‰Xä¸ªè¯¢é—®çš„å€¼å°±æ˜¯<br>$$<br>X\bigoplus (P_1 \bigoplus P_2 \bigoplus â€¦ P_i\bigoplusâ€¦ P_{X})<br>$$<br>æ‰€ä»¥è¯¢é—®åˆ°ç¬¬X+1æ¬¡æ—¶å…¶è¯¢é—®å€¼ä¸€å®šç­‰äºå½“å‰å¯†ç çš„å€¼</p>
<p>è¿˜å¯ä»¥æƒ³åˆ°å¦ä¸€ç§<br>$$<br>P_1&#x3D;0\P_i&#x3D;(i-1)\bigoplus(i-2) \ 2&lt;&#x3D;i&lt;&#x3D;n<br>$$<br>å› ä¸º<br>$$<br>ç¬¬X+1æ¬¡è¯¢é—®:P_{X+1}&#x3D;X\bigoplus(X-1)\<br>è€Œåˆå§‹å¯†ç åœ¨ç»è¿‡Xæ¬¡è¯¢é—®ç­‰äºX\bigoplus(0\bigoplus1\bigoplus 2\bigoplus1\bigoplus3\bigoplus2\bigoplusâ€¦X-1\bigoplus X-2)\to X\bigoplus(X-1)<br>$$<br>æ‰€ä»¥è¯¢é—®åˆ°ç¬¬X+1æ¬¡ä¹Ÿå¯ä»¥å¾—åˆ°å½“å‰å¯†ç å€¼</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç :"></a>ä»£ç :</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="type">int</span> n, k;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>)cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                cout&lt;&lt;((i<span class="number">-1</span>)^(i<span class="number">-2</span>))&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> res;</span><br><span class="line">            cin &gt;&gt; res;</span><br><span class="line">            <span class="keyword">if</span> (res == <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/08/CodeForces%20Round%20730%20D1.%20RPD%20and%20Rap%20Sheet%20(Easy%20Version)%E9%A2%98%E8%A7%A3/" data-id="cmb2ap956000748ucfjf6cepn" data-title="CodeForces Round 730 D1. RPD and Rap Sheet (Easy Version)é¢˜è§£" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">é¢˜è§£</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Cisco Packet Tracer åˆ›å»ºè™šæ‹Ÿå±€åŸŸç½‘ _ é…ç½®é™æ€è·¯ç”± _ é…ç½®RIPåè®®" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/06/04/Cisco%20Packet%20Tracer%20%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%20_%20%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%20_%20%E9%85%8D%E7%BD%AERIP%E5%8D%8F%E8%AE%AE/" class="article-date">
  <time class="dt-published" datetime="2021-06-04T10:18:53.000Z" itemprop="datePublished">2021-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/06/04/Cisco%20Packet%20Tracer%20%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%20_%20%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%20_%20%E9%85%8D%E7%BD%AERIP%E5%8D%8F%E8%AE%AE/">Cisco Packet Tracer åˆ›å»ºè™šæ‹Ÿå±€åŸŸç½‘ | é…ç½®é™æ€è·¯ç”± | é…ç½®RIPåè®®</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="è™šæ‹Ÿå±€åŸŸç½‘"><a href="#è™šæ‹Ÿå±€åŸŸç½‘" class="headerlink" title="è™šæ‹Ÿå±€åŸŸç½‘"></a>è™šæ‹Ÿå±€åŸŸç½‘</h2><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819966.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="PC0é…ç½®"><a href="#PC0é…ç½®" class="headerlink" title="PC0é…ç½®"></a><strong>PC0é…ç½®</strong></h3><p><img src="https://img-blog.csdnimg.cn/20210604201955803.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1JlaW5oYXJ0X0w=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="PC1é…ç½®"><a href="#PC1é…ç½®" class="headerlink" title="PC1é…ç½®"></a><strong>PC1é…ç½®</strong></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819542.png" alt="image-20220118181959497"></p>
<h3 id="PC2é…ç½®"><a href="#PC2é…ç½®" class="headerlink" title="PC2é…ç½®"></a><strong>PC2é…ç½®</strong></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819015.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="Switch0é…ç½®"><a href="#Switch0é…ç½®" class="headerlink" title="Switch0é…ç½®"></a><strong>Switch0é…ç½®</strong></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181820475.png" alt="image-20220118182016420"></p>
<h3 id="switch1é…ç½®"><a href="#switch1é…ç½®" class="headerlink" title="switch1é…ç½®"></a><strong>switch1é…ç½®</strong></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181820031.png" alt="image-20220118182032959"><img src="/" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="æœ€ç»ˆç»“æœ"><a href="#æœ€ç»ˆç»“æœ" class="headerlink" title="æœ€ç»ˆç»“æœ"></a>æœ€ç»ˆç»“æœ</h3><p><strong>PC0å’ŒPC2åŒå±vlan2ï¼ŒPC1å±äºvlan1ï¼Œæ‰€ä»¥PC0å’Œ2å¯ä»¥äº’ç›¸pingé€šï¼Œè€ŒPC0å’ŒPC1pingä¸é€š</strong><br><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819469.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="é™æ€è·¯ç”±é…ç½®"><a href="#é™æ€è·¯ç”±é…ç½®" class="headerlink" title="é™æ€è·¯ç”±é…ç½®"></a>é™æ€è·¯ç”±é…ç½®</h2><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181820467.png" alt="image-20220118182048424"></p>
<h3 id="PC1"><a href="#PC1" class="headerlink" title="PC1"></a>PC1</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819667.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="PC2"><a href="#PC2" class="headerlink" title="PC2"></a>PC2</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181820250.png"></p>
<p>PC1 Fa0&#x2F;0 æ¥å£ $\to$ router1 Fa1&#x2F;0 æ¥å£</p>
<p>PC2 Fa0&#x2F;0 æ¥å£ $\to$ router2 Fa1&#x2F;0 æ¥å£</p>
<p>Router1 serial 2&#x2F;0 $\to$  router2 serial 2&#x2F;0</p>
<h3 id="Router1"><a href="#Router1" class="headerlink" title="Router1"></a>Router1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">         --- System Configuration Dialog ---</span><br><span class="line"></span><br><span class="line">Would you like to enter the initial configuration dialog? [yes/no]: no # é€‰æ‹©no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Press RETURN to get started!</span><br><span class="line"></span><br><span class="line">r1&gt;enable # è¿›å…¥adminæ¨¡å¼</span><br><span class="line">r1#</span><br><span class="line">r1#configure terminal # è¿›å…¥ç®¡ç†ç»ˆç«¯</span><br><span class="line">Enter configuration commands, one per line.  End with CNTL/Z.</span><br><span class="line">r1(config)#interface FastEthernet1/0 # è¿›å…¥ç«¯å£1/0</span><br><span class="line">r1(config-if)#ip address 192.168.1.1 255.255.255.0 # é…ç½®ç«¯å£çš„ipåœ°å€</span><br><span class="line">r1(config-if)#no shutdown # å¼€å¯æ­¤ç«¯å£,ä½¿å®ƒè½¬å‘æ•°æ®</span><br><span class="line">%LINK-5-CHANGED: Interface FastEthernet1/0, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0, changed state to up</span><br><span class="line"></span><br><span class="line">r1(config-if)#exit # é€€å‡º</span><br><span class="line"></span><br><span class="line">r1(config)#interface serial 2/0 # è¿›å…¥S2/0ç«¯å£æ¨¡å¼</span><br><span class="line">r1(config-if)#no shutdown # å¼€å¯æ­¤ç«¯å£</span><br><span class="line"></span><br><span class="line">%LINK-5-CHANGED: Interface Serial2/0, changed state to down</span><br><span class="line">r1(config-if)#ip address 192.168.2.1 255.255.255.0 # é…ç½®æ­¤ç«¯å£çš„ipåœ°å€</span><br><span class="line">r1(config-if)#clock rate 9600 # é…ç½®æ­¤ç«¯å£çš„æ—¶é’Ÿé€Ÿç‡</span><br><span class="line">r1(config-if)#exit # é€€å‡º</span><br><span class="line"></span><br><span class="line">r1(config)#ip route 192.168.3.0 255.255.255.0 192.168.2.2 # é…ç½®é™æ€è·¯ç”±</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="router2"><a href="#router2" class="headerlink" title="router2"></a>router2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">         --- System Configuration Dialog ---</span><br><span class="line"></span><br><span class="line">Would you like to enter the initial configuration dialog? [yes/no]: no # é€‰æ‹©no</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Press RETURN to get started!</span><br><span class="line"></span><br><span class="line">r1&gt;enable # è¿›å…¥adminæ¨¡å¼</span><br><span class="line">r1#</span><br><span class="line">r1#configure terminal # è¿›å…¥ç®¡ç†ç»ˆç«¯</span><br><span class="line">Enter configuration commands, one per line.  End with CNTL/Z.</span><br><span class="line">r1(config)#interface FastEthernet1/0 # è¿›å…¥ç«¯å£1/0</span><br><span class="line">r1(config-if)#ip address 192.168.3.1 255.255.255.0 # é…ç½®ç«¯å£çš„ipåœ°å€</span><br><span class="line">r1(config-if)#no shutdown # å¼€å¯æ­¤ç«¯å£,ä½¿å®ƒè½¬å‘æ•°æ®</span><br><span class="line">%LINK-5-CHANGED: Interface FastEthernet1/0, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0, changed state to up</span><br><span class="line"></span><br><span class="line">r1(config-if)#exit # é€€å‡º</span><br><span class="line"></span><br><span class="line">r1(config)#interface serial 2/0 # è¿›å…¥S2/0ç«¯å£æ¨¡å¼</span><br><span class="line">r1(config-if)#no shutdown # å¼€å¯æ­¤ç«¯å£</span><br><span class="line"></span><br><span class="line">%LINK-5-CHANGED: Interface Serial2/0, changed state to down</span><br><span class="line">r1(config-if)#ip address 192.168.2.2 255.255.255.0 # é…ç½®æ­¤ç«¯å£çš„ipåœ°å€</span><br><span class="line">r1(config-if)#exit # é€€å‡º</span><br><span class="line"></span><br><span class="line">r1(config)#ip route 192.168.1.0 255.255.255.0 192.168.2.1 # é…ç½®é™æ€è·¯ç”±</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181821878.png" alt="image-20220118182107838"></p>
<h3 id="ç‰¹åˆ«æ³¨æ„ï¼š"><a href="#ç‰¹åˆ«æ³¨æ„ï¼š" class="headerlink" title="ç‰¹åˆ«æ³¨æ„ï¼š"></a>ç‰¹åˆ«æ³¨æ„ï¼š</h3><ul>
<li>çœŸæœºå®éªŒä¸€å®šè¦å…³é—­é˜²ç«å¢™</li>
<li>DTEçº¿ä¸ç”¨è°ƒèŠ‚æ—¶é’Ÿé¢‘ç‡(clock rate) ,DCEçº¿éœ€è¦</li>
</ul>
<h3 id="é™æ€è·¯ç”±é…ç½®å®éªŒå‚è€ƒåšå®¢ï¼š"><a href="#é™æ€è·¯ç”±é…ç½®å®éªŒå‚è€ƒåšå®¢ï¼š" class="headerlink" title="é™æ€è·¯ç”±é…ç½®å®éªŒå‚è€ƒåšå®¢ï¼š"></a>é™æ€è·¯ç”±é…ç½®å®éªŒå‚è€ƒåšå®¢ï¼š</h3><p><a href="https://blog.csdn.net/Muyunuu/article/details/117045655">https://blog.csdn.net/Muyunuu/article/details/117045655</a></p>
<h2 id="ripé…ç½®"><a href="#ripé…ç½®" class="headerlink" title="ripé…ç½®"></a>ripé…ç½®</h2><ul>
<li>åªéœ€åˆ é™¤é™æ€è·¯ç”±å®éªŒä¸­åˆ›å»ºçš„è·¯ç”±è¡¨ï¼Œå†å°†å…¶ä¿®æ”¹æˆRIPåè®®å³å¯</li>
</ul>
<h3 id="Router1-1"><a href="#Router1-1" class="headerlink" title="Router1"></a>Router1</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819967.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="Router2"><a href="#Router2" class="headerlink" title="Router2"></a>Router2</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819988.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="ç»“æœ-1"><a href="#ç»“æœ-1" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181819000.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/06/04/Cisco%20Packet%20Tracer%20%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%20_%20%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%20_%20%E9%85%8D%E7%BD%AERIP%E5%8D%8F%E8%AE%AE/" data-id="cmb2ap955000648ucgr4833do" data-title="Cisco Packet Tracer åˆ›å»ºè™šæ‹Ÿå±€åŸŸç½‘ | é…ç½®é™æ€è·¯ç”± | é…ç½®RIPåè®®" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">æ•™ç¨‹</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">è®¡ç®—æœºç½‘ç»œ</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Reinhart&#39;s problem set" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/17/Reinhart's%20problem%20set/" class="article-date">
  <time class="dt-published" datetime="2021-01-16T16:48:47.000Z" itemprop="datePublished">2021-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/17/Reinhart's%20problem%20set/">Reinhart&#39;s problem set</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><h2 id="æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹"><a href="#æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹" class="headerlink" title="æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹"></a>æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹</h2><h3 id="åºåˆ—æœ€å¤§æ”¶ç›Š"><a href="#åºåˆ—æœ€å¤§æ”¶ç›Š" class="headerlink" title="åºåˆ—æœ€å¤§æ”¶ç›Š"></a><a href="https://www.acwing.com/problem/content/3502/">åºåˆ—æœ€å¤§æ”¶ç›Š</a></h3><h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç›¸é‚»å…ƒç´ çš„å€¼åˆ†åˆ«ä¸ºå¯ä»¥è·å¾—æ”¶ç›Šç°åœ¨ç»™ä¸€ä¸ªåºåˆ—,å¯ä»¥åˆ é™¤æœ€å¤škä¸ªå…ƒç´ ä½¿å¾—è¿™ä¸ªåºåˆ—çš„æ”¶ç›Šä¹‹å’Œæœ€å¤§.</p>
<h4 id="çŠ¶æ€è¡¨ç¤º"><a href="#çŠ¶æ€è¡¨ç¤º" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h4><h5 id="é›†åˆdp-i-j"><a href="#é›†åˆdp-i-j" class="headerlink" title="é›†åˆdp[i][j]"></a>é›†åˆdp[i][j]</h5><ul>
<li>è¡¨ç¤ºåªè€ƒè™‘å‰iä¸ªæ•°ï¼Œå…±åˆ é™¤äº†jä¸ªæ•°ï¼Œä¸”ç¬¬iä¸ªæ•°æ²¡è¢«åˆ æ‰</li>
</ul>
<h5 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h5><ul>
<li>æœ€å¤§å€¼</li>
</ul>
<h4 id="çŠ¶æ€è®¡ç®—"><a href="#çŠ¶æ€è®¡ç®—" class="headerlink" title="çŠ¶æ€è®¡ç®—"></a>çŠ¶æ€è®¡ç®—</h4><p>å‚è€ƒæœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹</p>
<ul>
<li><p>ä»¥ç¬¬içš„å‰ä¸€ä¸ªæ•°ä½œä¸ºåˆ’åˆ†æ¡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181242366.png" alt="image-20210516112707913"></p>
</li>
</ul>
<p>içš„å‰ä¸€ä¸ªæ•°æœ‰å¯èƒ½ä¸å­˜åœ¨ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç¬¬1ä¸ªæ•°â€¦ç¬¬i-1ä¸ªæ•°</p>
<p>æ‰€ä»¥å¾—å‡ºæ­¤å›¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050474.png" alt="image-20210516132250608"></p>
<p>1ï½Kä¸­è¿˜æœ‰j-(i-k-1)ä¸ªæ•°æ²¡åˆ ï¼Œè€Œç”±äºå³è¾¹çš„å€¼å·²ç»ç¡®å®šï¼ˆå°±æ˜¯ï¼‰æ‰€ä»¥æ ¹æ®å‰é¢çŠ¶æ€è¡¨ç¤ºçš„å®šä¹‰å¯ä»¥å¾—å‡º<br>$$<br>dp[k,j-(i-k-1)]+w[a_k,a_j]<br>$$</p>
<h4 id="è¾¹ç•Œé—®é¢˜"><a href="#è¾¹ç•Œé—®é¢˜" class="headerlink" title="è¾¹ç•Œé—®é¢˜"></a>è¾¹ç•Œé—®é¢˜</h4><p>ç¬¬ä¸€ä¸ªæ•°å’Œæœ€åä¸€ä¸ªæ•°æ˜¯ä¸ç”¨åˆ çš„ï¼Œå› ä¸ºæ˜¯&gt;&#x3D;0çš„æ•°ï¼Œä¸”1çš„å·¦è¾¹ï¼Œnçš„å³è¾¹éƒ½å·²ç»æ²¡æœ‰æ•°å­—äº†ï¼Œåˆ é™¤1æˆ–nåä¸ä¼šäº§ç”Ÿæ–°çš„æ•°å­—ç»„åˆï¼Œå¯¼è‡´ç­”æ¡ˆåªå‡ä¸å¢ã€‚</p>
<h3 id="E-Equal-Sentences"><a href="#E-Equal-Sentences" class="headerlink" title="E - Equal Sentences"></a><a href="https://vjudge.net/problem/HDU-6806">E - Equal Sentences</a></h3><h4 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä¸€æ®µè¯Sï¼Œæ¯æ®µè¯æœ‰nä¸ªè¯ï¼Œç»™å®šå¦ä¸€æ®µè¯Tï¼Œè¿™æ®µè¯æ‰€åŒ…å«çš„è¯ä»¥åŠå’ŒSæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå”¯ä¸€ä¸åŒçš„å°±æ˜¯è¯çš„é¡ºåºï¼ŒT[i]å’ŒS[i]ä¸åŒä½†åªèƒ½åœ¨çš„èŒƒå›´å†…ä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´S[i]å¿…é¡»è¦åœ¨T[i-1,i+1]å†…æ‰¾åˆ°å’ŒS[i]ç›¸åŒçš„è¯ï¼Œè¿™æ ·å°±ç®—æ˜¯Tå’ŒS almost equalï¼ˆåŒ…å«Sè‡ªå·±ï¼‰é—®èƒ½æ‰¾åˆ°å¤šå°‘ä¸ªè¿™æ ·çš„T</p>
<h4 id="åˆæ­¥ç†è§£"><a href="#åˆæ­¥ç†è§£" class="headerlink" title="åˆæ­¥ç†è§£"></a>åˆæ­¥ç†è§£</h4><p>ä¸éš¾å‘ç°åªè¦å°†Sç›¸é‚»ä¸¤ä¸ªè¯äº¤æ¢ä½ç½®å°±å¯ä»¥å¾—åˆ°ä¸€ç§æƒ…å†µï¼Œå¹¶ä¸”å¦‚æœç›¸é‚»ä¸¤ä¸ªè¯è‹¥æ˜¯ç›¸åŒçš„äº¤æ¢å®ƒä»¬ä¸ä¼šå¢åŠ æ–¹æ¡ˆæ•°</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050562.png" alt="image-20210518005024148"></p>
<h4 id="çŠ¶æ€è¡¨ç¤º-1"><a href="#çŠ¶æ€è¡¨ç¤º-1" class="headerlink" title="çŠ¶æ€è¡¨ç¤º"></a>çŠ¶æ€è¡¨ç¤º</h4><h5 id="é›†åˆdp-i"><a href="#é›†åˆdp-i" class="headerlink" title="é›†åˆdp[i]"></a>é›†åˆdp[i]</h5><ul>
<li>é•¿åº¦ä¸ºiçš„æ‰€æœ‰æ–¹æ¡ˆæ•°</li>
</ul>
<h5 id="å±æ€§-1"><a href="#å±æ€§-1" class="headerlink" title="å±æ€§"></a>å±æ€§</h5><ul>
<li>æ–¹æ¡ˆæ•°</li>
</ul>
<h4 id="çŠ¶æ€è®¡ç®—-1"><a href="#çŠ¶æ€è®¡ç®—-1" class="headerlink" title="çŠ¶æ€è®¡ç®—"></a>çŠ¶æ€è®¡ç®—</h4><p>å‚è€ƒæœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹</p>
<p>ä»¥içš„å‰ä¸€ä¸ªå­—ç¬¦ä½œä¸ºåˆ’åˆ†æ¡ä»¶</p>
<p>å¦‚æœå‰ä¸€ä¸ªå­—ç¬¦(s[i-1])å’Œs[i]ç›¸ç­‰ï¼Œé‚£å¦‚æœs[i]å’Œs[i-1]äº¤æ¢ä¸ä¼šå¢åŠ æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥dp[i]&#x3D;dp<a href="%E9%95%BF%E5%BA%A6%E4%B8%BAi%E7%9A%84%E6%89%80%E6%9C%89%E6%96%B9%E6%A1%88%E6%95%B0%E5%B0%B1%E7%AD%89%E4%BA%8E%E9%95%BF%E5%BA%A6%E4%B8%BAi-1%E7%9A%84%E6%89%80%E6%9C%89%E6%96%B9%E6%A1%88%E6%95%B0">i-1</a></p>
<p>å¦‚æœå‰ä¸€ä¸ªå­—ç¬¦å’Œs[i]ä¸ç›¸ç­‰ï¼Œs[i]å’Œs[i-1]äº¤æ¢ä¼šå¢åŠ æ–¹æ¡ˆæ•°ï¼Œs[i]å’Œs[i-1]äº¤æ¢ås[i-1]å˜ä¸ºs[i]ï¼Œæ‰€ä»¥åˆæ–°å¢äº†dp[i-2]çš„æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥dp[i]&#x3D;dp[i-1]+dp[i-2]</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod =<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="type">int</span> dp[N];</span><br><span class="line">string s[<span class="number">100005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>();</span><br><span class="line">    cin.<span class="built_in">tie</span>();</span><br><span class="line">    cout.<span class="built_in">tie</span>();</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin&gt;&gt;t;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">            cin&gt;&gt;s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==s[i<span class="number">-1</span>])dp[i]=dp[i<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i]=(dp[i<span class="number">-1</span>]+dp[i<span class="number">-2</span>])%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;dp[n]%mod&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="çŠ¶æ€æœºæ¨¡å‹"><a href="#çŠ¶æ€æœºæ¨¡å‹" class="headerlink" title="çŠ¶æ€æœºæ¨¡å‹"></a>çŠ¶æ€æœºæ¨¡å‹</h2><h3 id="C-Hills"><a href="#C-Hills" class="headerlink" title="C.Hills"></a><a href="https://blog.csdn.net/weixin_30737363/article/details/94926310">C.Hills</a></h3><h4 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç°åœ¨æœ‰ n åº§è¿åœ¨ä¸€èµ·çš„å±±ï¼Œé«˜åº¦ä»å·¦åˆ°å³åˆ†åˆ«ä¸ºã€‚ç°åœ¨ä½ æœ‰ä¸€å°æŒ–æ˜æœºï¼Œæ¯åˆ†é’Ÿå¯ä»¥ä»¤æŸä¸€ä¸ª å‡ä¸€ã€‚ä½ å¯ä»¥åœ¨ ä¸”  çš„å±±å³° ç›–æˆ¿å­ã€‚é—®å¯¹äº ä¸­çš„æ¯ä¸ªæ•´æ•° ï¼Œç›–  æ ‹æˆ¿å­è‡³å°‘éœ€è¦å¤šé•¿æ—¶é—´ã€‚<img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/20211113125748.png" alt="æˆªå±2021-11-13 12.57.38"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Min</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x:y;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Max</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&gt;y?x:y;&#125;</span><br><span class="line"><span class="type">int</span> h[<span class="number">5050</span>];</span><br><span class="line"><span class="type">int</span> f[<span class="number">5050</span>][<span class="number">5050</span>][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;h[i]);</span><br><span class="line">    h[<span class="number">0</span>]=<span class="number">0x3fffffff</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        f[i][<span class="number">0</span>][<span class="number">0</span>]=f[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=(i+<span class="number">1</span>)/<span class="number">2</span>;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i][j][<span class="number">1</span>]=<span class="built_in">Min</span>(f[i<span class="number">-2</span>][j<span class="number">-1</span>][<span class="number">0</span>]+<span class="built_in">Max</span>(<span class="number">0</span>,h[i<span class="number">-1</span>]-h[i]+<span class="number">1</span>),</span><br><span class="line">                           f[i<span class="number">-2</span>][j<span class="number">-1</span>][<span class="number">1</span>]+<span class="built_in">Max</span>(<span class="number">0</span>,h[i<span class="number">-1</span>]-<span class="built_in">Min</span>(h[i],h[i<span class="number">-2</span>])+<span class="number">1</span>));</span><br><span class="line">            f[i][j][<span class="number">0</span>]=<span class="built_in">Min</span>(f[i<span class="number">-1</span>][j][<span class="number">0</span>],</span><br><span class="line">                           f[i<span class="number">-1</span>][j][<span class="number">1</span>]+<span class="built_in">Max</span>(<span class="number">0</span>,h[i]-h[i<span class="number">-1</span>]+<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=(n+<span class="number">1</span>)/<span class="number">2</span>;++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,<span class="built_in">Min</span>(f[n][i][<span class="number">0</span>],f[n][i][<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="C-Unstable-String"><a href="#C-Unstable-String" class="headerlink" title="C. Unstable String"></a><a href="https://codeforces.com/contest/1535/problem/C">C. Unstable String</a></h3><h4 id="é¢˜æ„-3"><a href="#é¢˜æ„-3" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>t ç»„è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®šä¸€ä¸ªä»…åŒ…å«å­—ç¬¦11 æˆ– 00 æˆ– ?? å­—ç¬¦ä¸²sã€‚å®šä¹‰ä¸€ä¸ªå­ä¸²æ˜¯ä¸ç¨³å®šçš„å½“ä¸”ä»…å½“å­ä¸²ä¸­ä»»æ„ç›¸é‚»ä¸¤æ•°å‡ä¸ç›¸åŒï¼Œå¦‚ 101010â€¦101010â€¦æˆ– 010101â€¦010101â€¦ã€‚å…¶ä¸­ ? å¯ä»¥å˜ä¸º 11 æˆ– 00 å…¶ä¸­ä¸€ç§ã€‚è¯·æ±‚å‡ºç»™å®šçš„ ğ‘ s ä¸­æœ€å¤šå¯ä»¥æœ‰çš„ä¸ç¨³å®šå­ä¸²ä¸ªæ•°ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="type">int</span> dp[<span class="number">200005</span>][<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;;<span class="comment">//dp[i][0]è¡¨ç¤ºä»¥iç»“å°¾çš„ä¸²ï¼Œå¹¶ä¸”s[i]æ˜¯0ï¼Œæœ‰å¤šå°‘ç§ç¬¦åˆè¦æ±‚çš„ä¸²</span></span><br><span class="line">      <span class="comment">////dp[i][1]è¡¨ç¤ºä»¥iç»“å°¾çš„ä¸²ï¼Œå¹¶ä¸”s[i]æ˜¯1ï¼Œæœ‰å¤šå°‘ç§ç¬¦åˆè¦æ±‚çš„ä¸²</span></span><br><span class="line">      <span class="comment">//è‹¥s[i]æ˜¯é—®å·åˆ™å–dp[i][1]å’Œdp[i][0]çš„æœ€å¤§å€¼ï¼ˆçœ‹æŠŠs[i]æ¢æˆ1è¿˜æ˜¯æ¢æˆ0èƒ½å–å¾—æ›´å¤šçš„ç¬¦åˆè¦æ±‚çš„ä¸²ï¼‰</span></span><br><span class="line">        <span class="type">char</span> s[<span class="number">200005</span>];</span><br><span class="line">        cin &gt;&gt; (s + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        for(int i=1;i&lt;=n;i++)&#123;</span></span><br><span class="line"><span class="comment">//            if(s[i]==&#x27;?&#x27;)</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==<span class="string">&#x27;1&#x27;</span>)dp[i][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">&#x27;0&#x27;</span>)dp[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][<span class="number">1</span>]=dp[i][<span class="number">0</span>]=<span class="number">1</span>; <span class="comment">//?å¯ä»¥å˜æˆ0æˆ–1</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout&lt;&lt;(s+1)&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==<span class="string">&#x27;0&#x27;</span>)dp[i][<span class="number">0</span>]=dp[i<span class="number">-1</span>][<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">&#x27;1&#x27;</span>)dp[i][<span class="number">1</span>]=dp[i<span class="number">-1</span>][<span class="number">0</span>]+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][<span class="number">1</span>]=dp[i<span class="number">-1</span>][<span class="number">0</span>]+<span class="number">1</span>;</span><br><span class="line">                dp[i][<span class="number">0</span>]=dp[i<span class="number">-1</span>][<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</span><br><span class="line">            ans += <span class="built_in">max</span>(dp[i][<span class="number">0</span>], dp[i][<span class="number">1</span>]);<span class="comment">//é¢˜ç›®é»˜è®¤è¦æ±‚å°†?æœ€ä¼˜çš„å˜æˆ0æˆ–1</span></span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="C-Gas-Pipeline"><a href="#C-Gas-Pipeline" class="headerlink" title="C. Gas Pipeline"></a><a href="https://codeforces.com/problemset/problem/1207/C">C. Gas Pipeline</a></h3><h4 id="é¢˜æ„-4"><a href="#é¢˜æ„-4" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>äºŒè¿›åˆ¶01ä¸²ã€‚ä¸º1ä»£è¡¨è¿™ä¸ªåœ°æ–¹å¾—æ˜¯é«˜åº¦ä¸º2çš„æŸ±å­ï¼Œä¸º0ä»£è¡¨å¯ä»¥ä¸ºé«˜åº¦ä¸º1æˆ–è€…2çš„æŸ±å­ã€‚èµ·ç‚¹å’Œç»ˆç‚¹æŸ±å­é«˜åº¦éƒ½ä¸º1ã€‚åŒæ—¶æ¨ªå‘èµ°çš„æ—¶å€™éœ€è¦ç®¡é“ã€‚æŸ±å­çš„å•ä½èŠ±è´¹æ˜¯bï¼Œç®¡é“çš„å•ä½èŠ±è´¹æ˜¯aã€‚é—®æ€ä¹ˆå®‰æ’ä½¿å¾—èŠ±è´¹æœ€å°</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m, t;</span><br><span class="line">ll dp[N][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//s[i]æ˜¯ç¬¬iä¸ªæ ¼å­ dp[i][2]æ˜¯ç¬¬iæ ¹æŸ±å­ nä¸ªæ ¼å­ n+1æ ¹æŸ±å­</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">char</span> s[N];</span><br><span class="line">    ll a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b &gt;&gt; s;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dp);</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = b;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">&#x27;0&#x27;</span>) &#123;</span><br><span class="line">            dp[i + <span class="number">1</span>][<span class="number">1</span>] = <span class="built_in">min</span>(dp[i][<span class="number">1</span>] + a + <span class="number">2</span> * b, dp[i][<span class="number">0</span>] + <span class="number">2</span> * a + <span class="number">2</span> * b);</span><br><span class="line">            dp[i + <span class="number">1</span>][<span class="number">0</span>] = <span class="built_in">min</span>(dp[i][<span class="number">1</span>] + <span class="number">2</span> * a + b, dp[i][<span class="number">0</span>] + a + b);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dp[i + <span class="number">1</span>][<span class="number">1</span>] = dp[i][<span class="number">1</span>] + a + <span class="number">2</span> * b;<span class="comment">//å¦‚æœç¬¬iä¸ªæ ¼å­ä¸º1 ç¬¬iæ ¹æŸ±å­ä¸å¯èƒ½ä¸º1ä¸ªå•ä½</span></span><br><span class="line">            dp[i + <span class="number">1</span>][<span class="number">0</span>] = LLINF;<span class="comment">//å¦‚æœç¬¬iä¸ªæ ¼å­ä¸º1 ç¬¬i+1æ ¹æŸ±å­ä¸å¯èƒ½ä¸º1ä¸ªå•ä½</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[n][<span class="number">0</span>]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    t = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å…¬å…±å­åºåˆ—æ¨¡å‹"><a href="#å…¬å…±å­åºåˆ—æ¨¡å‹" class="headerlink" title="å…¬å…±å­åºåˆ—æ¨¡å‹"></a>å…¬å…±å­åºåˆ—æ¨¡å‹</h2><h3 id="PTA-ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æœ€é•¿å…¬å…±å­åºåˆ—"><a href="#PTA-ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æœ€é•¿å…¬å…±å­åºåˆ—" class="headerlink" title="PTA ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æœ€é•¿å…¬å…±å­åºåˆ—"></a><a href="https://pintia.cn/problem-sets/1719377570499891200/exam/problems/1719377856505286656?type=7&page=0">PTA ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æœ€é•¿å…¬å…±å­åºåˆ—</a></h3><h4 id="é¢˜æ„-5"><a href="#é¢˜æ„-5" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æ±‚å‡ºæ‰€æœ‰çš„å…¬å…±å­åºåˆ—ï¼Œå¦‚æœæ²¡æœ‰è¾“å‡ºNO</p>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>ä»<code>DP[n][m]</code>å€’å™å¾€åæ‰¾</p>
<ul>
<li>è‹¥<code>a[i] b[j]</code>ç›¸ç­‰ï¼Œé‚£è¿™ä¸€ä½åˆ™æ˜¯LCSä¸­çš„ä¸€ä½ï¼Œç„¶åé€’æ¨åˆ°<code>i-1 j-1</code></li>
<li>è‹¥<code>a[i] b[j]</code>ä¸ç›¸ç­‰ï¼Œåˆ™éœ€è¦æ¯”è¾ƒ<code>DP[i-1][j] DP[i][j-1]</code>å¤§å°<ul>
<li>è‹¥<code>DP[i-1][j]!=D[i][j-1]</code>åˆ™å¾€è¾ƒé•¿çš„é‚£ä¸ªè¿›è¡Œé€’æ¨</li>
<li>è‹¥<code>DP[i-1][j]==D[i][j-1]</code>åˆ™ä¸¤ä¸ªéƒ½è¿›è¡Œé€’æ¨</li>
</ul>
</li>
</ul>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">char</span> a[<span class="number">110</span>], b[<span class="number">110</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">110</span>][<span class="number">110</span>], n, m;</span><br><span class="line">set&lt;string&gt; s1;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go_back</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j, string str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &gt;= <span class="number">1</span> &amp;&amp; j &gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i] == b[j]) &#123;</span><br><span class="line">            str = a[i] + str;</span><br><span class="line">            i --, j --;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[i - <span class="number">1</span>][j] &gt; dp[i][j - <span class="number">1</span>]) &#123;</span><br><span class="line">                i --;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(dp[i - <span class="number">1</span>][j] &lt; dp[i][j - <span class="number">1</span>]) &#123;</span><br><span class="line">                j --;</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">go_back</span>(i - <span class="number">1</span>, j, str);</span><br><span class="line">                <span class="built_in">go_back</span>(i, j - <span class="number">1</span>, str);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(str.<span class="built_in">length</span>()) s1.<span class="built_in">insert</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; (a+<span class="number">1</span>) &gt;&gt; (b+<span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(a+<span class="number">1</span>), m = <span class="built_in">strlen</span>(b+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j ++) &#123;</span><br><span class="line">            dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i][j - <span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span>(a[i]==b[j]) dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dp[n][m]==<span class="number">0</span>)cout&lt;&lt;<span class="string">&quot;NO&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">go_back</span>(n, m, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x: s1) &#123;</span><br><span class="line">            cout &lt;&lt; x &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="C-chokudai"><a href="#C-chokudai" class="headerlink" title="C - chokudai"></a><a href="https://atcoder.jp/contests/abc211/tasks/abc211_c?lang=en">C - chokudai</a></h3><h4 id="é¢˜æ„-6"><a href="#é¢˜æ„-6" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç®—å’Œå­ä¸²påŒ¹é…çš„å­åºåˆ—ä¸ªæ•°</p>
<h4 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll a[N], b[N];</span><br><span class="line">ll dp[N][<span class="number">9</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    <span class="type">char</span> s[N];</span><br><span class="line">    <span class="type">char</span> p[] = <span class="string">&quot;@chokudai&quot;</span>;</span><br><span class="line">    cin &gt;&gt; (s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="built_in">strlen</span>(s+<span class="number">1</span>);i++)dp[i][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">strlen</span>(s+<span class="number">1</span>); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">8</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == p[j])dp[i][j] = (dp[i - <span class="number">1</span>][j - <span class="number">1</span>] +dp[i<span class="number">-1</span>][j])%mod;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j]%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;dp[<span class="built_in">strlen</span>(s+<span class="number">1</span>)][<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Nun-Heh-Heh-Aaaaaaaaaaa"><a href="#Nun-Heh-Heh-Aaaaaaaaaaa" class="headerlink" title="Nun Heh Heh Aaaaaaaaaaa"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=7131">Nun Heh Heh Aaaaaaaaaaa</a></h3><h4 id="é¢˜æ„-7"><a href="#é¢˜æ„-7" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€ä¸ªåºåˆ—s,æ±‚å…¶[å‰ç¼€æ˜¯ğš—ğšğš—ğš‘ğšğš‘ğš‘ğšğš‘,åç¼€æ˜¯&gt;&#x3D;1ä¸ªa]çš„å­åºåˆ—ä¸ªæ•°</p>
<h4 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>å…ˆæ±‚å‡ºå­åºåˆ—ä¸ºnunhehhehçš„ä¸ªæ•°,å®šä¹‰dp(i,j)ä¸ºsçš„å‰iä¸ªå­—ç¬¦ä¸­å’ŒnunhehhehåŒ¹é…åˆ°ç¬¬jä¸ªä¸ªæ•°.ç„¶åé¢„å¤„ç†å‡ºiåé¢æœ‰å¤šå°‘ä¸ªa,è®°ä¸ºa[i],å¯¹äºæ¯ä¸ªdp(i,9)ä¹˜å†ç›¸åŠ å³å¯å¾—åˆ°æ‰€æœ‰æ–¹æ¡ˆæ•°</p>
<h4 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;inline&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-fgcse&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target(<span class="string">&quot;avx&quot;</span>,<span class="string">&quot;sse2&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-fgcse-lm&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-fipa-sra&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-ftree-pre&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-ftree-vrp&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-fpeephole2&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-ffast-math&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;-fsched-spec&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;unroll-loops&quot;</span>)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL pair<span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m, t;</span><br><span class="line"></span><br><span class="line">ll dp[N][<span class="number">15</span>];</span><br><span class="line">ll a[N];</span><br><span class="line">ll poww[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> s[N];</span><br><span class="line">    string p = <span class="string">&quot;@nunhehheh&quot;</span>;</span><br><span class="line">    cin &gt;&gt; (s + <span class="number">1</span>);</span><br><span class="line">    ll len =<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= len+<span class="number">1</span>; i++) &#123;<span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++)dp[i][j] = <span class="number">0</span>;</span><br><span class="line">        a[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = len; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//ä¸sä¸­ç¬¬iä¸ªå­—ç¬¦ä¸€ä¸ªéƒ½ä¸åŒ¹é…çš„æ•°é‡æ˜¯1</span></span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">&#x27;a&#x27;</span>)a[i] = (a[i + <span class="number">1</span>] + <span class="number">1</span>) % mod;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            a[i] = a[i + <span class="number">1</span>];<span class="comment">//é¢„å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">9</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == p[j])dp[i][j] = (dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + dp[i - <span class="number">1</span>][j]) % mod;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j] % mod;<span class="comment">//ç®—å…¬å…±åºåˆ—ä¸ªæ•°</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">&#x27;h&#x27;</span>) &#123;</span><br><span class="line">            ans += (dp[i][<span class="number">8</span>] * (poww[a[i]] - <span class="number">1</span>)) % mod;<span class="comment">//æ³¨æ„è¿™é‡Œæ˜¯dp[i][8].å¦‚ç”¨dp[i][9]ç®—ç­”æ¡ˆä¼šé‡å¤</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans % mod &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    poww[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1e5</span>;i++)&#123;</span><br><span class="line">       poww[i] =(poww[i<span class="number">-1</span>]*<span class="number">2</span>)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ ‘å½¢DP"><a href="#æ ‘å½¢DP" class="headerlink" title="æ ‘å½¢DP"></a>æ ‘å½¢DP</h2><h3 id="D-The-Fair-Nut-and-the-Best-Path"><a href="#D-The-Fair-Nut-and-the-Best-Path" class="headerlink" title="D. The Fair Nut and the Best Path"></a><a href="https://codeforces.com/problemset/problem/1084/D">D. The Fair Nut and the Best Path</a></h3><h4 id="é¢˜æ„-8"><a href="#é¢˜æ„-8" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>åˆ°è¾¾ä¸€ä¸ªç‚¹å¾—åˆ°è¿™ä¸ªç‚¹çš„ä»·å€¼ï¼Œç»è¿‡ä¸€ä¸ªè¾¹èŠ±è´¹è¿™ä¸ªè¾¹çš„ä»·å€¼ï¼Œæ±‚å¾—åˆ°çš„æœ€å¤§ä»·å€¼ </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> w[N];<span class="comment">//å­˜æ¯ä¸ªç‚¹å¿«ä¹æŒ‡æ•°</span></span><br><span class="line">vector&lt;PLL &gt; tree[N];</span><br><span class="line">ll dp[N];</span><br><span class="line">ll ans = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> father)</span> </span>&#123;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, dp[u]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; tree[u].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="type">int</span> son = tree[u][i].first;</span><br><span class="line">        <span class="keyword">if</span> (son == father)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(son, u);</span><br><span class="line">        ans = <span class="built_in">max</span>(ans , dp[son] + dp[u] - tree[u][i].second);<span class="comment">//dp[son] + dp[u] - tree[u][i].second:å€’vçš„å½¢çŠ¶,æœ€å¤§å€¼+æ¬¡å¤§å€¼</span></span><br><span class="line">        dp[u] = <span class="built_in">max</span>(dp[u], dp[son] + w[u] - tree[u][i].second);</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, dp[u]);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)cin &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)dp[i] = w[i], ans = <span class="built_in">max</span>(ans, dp[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        ll a, b, c;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        tree[b].<span class="built_in">pb</span>(&#123;a, c&#125;);</span><br><span class="line">        tree[a].<span class="built_in">pb</span>(&#123;b, c&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)ans = <span class="built_in">max</span>(ans, dp[i]);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="C-Parsaâ€™s-Humongous-Tree"><a href="#C-Parsaâ€™s-Humongous-Tree" class="headerlink" title="C. Parsaâ€™s Humongous Tree"></a><a href="https://codeforces.com/contest/1529/problem/C">C. Parsaâ€™s Humongous Tree</a></h3><h4 id="é¢˜æ„-9"><a href="#é¢˜æ„-9" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ‰ä¸€é¢—æ ‘,æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªå–å€¼èŒƒå›´,ç­”æ¡ˆä¸ºæ‰€æœ‰ç›¸é‚»ç‚¹çš„ç»å¯¹å€¼ä¹‹å·®ä¹‹å’Œ,ç°åœ¨è¦ä½ ç¡®å®šæ¯ä¸ªç‚¹çš„å€¼,æ±‚æœ€å¤§ç­”æ¡ˆ.</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050500.png" alt="image-20211113214145142"></p>
<h4 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>è´ªå¿ƒçš„è¦ä¹ˆå–ç«¯ç‚¹è¦ä¹ˆå–å³ç«¯ç‚¹å³å¯</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; endl</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">200005</span>,M=N*<span class="number">2</span>;<span class="comment">//æ— å‘å›¾è¾¹æ•°*2</span></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> e[M],ne[M],h[N],idx;</span><br><span class="line"><span class="type">int</span> l[N],r[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    e[idx]=b,ne[idx]=h[a],h[a]=idx++;</span><br><span class="line">&#125;</span><br><span class="line">ll dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fa)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = h[u]; ~i ; i=ne[i]) &#123;</span><br><span class="line">        <span class="type">int</span> j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j==fa)<span class="keyword">continue</span>;<span class="comment">//ä¸èƒ½å¾€ä¸Šé¢æœ</span></span><br><span class="line"> </span><br><span class="line">        <span class="built_in">dfs</span>(j,u);</span><br><span class="line">        dp[u][<span class="number">0</span>]+=<span class="built_in">max</span>(dp[j][<span class="number">0</span>]+<span class="built_in">abs</span>(l[u]-l[j]),dp[j][<span class="number">1</span>]+<span class="built_in">abs</span>(l[u]-r[j]));<span class="comment">//dp[i][0]æ˜¯ç¬¬iä¸ªç‚¹å–å·¦è¾¹</span></span><br><span class="line">        dp[u][<span class="number">1</span>]+=<span class="built_in">max</span>(dp[j][<span class="number">0</span>]+<span class="built_in">abs</span>(r[u]-l[j]),dp[j][<span class="number">1</span>]+<span class="built_in">abs</span>(r[u]-r[j]));<span class="comment">//d p[i][1]æ˜¯ç¬¬iä¸ªç‚¹å–å³è¾¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> t;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    t=<span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">while</span>(t--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line">        <span class="built_in">memset</span>(e,<span class="number">0</span>,<span class="keyword">sizeof</span> e);</span><br><span class="line">        <span class="built_in">memset</span>(ne,<span class="number">0</span>,<span class="keyword">sizeof</span> ne);</span><br><span class="line">        <span class="built_in">memset</span>(l,<span class="number">0</span>,<span class="keyword">sizeof</span> l);</span><br><span class="line">        <span class="built_in">memset</span>(r,<span class="number">0</span>,<span class="keyword">sizeof</span> r);</span><br><span class="line">        <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span> dp);</span><br><span class="line">        idx=<span class="number">0</span>;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">            l[i]=<span class="built_in">read</span>();</span><br><span class="line">            r[i]=<span class="built_in">read</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> a, b;</span><br><span class="line">            a=<span class="built_in">read</span>();</span><br><span class="line">            b=<span class="built_in">read</span>();</span><br><span class="line">            <span class="built_in">add</span>(a, b);</span><br><span class="line">            <span class="built_in">add</span>(b, a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);<span class="comment">//ä»¥1ä¸ºåˆ†ç•Œç‚¹</span></span><br><span class="line">        cout&lt;&lt;<span class="built_in">max</span>(dp[<span class="number">1</span>][<span class="number">1</span>],dp[<span class="number">1</span>][<span class="number">0</span>])&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"><span class="comment">//        for (int i = 1; i &lt;=n ; ++i) &#123;</span></span><br><span class="line"><span class="comment">//            cout&lt;&lt;dp[i][0]&lt;&lt;&#x27; &#x27;&lt;&lt;dp[i][1]&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        cout&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="è®¡æ•°ç±»DP"><a href="#è®¡æ•°ç±»DP" class="headerlink" title="è®¡æ•°ç±»DP"></a>è®¡æ•°ç±»DP</h2><h3 id="D-FG-operation"><a href="#D-FG-operation" class="headerlink" title="D - FG operation"></a><a href="https://atcoder.jp/contests/abc220/tasks/abc220_d">D - FG operation</a></h3><p>ç»™ä¸€ä¸ªNé•¿åº¦åªæœ‰0åˆ°9çš„åºåˆ—ï¼Œåšä»¥ä¸‹ä¸¤ä¸ªæ“ä½œFï¼šå°†ï¼ˆx+yï¼‰%10 Gï¼šå°†ï¼ˆx*yï¼‰%10ï¼ˆxå’Œyæ˜¯åºåˆ—æœ€å‰é¢çš„ä¸¤ä¸ªæ•°ï¼‰ï¼Œå°†ç»“æœæ”¾å…¥åºåˆ—æœ€å‰é¢ï¼Œç›´åˆ°åªå‰©ä¸‹ä¸€ä¸ªæ•°ã€‚ç®—å‡ºæ¯ä¸ªæ•°å‰©ä¸‹çš„å¯èƒ½ä¸ªæ•°ã€‚</p>
<p>ç”±äºåºåˆ—æ˜¯å›ºå®šçš„ï¼ˆä½œä¸ºyï¼‰ï¼Œæ‰€ä»¥dpæšä¸¾0åˆ°9æ‰€æœ‰æ•°ï¼ˆä½œä¸ºxï¼‰ï¼Œå°†Få’ŒGçš„ç»“æœåŠ å…¥ä¸‹ä¸€å±‚ï¼Œå³å¯ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;atcoder/all&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> atcoder;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> mint = modint998244353;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll n;cin&gt;&gt;n;</span><br><span class="line">    vector&lt;ll&gt;<span class="built_in">a</span>(n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;a[i];</span><br><span class="line">    mint dp[n+<span class="number">1</span>][<span class="number">10</span>];<span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="built_in">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">1</span>][a[<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">0</span>;j&lt;=<span class="number">9</span>;j++)&#123;</span><br><span class="line">            dp[i+<span class="number">1</span>][(j+a[i+<span class="number">1</span>])%<span class="number">10</span>] += dp[i][j];</span><br><span class="line">            dp[i+<span class="number">1</span>][(j*a[i+<span class="number">1</span>])%<span class="number">10</span>] += dp[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(ll K=<span class="number">0</span>;K&lt;=<span class="number">9</span>;K++)&#123;</span><br><span class="line">        cout&lt;&lt;dp[n][K].<span class="built_in">val</span>()&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¹¶æŸ¥é›†-æœ€å°ç”Ÿæˆæ ‘-æ¬¡å°ç”Ÿæˆæ ‘"><a href="#å¹¶æŸ¥é›†-æœ€å°ç”Ÿæˆæ ‘-æ¬¡å°ç”Ÿæˆæ ‘" class="headerlink" title="å¹¶æŸ¥é›†&#x2F;æœ€å°ç”Ÿæˆæ ‘&#x2F;æ¬¡å°ç”Ÿæˆæ ‘"></a>å¹¶æŸ¥é›†&#x2F;æœ€å°ç”Ÿæˆæ ‘&#x2F;æ¬¡å°ç”Ÿæˆæ ‘</h2><h3 id="D-Sum-of-Maximum-Weights"><a href="#D-Sum-of-Maximum-Weights" class="headerlink" title="D - Sum of Maximum Weights"></a><a href="https://atcoder.jp/contests/abc214/tasks/abc214_d?lang=en">D - Sum of Maximum Weights</a></h3><h4 id="é¢˜æ„-10"><a href="#é¢˜æ„-10" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050523.png" alt="image-20211113220021550"></p>
<h4 id="æ€è·¯-2"><a href="#æ€è·¯-2" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050189.png" alt="image-20211113220712515"></p>
<p>å¸¦æƒå¹¶æŸ¥é›†:è®°å½•é¢å¤–ä¿¡æ¯çš„å¹¶æŸ¥é›†,æ­¤å¤„è®°å½•çš„ä¿¡æ¯æ˜¯é›†åˆçš„å¤§å°siz</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">stru</span> &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">&#125; edges[N];</span><br><span class="line"><span class="type">int</span> fa[N], siz[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(stru a, stru b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.w &lt; b.w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fa[x] != x)fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">find</span>(a), y = <span class="built_in">find</span>(b);</span><br><span class="line">    <span class="keyword">if</span> (x != y) &#123;</span><br><span class="line">        fa[x] = y;</span><br><span class="line">        siz[y] += siz[x];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        cin &gt;&gt; edges[i].u &gt;&gt; edges[i].v &gt;&gt; edges[i].w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        fa[i] = i;</span><br><span class="line">        siz[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(edges, edges + n - <span class="number">1</span>, cmp);</span><br><span class="line"></span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        ans += (ll) edges[i].w * (ll) siz[<span class="built_in">find</span>(edges[i].u)] * (ll) siz[<span class="built_in">find</span>(edges[i].v)];</span><br><span class="line">        <span class="comment">//cout&lt;&lt;ans&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">        <span class="built_in">merge</span>(edges[i].u, edges[i].v);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PTA-ç¤¾äº¤é›†ç¾¤-https-pintia-cn-problem-sets-1496741922278645760-problems-1496742006529630216"><a href="#PTA-ç¤¾äº¤é›†ç¾¤-https-pintia-cn-problem-sets-1496741922278645760-problems-1496742006529630216" class="headerlink" title="[PTA ç¤¾äº¤é›†ç¾¤][https://pintia.cn/problem-sets/1496741922278645760/problems/1496742006529630216]"></a>[PTA ç¤¾äº¤é›†ç¾¤][<a href="https://pintia.cn/problem-sets/1496741922278645760/problems/1496742006529630216]">https://pintia.cn/problem-sets/1496741922278645760/problems/1496742006529630216]</a></h3><h4 id="é¢˜æ„-11"><a href="#é¢˜æ„-11" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™nä¸ªäººï¼Œæ¯ä¸ªäººæœ‰kç§çˆ±å¥½ï¼Œ[1,1000]çš„æ­£æ•´æ•°ä»£è¡¨ä¸åŒçˆ±å¥½çš„ç¼–å·ã€‚æœ‰éƒ¨åˆ†ç›¸åŒçˆ±å¥½çš„äººä¸ºä¸€ä¸ªé›†ç¾¤ã€‚ç°åœ¨é—®è¿™nä¸ªäººä¸€å…±ç»„æˆäº†å¤šå°‘ä¸ªé›†ç¾¤ï¼Œæ¯ä¸ªé›†ç¾¤æœ‰å¤šå°‘äºº</p>
<h4 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>å¯¹äºæ¯ä¸ªäººçš„kä¸ªçˆ±å¥½ï¼ŒæŠŠè¿™kä¸ªçˆ±å¥½ç”¨å¹¶æŸ¥é›†mergeæˆä¸€å¨ï¼Œç„¶åç›´æ¥éå†å¹¶æŸ¥é›†p[1-1000]å°±è¡Œã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">int</span> p[<span class="number">10005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x!=p[x])p[x]=<span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="type">int</span> a[<span class="number">10005</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)p[i]=i;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> m;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d:&quot;</span>,&amp;m);</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        cin&gt;&gt;x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m<span class="number">-1</span>;j++)&#123;</span><br><span class="line">            <span class="type">int</span> y;</span><br><span class="line">            cin&gt;&gt;y;</span><br><span class="line">            p[<span class="built_in">find</span>(x)]=p[<span class="built_in">find</span>(y)];</span><br><span class="line">        &#125;</span><br><span class="line">        a[i]=p[<span class="built_in">find</span>(x)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mp[<span class="number">10005</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)&#123;</span><br><span class="line">        mp[<span class="built_in">find</span>(a[i])]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(mp+<span class="number">1</span>,mp+<span class="number">1001</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(mp+<span class="number">1</span>,mp+<span class="number">1001</span>);</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(mp[i]&gt;<span class="number">0</span>)cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;cnt&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="type">int</span> tag=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">1000</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(mp[i]&gt;<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (tag)cout &lt;&lt; mp[i], tag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cout &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; mp[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1005</span>, M = <span class="number">200010</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="type">int</span> d[N][N] ;<span class="comment">// d[i][j]ä»£è¡¨iåˆ°jç‚¹çš„è·¯å¾„ä¸Šæœ€å¤§çš„ä¸€æ¡è¾¹ (å¦‚æœNè¾ƒå¤§å¯ä»¥ç”¨å“ˆå¸Œè¡¨)</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; path[N]; <span class="comment">//æ‰©å±•è·¯å¾„ï¼Œpathæ•°ç»„ï¼Œç¼©å†™p</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> a, b, w;</span><br><span class="line">    <span class="type">bool</span> vis;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Edge &amp;W) <span class="type">const</span> <span class="comment">//é‡è½½è¿ç®—ç¬¦ä»¥ä¾¿äºèƒ½ç›´æ¥sort</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> w &lt; W.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; edges[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> <span class="comment">//å¹¶æŸ¥é›†</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> component = <span class="number">1</span>;<span class="comment">//è¿é€šåˆ†é‡æ•°é‡</span></span><br><span class="line"><span class="function">ll <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(edges, edges + m);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        p[i] = i;</span><br><span class="line">        path[i].<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;   <span class="comment">// åˆå§‹åŒ–å¹¶æŸ¥é›†å’Œè·¯å¾„</span></span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a = edges[i].a, b = edges[i].b, w = edges[i].w;</span><br><span class="line">        a = <span class="built_in">find</span>(a), b = <span class="built_in">find</span>(b);</span><br><span class="line">        <span class="keyword">if</span> (a != b)<span class="comment">//æ‰¾åˆ°çš„ç¥–å®—ä¸ç›¸ç­‰è¯´æ˜ä¸è¿é€š</span></span><br><span class="line">        &#123;</span><br><span class="line">            p[a] = b;</span><br><span class="line">            edges[i].vis = <span class="literal">true</span>;<span class="comment">//æ ‡è®°è¿›å»æœ€å°ç”Ÿæˆæ ‘çš„é›†åˆ</span></span><br><span class="line">            res += w;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j:path[a])</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> k:path[b]) &#123;</span><br><span class="line">                    d[j][k] = d[k][j] = w; <span class="comment">//d[i][j]ä»£è¡¨iåˆ°jç‚¹çš„è·¯å¾„ä¸Šæœ€å¤§çš„ä¸€æ¡è¾¹(ä¹‹å‰æ’è¿‡åº,wæ˜¯é€’å¢çš„)</span></span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j:path[a]) path[b].<span class="built_in">push_back</span>(j); <span class="comment">//åˆå¹¶è·¯å¾„,æ ‡è®°aèƒ½åˆ°b</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(i) != <span class="built_in">find</span>(i + <span class="number">1</span>)) &#123; component++; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (component &gt; <span class="number">1</span>)<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;w);</span><br><span class="line">        edges[i] = &#123;a, b, w&#125;;</span><br><span class="line">        sum += w;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">kruskal</span>();</span><br><span class="line">    <span class="type">int</span> res=INF;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        <span class="keyword">if</span> (!edges[i].vis)  <span class="comment">//æšä¸¾æ¯æ¡æ²¡åŠ å…¥æœ€å°ç”Ÿæˆæ ‘çš„é›†åˆ</span></span><br><span class="line">            res = <span class="built_in">min</span>(res, ans + edges[i].w - d[edges[i].a][edges[i].b]);</span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">-1</span>)cout &lt;&lt; <span class="string">&quot;No MST\n&quot;</span> &lt;&lt; component;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(res&gt;ans)cout&lt;&lt;ans&lt;&lt;<span class="string">&#x27;\n&#x27;</span>&lt;&lt;<span class="string">&quot;Yes&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            cout&lt;&lt;ans&lt;&lt;<span class="string">&#x27;\n&#x27;</span>&lt;&lt;<span class="string">&quot;No&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="PTA-æœ€å°ç”Ÿæˆæ ‘çš„å”¯ä¸€æ€§"><a href="#PTA-æœ€å°ç”Ÿæˆæ ‘çš„å”¯ä¸€æ€§" class="headerlink" title="PTA-æœ€å°ç”Ÿæˆæ ‘çš„å”¯ä¸€æ€§"></a><a href="https://pintia.cn/problem-sets/1714311041381445632/exam/problems/1714311145664425986?type=7&page=0">PTA-æœ€å°ç”Ÿæˆæ ‘çš„å”¯ä¸€æ€§</a></h3><h4 id="é¢˜æ„-12"><a href="#é¢˜æ„-12" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€ä¸ªå¸¦æƒæ— å‘å›¾ï¼Œå¦‚æœæ˜¯è¿é€šå›¾ï¼Œåˆ™è‡³å°‘å­˜åœ¨ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ï¼Œæœ‰æ—¶æœ€å°ç”Ÿæˆæ ‘å¹¶ä¸å”¯ä¸€ã€‚æœ¬é¢˜å°±è¦æ±‚ä½ è®¡ç®—æœ€å°ç”Ÿæˆæ ‘çš„æ€»æƒé‡ï¼Œå¹¶ä¸”åˆ¤æ–­å…¶æ˜¯å¦å”¯ä¸€ã€‚</p>
<h4 id="é¢˜è§£-2"><a href="#é¢˜è§£-2" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>é€šè¿‡æ±‚å¹¶æŸ¥é›†æ•°é‡å¯å¾—è”é€šé›†ä¸ªæ•°ï¼Œé€šè¿‡æ±‚æ¬¡å°ç”Ÿæˆæ ‘å’Œæœ€å°ç”Ÿæˆæ ‘æ¯”è¾ƒå¯å¾—æœ€å°ç”Ÿæˆæ ‘æ˜¯å¦å”¯ä¸€ã€‚</p>
<h3 id="E-Destruction"><a href="#E-Destruction" class="headerlink" title="E - Destruction"></a><a href="https://atcoder.jp/contests/abc218/tasks/abc218_e">E - Destruction</a></h3><h4 id="é¢˜æ„-13"><a href="#é¢˜æ„-13" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä¸€ä¸ªæ— å‘å›¾,è®©ä½ ä»ä¸­é€‰å‡ºå‡ ä¸ªè¾¹,è¦æ±‚é€‰å‡ºçš„è¾¹æƒæ€»å’Œæœ€å¤§å¹¶ä¸”å‰©ä¸‹çš„å›¾è¦æ˜¯ä¸€ä¸ªè¿é€šå›¾.</p>
<h4 id="é¢˜è§£-3"><a href="#é¢˜è§£-3" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>è¦é€‰å‡ºçš„è¾¹æƒæ€»å’Œæœ€å¤§,é‚£å°±æ˜¯è®©å‰©ä¸‹çš„è¿é€šå›¾è¾¹æƒæ€»å’Œæœ€å°,æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°æœ€å°ç”Ÿæˆæ ‘.ä½†ç›´æ¥è·‘æœ€å°ç”Ÿæˆæ ‘æ˜¯ä¸è¡Œçš„,å› ä¸ºå®ƒæœ‰è´Ÿè¾¹æƒ.è€Œè´Ÿè¾¹æˆ‘ä»¬æ˜¯è‚¯å®šä¸ä¼šé€‰çš„,æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç‰¹åˆ¤ä¸€ä¸‹,åªè¦æˆ‘ä»¬åœ¨è·‘æœ€å°ç”Ÿæˆæ ‘åªè¦ç¢°åˆ°è´Ÿè¾¹æƒæˆ‘ä»¬å°±ç»™æŠŠå®ƒæ”¾è¿›å›¾é‡Œ.(è¿™æ ·è™½ç„¶ä¸æ˜¯æ ‘äº†ä½†å¯ä»¥ä¿è¯æˆ‘ä»¬å¾—åˆ°æ­£ç¡®çš„ç­”æ¡ˆ)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">200010</span>, M = <span class="number">200010</span>, INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">    <span class="type">int</span> a, b, w;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Edge &amp;W) <span class="type">const</span> <span class="comment">//é‡è½½è¿ç®—ç¬¦ä»¥ä¾¿äºèƒ½ç›´æ¥sort</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> w &lt; W.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; edges[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span> <span class="comment">//å¹¶æŸ¥é›†</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sort</span>(edges, edges + m);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) p[i] = i;    <span class="comment">// åˆå§‹åŒ–å¹¶æŸ¥é›†</span></span><br><span class="line"></span><br><span class="line">    ll res = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a = edges[i].a, b = edges[i].b, w = edges[i].w;</span><br><span class="line"></span><br><span class="line">        a = <span class="built_in">find</span>(a), b = <span class="built_in">find</span>(b);</span><br><span class="line">        <span class="keyword">if</span> (a != b)<span class="comment">//æ‰¾åˆ°çš„ç¥–å®—ä¸ç›¸ç­‰è¯´æ˜ä¸è¿é€š</span></span><br><span class="line">        &#123;</span><br><span class="line">            p[a] = b;</span><br><span class="line">            res += w;</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (w &lt; <span class="number">0</span>)res += w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a, b, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;w);</span><br><span class="line">        edges[i] = &#123;a, b, w&#125;;</span><br><span class="line">        sum += w;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; sum - <span class="built_in">kruskal</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æœç´¢-æ ‘"><a href="#æœç´¢-æ ‘" class="headerlink" title="æœç´¢&#x2F;æ ‘"></a>æœç´¢&#x2F;æ ‘</h2><h2 id="DFS"><a href="#DFS" class="headerlink" title="DFS"></a>DFS</h2><h3 id="å›¾k-ç€è‰²é—®é¢˜"><a href="#å›¾k-ç€è‰²é—®é¢˜" class="headerlink" title="å›¾k-ç€è‰²é—®é¢˜"></a><a href="https://pintia.cn/problem-sets/1719376100966764544/exam/problems/1719376325957615616?type=7&page=0">å›¾k-ç€è‰²é—®é¢˜</a></h3><h4 id="é¢˜æ„-14"><a href="#é¢˜æ„-14" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€ä¸ªné¡¶ç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œk(k&lt;&#x3D;n)ç§é¢œè‰²ï¼Œç›¸é‚»ä¸¤ä¸ªé¡¶ç‚¹é¢œè‰²ä¸ç›¸åŒï¼Œé—®æ€»å…±æœ‰å¤šå°‘ç§æ¶‚è‰²æ–¹æ³•</p>
<h4 id="æ€è·¯-3"><a href="#æ€è·¯-3" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>dfsæšä¸¾</p>
<p>å°†é¢œè‰²ç”¨æ•°å­—1~kè¡¨ç¤ºã€‚ä¸€å¼€å§‹èƒ½æƒ³åˆ°ä»ç¬¬ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹æ¶‚ç¬¬1ç§é¢œè‰²ï¼Œç„¶åå’Œå®ƒç›¸é‚»çš„é¡¶ç‚¹æ¶‚ç¬¬2ç§é¢œè‰²ã€‚ä»¥æ­¤ç±»æ¨ã€‚é¢˜ç›®è¦æ±‚æ¶‚è‰²çš„æ–¹æ³•æ•°ç›®ï¼Œæ‰€ä»¥ä»ç¬¬ä¸€ä¸ªç‚¹å¼€å§‹å°±æšä¸¾æ¶‚1~kç§é¢œè‰²ã€‚ç„¶åæšä¸¾ä¸‹ä¸€ä¸ªç‚¹ï¼Œè‹¥ä¸‹ä¸€ä¸ªç‚¹å’Œè¿™ä¸ªç‚¹ç›¸é‚»ä¸”é¢œè‰²ç›¸åŒï¼Œé‚£å°±ä¸èƒ½ç»§ç»­æœã€‚åä¹‹åˆ™å¯ä»¥ï¼ˆç›¸é‚»é¢œè‰²ä¸åŒæˆ–è€…ç›´æ¥ä¸ç›¸é‚»éƒ½èƒ½ç»§ç»­æ¶‚è‰²æ–¹æ¡ˆï¼‰è‹¥æšä¸¾çš„ç‚¹æ•°è¶…è¿‡nè¯´æ˜æ¶‚è‰²å®Œäº†ï¼Œæ˜¯ä¸€ç§æ–¹æ¡ˆï¼Œæ‰€ä»¥æ–¹æ¡ˆæ•°+1ã€‚å…¶ä¸­è¦æ³¨æ„æ¶‚äº†è‰²ä¹‹åè¦è¿˜åŸç°åœºã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n,m,k;</span><br><span class="line"><span class="type">int</span> g[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="type">int</span> sum=<span class="number">0</span>;<span class="comment">//è®°å½•ç­”æ¡ˆæ•°é‡</span></span><br><span class="line"><span class="type">int</span> color[<span class="number">105</span>];</span><br><span class="line"><span class="type">int</span> ok;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u&gt;n) &#123;</span><br><span class="line">        sum++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=k;i++)&#123;</span><br><span class="line">        color[u]=i;</span><br><span class="line">        ok=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(g[u][j]&amp;&amp;color[j]==color[u])&#123;</span><br><span class="line">                ok=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ok)<span class="built_in">dfs</span>(u+<span class="number">1</span>);</span><br><span class="line">        color[u]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">        g[a][b]=<span class="number">1</span>;</span><br><span class="line">        g[b][a]=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    cout&lt;&lt;sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="F-Distance-Sums-2"><a href="#F-Distance-Sums-2" class="headerlink" title="F - Distance Sums 2"></a><a href="https://atcoder.jp/contests/abc220/tasks/abc220_f">F - Distance Sums 2</a></h3><h4 id="é¢˜æ„-15"><a href="#é¢˜æ„-15" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä½ nä¸ªç‚¹n-1æ¡è¾¹ï¼Œç„¶åä¾æ¬¡æ±‚å‡ºæ¯ä¸ªç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„è·ç¦»å’Œ</p>
<h4 id="æ€è·¯-4"><a href="#æ€è·¯-4" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>æ¯æ¬¡æœç´¢è®¡ç®—è¯¥ç‚¹çš„å­èŠ‚ç‚¹æ•°é‡</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL <span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">vector&lt;ll&gt; g[N];</span><br><span class="line">ll dis[N], son_size[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll u, ll fa, ll d)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == fa)<span class="keyword">continue</span>;</span><br><span class="line">        dis[<span class="number">1</span>] += d + <span class="number">1</span>;<span class="comment">//æ ¹èŠ‚ç‚¹åˆ°å…¶ä»–æ‰€æœ‰ç‚¹çš„è·ç¦»ä¹‹å’Œ</span></span><br><span class="line">        <span class="built_in">dfs</span>(i, u, d + <span class="number">1</span>);</span><br><span class="line">        son_size[u] += son_size[i];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(ll u, ll fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == fa)<span class="keyword">continue</span>;</span><br><span class="line">        dis[i] = dis[u] - (son_size[i] - <span class="number">1</span>) + (n - son_size[i]<span class="number">-1</span>);<span class="comment">//æ¯æ¬¡ä»èŠ‚ç‚¹ç§»åŠ¨åˆ°å…¶å„¿å­,éƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªèŠ‚ç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»ä¹‹å’Œç”¨è¯¥å…¬å¼æ¨å‡ºå…¶å„¿å­èŠ‚ç‚¹åˆ°å…¶ä»–ç‚¹çš„è·ç¦»ä¹‹å’Œ</span></span><br><span class="line">        <span class="built_in">dfs2</span>(i, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)son_size[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        g[u].<span class="built_in">pb</span>(v);</span><br><span class="line">        g[v].<span class="built_in">pb</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">//cout &lt;&lt; dis[1] &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cout &lt;&lt; dis[i] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="NOI2011-é“è·¯ä¿®å»º"><a href="#NOI2011-é“è·¯ä¿®å»º" class="headerlink" title="[NOI2011]é“è·¯ä¿®å»º"></a>[NOI<a href="https://nanti.jisuanke.com/t/T2373">2011]é“è·¯ä¿®å»º</a></h3><h4 id="é¢˜æ„-16"><a href="#é¢˜æ„-16" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€æ£µæ ‘,å¯¹äºæ¯ä¸€æ¡è¾¹,å¯¹äºç­”æ¡ˆçš„è´¡çŒ®ä¸ºè¾¹é•¿*abs(æ‰€è¿ä¸¤ç‚¹ä¸¤è¾¹çš„ç‚¹çš„ä¸ªæ•°å·®)</p>
<p>å’Œä¸Šé¢˜ç±»ä¼¼,ç¡¬æ¨¡æ‹Ÿ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL <span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll n, m;</span><br><span class="line">vector&lt;PLL &gt; g[N];</span><br><span class="line">ll sz[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(ll u, ll fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i.se == fa)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(i.se, u);</span><br><span class="line">        sz[u] += sz[i.se];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(ll u, ll fa)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//debug(sz[u]);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i.se == fa)<span class="keyword">continue</span>;</span><br><span class="line">        sum += i.fi * <span class="built_in">abs</span>(sz[i.se]  - (n-sz[i.se]));</span><br><span class="line">        <span class="comment">//cout&lt;&lt;u&lt;&lt;&#x27; &#x27;&lt;&lt;i.se&lt;&lt;&#x27; &#x27;&lt;&lt;sz[i.se]&lt;&lt;&#x27; &#x27;&lt;&lt;sz[u]-sz[i.se]&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">        <span class="built_in">dfs2</span>(i.se, u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)sz[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        ll u, v, c;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; c;</span><br><span class="line">        g[u].<span class="built_in">pb</span>(&#123;c, v&#125;);</span><br><span class="line">        g[v].<span class="built_in">pb</span>(&#123;c, u&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">//for(int i=1;i&lt;=n;i++)cout&lt;&lt;sz[i]&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    cout &lt;&lt; sum;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="J-Kingdomâ€™s-Power"><a href="#J-Kingdomâ€™s-Power" class="headerlink" title="J - Kingdomâ€™s Power"></a><a href="https://vjudge.net/problem/Gym-102769K">J - Kingdomâ€™s Power</a></h2><p>è´ªå¿ƒ å…ˆèµ°æ·±åº¦æµ…çš„,æœ€åèµ°æœ€æ·±çš„.å¯ä»¥è½¬åŒ–ä¸ºå¯¹äºå½“å‰çˆ¶äº²ç»“ç‚¹uæ‰€æœ‰ä¸æ˜¯æœ€é•¿çš„é“¾éƒ½ä¼šèµ°ä¸¤æ¬¡æˆ–è€…èµ°ä¸€æ¬¡+ä»æ ¹ç»“ç‚¹æ¥ä¸€æ¬¡,åªæœ‰æœ€é•¿çš„é“¾åªç”¨èµ°ä¸€æ¬¡</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050212.png" alt="image-20211105112131518"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL pair<span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="comment">//#define LOCAL</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, ll dep)</span> </span>&#123;</span><br><span class="line">    ll ma = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[u]) &#123;</span><br><span class="line">        ll t = <span class="built_in">dfs</span>(i, dep + <span class="number">1</span>);<span class="comment">//å¶å­ç»“ç‚¹åˆ°å½“å‰ç»“ç‚¹çš„è·ç¦»</span></span><br><span class="line">        ans += <span class="built_in">min</span>(dep, t);<span class="comment">//ä»æ ¹ç»“ç‚¹åˆ°å½“å‰ç»“ç‚¹,ä»å¶å­ç»“ç‚¹åˆ°å½“å‰ç»“ç‚¹,å–ä¸€ä¸ªæœ€å°å€¼</span></span><br><span class="line">        ma = <span class="built_in">max</span>(ma, t);<span class="comment">//2.maé‡åˆ°åˆ†æ”¯åå°†åˆ†æ”¯çš„æ‰€æœ‰é“¾é•¿å–æœ€å¤§å€¼,å°±æ˜¯è¯¥åˆ†æ”¯ä¸‹çš„æœ€é•¿é“¾é•¿	</span></span><br><span class="line">    &#125;</span><br><span class="line">    ans -= <span class="built_in">min</span>(ma, dep);<span class="comment">//å‡æ‰æœ€é•¿çš„é“¾é‡å¤èµ°çš„</span></span><br><span class="line">    <span class="keyword">return</span> ma + <span class="number">1</span>;<span class="comment">//1.maæ²¡é‡åˆ°åˆ†æ”¯æ—¶å°±ç›¸å½“äºåªæ˜¯é€’å½’çš„æ±‚å¶å­ç»“ç‚¹åˆ°å½“å‰ç»“ç‚¹çš„è·ç¦»</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)g[i].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> f = <span class="built_in">read</span>();</span><br><span class="line">        g[f].<span class="built_in">pb</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    ans = n - <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    T = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŒç«¯BFS"><a href="#åŒç«¯BFS" class="headerlink" title="åŒç«¯BFS"></a>åŒç«¯BFS</h2><h3 id="E-Stronger-Takahashi"><a href="#E-Stronger-Takahashi" class="headerlink" title="E - Stronger Takahashi"></a><a href="https://atcoder.jp/contests/abc213/tasks/abc213_e?lang=en">E - Stronger Takahashi</a></h3><h4 id="é¢˜æ„-17"><a href="#é¢˜æ„-17" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ä»  èµ°åˆ° ï¼Œåªèƒ½èµ°åœ¨ <code>.</code> ä¸Šä¸èƒ½èµ°åœ¨ <code>#</code> ä¸Šï¼Œæ¯æ¬¡å¯ä»¥æ¶ˆæ‰ 2Ã—2çš„ <code>#</code>ï¼Œæ±‚æœ€å°‘æ¶ˆæ‰å‡ æ¬¡æ‰èƒ½åˆ°ç»ˆç‚¹ã€‚</p>
<h4 id="æ€è·¯-5"><a href="#æ€è·¯-5" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>èµ°<code>#</code>èŠ±è´¹ä¸º1,ç„¶åå¯ä»¥ä»¥0çš„èŠ±è´¹èµ°ä»¥è¿™ä¸ª<code>#</code>ä¸ºä¸­å¿ƒçš„2x2,å°±ç›¸å½“äºèŠ±1çš„èŠ±è´¹ç›´æ¥ç¬ç§»åˆ°è¿™äº›ä½ç½®.</p>
<p>èµ°<code>.</code>æ˜¯0çš„èŠ±è´¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050657.jpg" alt="261636814111_.pic"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> g[N][N];</span><br><span class="line"><span class="type">int</span> dis[N][N];</span><br><span class="line"><span class="type">bool</span> st[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    deque&lt;PII &gt; dq;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="number">0</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line">    dis[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    dq.<span class="built_in">pb</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">    <span class="type">int</span> dx[] = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, dy[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span> (!dq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = dq.<span class="built_in">front</span>();</span><br><span class="line">        dq.<span class="built_in">pop_front</span>();</span><br><span class="line">        <span class="keyword">if</span> (st[t.fi][t.se])<span class="keyword">continue</span>;</span><br><span class="line">        st[t.fi][t.se] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> a = t.fi + dx[i], b = t.se + dy[i];</span><br><span class="line">            <span class="keyword">if</span> (a &lt; <span class="number">0</span> || a &gt;= n || b &lt; <span class="number">0</span> || b &gt;= m)<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (g[a][b] == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">-1</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">-1</span>; k &lt;= <span class="number">1</span>; k++) &#123;</span><br><span class="line">                        <span class="type">int</span> xx = a + j, yy = b + k;</span><br><span class="line">                        <span class="keyword">if</span> (xx &lt; <span class="number">0</span> || xx &gt;= n || yy &lt; <span class="number">0</span> || yy &gt;= m)<span class="keyword">continue</span>;</span><br><span class="line">                        <span class="keyword">if</span> (dis[t.fi][t.se] + <span class="number">1</span> &lt; dis[xx][yy]) &#123;</span><br><span class="line">                            dis[xx][yy] = dis[t.fi][t.se] + <span class="number">1</span>;</span><br><span class="line">                            dq.<span class="built_in">push_back</span>(&#123;xx, yy&#125;);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis[t.fi][t.se] &lt; dis[a][b]) &#123;</span><br><span class="line">                    dis[a][b] = dis[t.fi][t.se];</span><br><span class="line">                    dq.<span class="built_in">push_front</span>(&#123;a, b&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">            cin &gt;&gt; g[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bfs</span>();</span><br><span class="line"><span class="comment">//    for (int i = 0; i &lt; n; i++) &#123;</span></span><br><span class="line"><span class="comment">//        for (int j = 0; j &lt; m; j++)cout &lt;&lt; dis[i][j] &lt;&lt; &quot; &quot;;</span></span><br><span class="line"><span class="comment">//        cout &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    cout &lt;&lt; dis[n - <span class="number">1</span>][m - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h2><h2 id="æ±‚æœ€çŸ­è·¯çš„è·¯å¾„æ•°"><a href="#æ±‚æœ€çŸ­è·¯çš„è·¯å¾„æ•°" class="headerlink" title="æ±‚æœ€çŸ­è·¯çš„è·¯å¾„æ•°"></a>æ±‚æœ€çŸ­è·¯çš„è·¯å¾„æ•°</h2><h3 id="D-Number-of-Shortest-paths"><a href="#D-Number-of-Shortest-paths" class="headerlink" title="D - Number of Shortest paths"></a><a href="https://atcoder.jp/contests/abc211/tasks/abc211_d?lang=en">D - Number of Shortest paths</a></h3><h4 id="é¢˜æ„-18"><a href="#é¢˜æ„-18" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>nåº§åŸmæ¡è·¯ï¼Œèµ°æ¯ä¸€æ¡è·¯çš„æ—¶é—´ä¸º1ï¼Œé—®ä»City 1 åˆ°City n çš„æœ€çŸ­è·¯æœ‰å‡ æ¡</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[N];</span><br><span class="line"><span class="type">int</span> minn[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    priority_queue&lt;PII, vector&lt;PII &gt;, greater&lt;&gt;&gt; heap;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    <span class="built_in">memset</span>(st, <span class="literal">false</span>, <span class="keyword">sizeof</span> st);</span><br><span class="line">    dis[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = heap.<span class="built_in">top</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> ver = t.se, distance = t.fi;</span><br><span class="line">        <span class="keyword">if</span> (st[ver])<span class="keyword">continue</span>;</span><br><span class="line">        st[ver] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i: g[ver]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[i] &gt;= distance + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (dis[i] == distance + <span class="number">1</span>)minn[i] =(minn[i]+ minn[t.se])%mod;<span class="comment">//è®°å½•æ¡æ•°</span></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    dis[i] = distance + <span class="number">1</span>;</span><br><span class="line">                    minn[i]=minn[t.se];</span><br><span class="line">                    <span class="comment">//cout&lt;&lt;i&lt;&lt;&#x27; &#x27;&lt;&lt;minn[i]&lt;&lt;&quot;\n&quot;;</span></span><br><span class="line">                    heap.<span class="built_in">push</span>(&#123;dis[i], i&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        g[a].<span class="built_in">pb</span>(b);</span><br><span class="line">        g[b].<span class="built_in">pb</span>(a);</span><br><span class="line">    &#125;</span><br><span class="line">    minn[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dijkstra</span>();</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; minn[n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="stlä¹±æ"><a href="#stlä¹±æ" class="headerlink" title="stlä¹±æ"></a>stlä¹±æ</h2><h2 id="ä¼˜å…ˆé˜Ÿåˆ—ä¹±æ"><a href="#ä¼˜å…ˆé˜Ÿåˆ—ä¹±æ" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—ä¹±æ"></a>ä¼˜å…ˆé˜Ÿåˆ—ä¹±æ</h2><h3 id="D-Querying-Multiset"><a href="#D-Querying-Multiset" class="headerlink" title="D - Querying Multiset"></a><a href="https://atcoder.jp/contests/abc212/tasks/abc212_d?lang=en">D - Querying Multiset</a></h3><h4 id="é¢˜æ„-19"><a href="#é¢˜æ„-19" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ‰å¾ˆå¤šçƒå’Œä¸€ä¸ªç©ºçš„åŒ…ï¼Œqæ¬¡æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥æ“ä½œä¸‰ç§æ“ä½œå…¶ä¸­ä¹‹ä¸€ï¼š</p>
<p>ç¬¬ä¸€ç§æ“ä½œï¼šåœ¨çƒä¸Šå†™ä¸‹ä¸€ä¸ªæ•°å­—xå¹¶æ”¾å…¥åŒ…ä¸­</p>
<p>ç¬¬äºŒç§æ“ä½œï¼šè®©åŒ…ä¸­æ‰€æœ‰çƒçš„æ•°å­—+x</p>
<p>ç¬¬ä¸‰ç§æ“ä½œï¼šé€‰æ‹©åŒ…ä¸­æ•°å­—æœ€å°çš„çƒå–å‡ºï¼Œå¹¶è®°å½•è¯¥çƒçš„æ•°å­—</p>
<p>è¾“å‡ºç¬¬ä¸‰ç§æ“ä½œå–å‡ºçš„çƒçš„æ•°å­—ã€‚</p>
<h4 id="æ€è·¯-6"><a href="#æ€è·¯-6" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>å› ä¸ºè¦é€‰æ‹©æœ€å°æ•°å­—çš„çƒå–å‡ºï¼Œè€ƒè™‘ä¼˜å…ˆé˜Ÿåˆ—ã€‚ä½†åœ¨é˜Ÿåˆ—ä¸­ç¬¬äºŒç§æ“ä½œå…¶å®ä¸æ–¹ä¾¿æ“ä½œï¼Œäºæ˜¯è€ƒè™‘å¯¹å †å¤–çš„çƒè¿›è¡Œåå‘æ“ä½œï¼Œå®šä¹‰yä¸ºä¹‹å‰æ‰€æœ‰ç¬¬äºŒç§æ“ä½œçš„å’Œï¼Œå¯¹ä¹‹åçš„çƒä¸Šçš„æ•°å­—å‡å»ä¸€ä¸ªyå†æ”¾å…¥åŒ…ä¸­ï¼ˆè¿™æ ·åŒ…ä¸­æ‰€æœ‰æ•°å­—æ•´ä½“å‡å°äº†yï¼Œå…¶ç›¸å¯¹å¤§å°ä¸å˜ï¼‰ï¼Œåœ¨è¾“å‡ºæ—¶è¡¥ä¸Šyå³å¯ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">vector&lt;PII &gt; v[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    priority_queue&lt;ll, vector&lt;ll&gt;, greater&lt;&gt;&gt; heap;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> op;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            ll x;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            heap.<span class="built_in">push</span>(x - ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            ll x;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            ans += x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; heap.<span class="built_in">top</span>() + ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            heap.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="E-Sorting-Queries"><a href="#E-Sorting-Queries" class="headerlink" title="E - Sorting Queries"></a><a href="https://atcoder.jp/contests/abc217/tasks/abc217_e">E - Sorting Queries</a></h3><h4 id="é¢˜æ„-20"><a href="#é¢˜æ„-20" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ä¸‰ç§æ“ä½œï¼š</p>
<ol>
<li>å‘Aæ•°ç»„ä¸­åŠ å…¥X</li>
<li>æ‹¿å‡ºAæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li>
<li>å¯¹æ•°ç»„è¿›è¡Œæ’åº</li>
</ol>
<h4 id="æ€è·¯-7"><a href="#æ€è·¯-7" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤æœ‰åºçš„æ•°ã€‚æˆ‘ä»¬è¦æ‹¿ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè‚¯å®šå…ˆæ‹¿æˆ‘ä»¬æ’åºçš„é‚£äº›æ•°ï¼Œå¦‚æœä¼˜å…ˆé˜Ÿåˆ—ä¸ºç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹¿æ™®é€šé˜Ÿåˆ—é‡Œçš„å…ƒç´ ã€‚å¦‚æœéœ€è¦æ’åºï¼Œæˆ‘ä»¬å°†æ™®é€šä¸­çš„å…ƒç´ æ”¾è¿›ä¼˜å…ˆé˜Ÿåˆ—å³å¯ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt;q1;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;,greater&lt;&gt;&gt;q2;</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">read</span>();</span><br><span class="line">    <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        <span class="type">int</span> op, x;</span><br><span class="line">        op = <span class="built_in">read</span>();</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)x = <span class="built_in">read</span>(), q1.<span class="built_in">push</span>(x);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(q2.<span class="built_in">empty</span>())<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,q1.<span class="built_in">front</span>()),q1.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,q2.<span class="built_in">top</span>());</span><br><span class="line">                q2.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())q2.<span class="built_in">push</span>(q1.<span class="built_in">front</span>()),q1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="SETä¹±æ"><a href="#SETä¹±æ" class="headerlink" title="SETä¹±æ"></a>SETä¹±æ</h2><h3 id="D-Cutting-Woods"><a href="#D-Cutting-Woods" class="headerlink" title="D - Cutting Woods"></a><a href="https://atcoder.jp/contests/abc217/tasks/abc217_d">D - Cutting Woods</a></h3><h4 id="é¢˜æ„-21"><a href="#é¢˜æ„-21" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>æœ‰ä¸€æ ¹é•¿åº¦ä¸ºLçš„æœ¨å¤´ï¼Œè¿™æ ¹æœ¨å¤´ä¸Šæœ‰L - 1ä¸ªå¯ä»¥åŠˆçš„ç‚¹ï¼Œå¯¹è¿™æ ¹æœ¨å¤´è¿›è¡Œqæ¬¡æ“ä½œï¼Œæ“ä½œæœ‰ä¸¤ç§ï¼šæ“ä½œä¸€æ˜¯å¾€ä¸€ä¸ªå¯åŠˆç‚¹åŠˆä¸€åˆ€ï¼ŒæŠŠè¿™ä¸ªç‚¹æ‰€åœ¨çš„æœ¨å¤´æ®µåŠˆæˆä¸¤æ®µï¼›æ“ä½œäºŒæ˜¯è¾“å‡ºä¸€ä¸ªå¯åŠˆç‚¹æ‰€åœ¨æœ¨å¤´æ®µçš„é•¿åº¦ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[N], p[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    set&lt;<span class="type">int</span>&gt; s1;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    s1.<span class="built_in">insert</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</span><br><span class="line">        <span class="type">int</span> c, x;</span><br><span class="line">        cin &gt;&gt; c &gt;&gt; x;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="number">1</span>)s1.<span class="built_in">insert</span>(x);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (s1.<span class="built_in">size</span>()==<span class="number">1</span>)cout &lt;&lt; n &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> pos1 = n, pos2 = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">auto</span> t = s1.<span class="built_in">lower_bound</span>(x);</span><br><span class="line">                <span class="keyword">if</span> (t != s1.<span class="built_in">end</span>())pos1 = *t;</span><br><span class="line">                <span class="comment">//cout&lt;&lt;*t&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">                t--;</span><br><span class="line">                <span class="comment">//cout&lt;&lt;*t&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">                <span class="keyword">if</span> (t != s1.<span class="built_in">begin</span>())pos2 = *t;</span><br><span class="line">                cout &lt;&lt; pos1 - pos2 &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¤§æ¨¡æ‹Ÿ"><a href="#å¤§æ¨¡æ‹Ÿ" class="headerlink" title="å¤§æ¨¡æ‹Ÿ"></a>å¤§æ¨¡æ‹Ÿ</h2><h2 id="Texas-holdâ€™em-Poker"><a href="#Texas-holdâ€™em-Poker" class="headerlink" title="Texas holdâ€™em Poker"></a><a href="https://nanti.jisuanke.com/t/41408">Texas holdâ€™em Poker</a></h2><p>æ¨¡æ‹Ÿç®€åŒ–ç‰ˆçš„å¾·å·æ‰‘å…‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M=<span class="number">1e5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> b[N][<span class="number">15</span>];</span><br><span class="line">string s[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">stru</span>&#123;</span><br><span class="line">    string name;</span><br><span class="line">    <span class="type">int</span> rank,d1,d2,res;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(stru a,stru b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.rank!=b.rank)<span class="keyword">return</span> a.rank&gt;b.rank;</span><br><span class="line">    <span class="keyword">if</span>(a.d1!=b.d1)<span class="keyword">return</span> a.d1&gt;b.d1;</span><br><span class="line">    <span class="keyword">if</span>(a.d2!=b.d2)<span class="keyword">return</span> a.d2&gt;b.d2;</span><br><span class="line">    <span class="keyword">if</span>(a.res!=b.res)<span class="keyword">return</span> a.res&gt;b.res;</span><br><span class="line">    <span class="keyword">return</span> a.name&lt;b.name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ran=<span class="number">0</span>,d1=<span class="number">0</span>,d2=<span class="number">0</span>,res=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">judge</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b[idx][<span class="number">1</span>]==<span class="number">1</span>&amp;&amp;b[idx][<span class="number">10</span>]==<span class="number">1</span>&amp;&amp;b[idx][<span class="number">11</span>]==<span class="number">1</span>&amp;&amp;b[idx][<span class="number">12</span>]==<span class="number">1</span>&amp;&amp;b[idx][<span class="number">13</span>]==<span class="number">1</span>)&#123;</span><br><span class="line">        ran=<span class="number">8</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i+<span class="number">4</span>&lt;=<span class="number">13</span>;i++)&#123;<span class="comment">//é¡º</span></span><br><span class="line">        <span class="keyword">if</span>(b[idx][i]==b[idx][i+<span class="number">1</span>]&amp;&amp;b[idx][i]==b[idx][i+<span class="number">2</span>]&amp;&amp;b[idx][i]==b[idx][i+<span class="number">3</span>]&amp;&amp;b[idx][i]==b[idx][i+<span class="number">4</span>]&amp;&amp;b[idx][i]==<span class="number">1</span>)&#123;</span><br><span class="line">            ran=<span class="number">7</span>;</span><br><span class="line">            d1=i+<span class="number">4</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">13</span>;i++)&#123;<span class="comment">//è‘«èŠ¦</span></span><br><span class="line">        <span class="keyword">if</span>(b[idx][i]==<span class="number">4</span>) &#123;</span><br><span class="line">            ran = <span class="number">6</span>;</span><br><span class="line">            d1=i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=<span class="number">13</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(b[idx][j]==<span class="number">1</span>) &#123;</span><br><span class="line">                    res = j;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt;v;</span><br><span class="line">    <span class="type">int</span> cnt3=<span class="number">0</span>,idx3=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">13</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b[idx][i]==<span class="number">3</span>)cnt3++,idx3=i;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(b[idx][i]==<span class="number">2</span>)v.<span class="built_in">push_back</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt3==<span class="number">1</span>&amp;&amp;v.<span class="built_in">size</span>()==<span class="number">1</span>)&#123;<span class="comment">//å…¨æ»¡</span></span><br><span class="line">        ran=<span class="number">5</span>;</span><br><span class="line">        d1=idx3;</span><br><span class="line">        d2=v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">13</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b[idx][i]==<span class="number">1</span>)sum+=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt3==<span class="number">1</span>&amp;&amp;v.<span class="built_in">size</span>()==<span class="number">0</span>)&#123;<span class="comment">//ä¸‰æ¡</span></span><br><span class="line">        ran=<span class="number">4</span>;</span><br><span class="line">        d1=idx3;</span><br><span class="line">        res=sum;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(v.<span class="built_in">size</span>()==<span class="number">2</span>)&#123;<span class="comment">//ä¸¤å¯¹</span></span><br><span class="line">        ran=<span class="number">3</span>;</span><br><span class="line">        d1=<span class="built_in">max</span>(v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">        d2=<span class="built_in">min</span>(v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">        res=sum;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(v.<span class="built_in">size</span>()==<span class="number">1</span>)&#123;<span class="comment">//ä¸€å¯¹</span></span><br><span class="line">        ran=<span class="number">2</span>;</span><br><span class="line">        d1=v[<span class="number">0</span>];</span><br><span class="line">        res=sum;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ran=<span class="number">1</span>;</span><br><span class="line">    res=sum;<span class="comment">//é«˜ç‰Œ</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">while</span>(cin&gt;&gt;n) &#123;</span><br><span class="line">        map&lt;string, <span class="type">int</span>&gt; ori;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            cin &gt;&gt; a[i].name &gt;&gt; s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; s[i].<span class="built_in">length</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j + <span class="number">1</span> &lt; s[i].<span class="built_in">length</span>())</span><br><span class="line">                    <span class="keyword">if</span> (s[i][j] == <span class="string">&#x27;1&#x27;</span> &amp;&amp; s[i][j + <span class="number">1</span>] == <span class="string">&#x27;0&#x27;</span>) &#123;</span><br><span class="line">                        b[i][<span class="number">10</span>]++;</span><br><span class="line">                        j++;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">if</span> (s[i][j] == <span class="string">&#x27;A&#x27;</span>)b[i][<span class="number">1</span>]++;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (s[i][j] == <span class="string">&#x27;J&#x27;</span>)b[i][<span class="number">11</span>]++;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (s[i][j] == <span class="string">&#x27;Q&#x27;</span>)b[i][<span class="number">12</span>]++;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (s[i][j] == <span class="string">&#x27;K&#x27;</span>)b[i][<span class="number">13</span>]++;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    b[i][s[i][j] - <span class="string">&#x27;0&#x27;</span>]++;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            ran = <span class="number">0</span>, d1 = <span class="number">0</span>, d2 = <span class="number">0</span>, res = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">judge</span>(i);</span><br><span class="line">            a[i].rank = ran;</span><br><span class="line">            a[i].d1 = d1;</span><br><span class="line">            a[i].d2 = d2;</span><br><span class="line">            a[i].res = res;</span><br><span class="line">            <span class="comment">//cout&lt;&lt;a[i].name&lt;&lt;&#x27; &#x27;&lt;&lt;a[i].rank&lt;&lt;&#x27; &#x27;&lt;&lt;a[i].d1&lt;&lt;&#x27; &#x27;&lt;&lt;a[i].d2&lt;&lt;&#x27; &#x27;&lt;&lt;res&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(a, a + n, cmp);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            cout &lt;&lt; a[i].name &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="The-15th-Chinese-Northeast-Collegiate-Programming-Contest-M-Master-of-Shuangpin"><a href="#The-15th-Chinese-Northeast-Collegiate-Programming-Contest-M-Master-of-Shuangpin" class="headerlink" title="The 15th Chinese Northeast Collegiate Programming Contest M. Master of Shuangpin"></a>The 15th Chinese Northeast Collegiate Programming Contest M. Master of Shuangpin</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5005</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">vector&lt;string&gt; v[<span class="number">1005</span>];<span class="comment">//å­˜è¾“å…¥</span></span><br><span class="line">string ans[<span class="number">1005</span>][<span class="number">1005</span>];<span class="comment">//å­˜ç­”æ¡ˆ</span></span><br><span class="line"><span class="type">bool</span> st[<span class="number">1005</span>][<span class="number">1005</span>];<span class="comment">//å·²ç»è¢«æ“ä½œè¿‡çš„ä¸²æ ‡è®°ä¸€ä¸‹ ä»¥å…é‡å¤æ“ä½œ</span></span><br><span class="line">unordered_map&lt;string, string&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    mp[<span class="string">&quot;iu&quot;</span>] = <span class="string">&quot;q&quot;</span>, mp[<span class="string">&quot;en&quot;</span>] = <span class="string">&quot;f&quot;</span>, mp[<span class="string">&quot;ei&quot;</span>] = <span class="string">&quot;w&quot;</span>, mp[<span class="string">&quot;eng&quot;</span>] = <span class="string">&quot;g&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;ang&quot;</span>] = <span class="string">&quot;h&quot;</span>, mp[<span class="string">&quot;uan&quot;</span>] = <span class="string">&quot;r&quot;</span>, mp[<span class="string">&quot;an&quot;</span>] = <span class="string">&quot;j&quot;</span>, mp[<span class="string">&quot;ue&quot;</span>] = <span class="string">&quot;t&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;uai&quot;</span>] = <span class="string">&quot;k&quot;</span>, mp[<span class="string">&quot;ing&quot;</span>] = <span class="string">&quot;k&quot;</span>, mp[<span class="string">&quot;un&quot;</span>] = <span class="string">&quot;y&quot;</span>, mp[<span class="string">&quot;uang&quot;</span>] = <span class="string">&quot;l&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;iang&quot;</span>] = <span class="string">&quot;l&quot;</span>, mp[<span class="string">&quot;sh&quot;</span>] = <span class="string">&quot;u&quot;</span>, mp[<span class="string">&quot;ou&quot;</span>] = <span class="string">&quot;z&quot;</span>, mp[<span class="string">&quot;ch&quot;</span>] = <span class="string">&quot;i&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;ia&quot;</span>] = <span class="string">&quot;x&quot;</span>, mp[<span class="string">&quot;ua&quot;</span>] = <span class="string">&quot;x&quot;</span>, mp[<span class="string">&quot;uo&quot;</span>] = <span class="string">&quot;o&quot;</span>, mp[<span class="string">&quot;ao&quot;</span>] = <span class="string">&quot;c&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;ie&quot;</span>] = <span class="string">&quot;p&quot;</span>, mp[<span class="string">&quot;zh&quot;</span>] = <span class="string">&quot;v&quot;</span>, mp[<span class="string">&quot;ui&quot;</span>] = <span class="string">&quot;v&quot;</span>, mp[<span class="string">&quot;in&quot;</span>] = <span class="string">&quot;b&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;ong&quot;</span>] = <span class="string">&quot;s&quot;</span>, mp[<span class="string">&quot;iong&quot;</span>] = <span class="string">&quot;s&quot;</span>, mp[<span class="string">&quot;iao&quot;</span>] = <span class="string">&quot;n&quot;</span>, mp[<span class="string">&quot;ai&quot;</span>] = <span class="string">&quot;d&quot;</span>;</span><br><span class="line">    mp[<span class="string">&quot;ian&quot;</span>] = <span class="string">&quot;m&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        string s;</span><br><span class="line">        s += <span class="built_in">char</span>(<span class="string">&#x27;a&#x27;</span> + <span class="number">0</span>);</span><br><span class="line">        mp[s] = s;</span><br><span class="line">    &#125;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">getline</span>(cin, s)) &#123; <span class="comment">//å¤„ç†è¾“å…¥</span></span><br><span class="line">        <span class="comment">//if(s==&quot;0&quot;)break;</span></span><br><span class="line">        string tmp;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                v[d].<span class="built_in">pb</span>(tmp);</span><br><span class="line">                tmp.<span class="built_in">clear</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tmp += s[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        v[d].<span class="built_in">pb</span>(tmp);</span><br><span class="line">        d++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; d ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; v[i].<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v[i][j].<span class="built_in">size</span>() == <span class="number">1</span>) &#123; <span class="comment">//åªæœ‰ä¸€ä¸ªå­—æ¯çš„æƒ…å†µ ç›´æ¥å¤åˆ¶ eg:a-&gt;aa b-&gt;bb...</span></span><br><span class="line">                ans[i][j] = v[i][j];</span><br><span class="line">                ans[i][j] += v[i][j];</span><br><span class="line">                st[i][j] = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v[i][j].<span class="built_in">size</span>() == <span class="number">2</span>) &#123;<span class="comment">//ä¸¤ä¸ªå­—æ¯çš„æƒ…å†µ:ä¸ç”¨åšä»»ä½•æ“ä½œ,ç­”æ¡ˆç›´æ¥æ˜¯å®ƒæœ¬èº«</span></span><br><span class="line">                ans[i][j] = v[i][j];</span><br><span class="line">                st[i][j] = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> t:mp) &#123;<span class="comment">//å•ç‹¬ä¸€ä¸ª ä¾‹å¦‚angä¹‹ç±»çš„æƒ…å†µ</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (t.fi == v[i][j]) &#123;</span><br><span class="line">                        ans[i][j] = t.fi[<span class="number">0</span>];</span><br><span class="line">                        ans[i][j] += t.se;</span><br><span class="line">                        st[i][j] = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; d ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; v[i].<span class="built_in">size</span>(); j++) &#123;<span class="comment">//å£°æ¯æ˜¯å•ä¸ªçš„æƒ…å†µï¼Œé™¤äº†å£°æ¯ä»¥å¤–ä¸€å®šèƒ½æ‰¾åˆ°ä¸€ä¸ªé•¿åº¦å¤§äº1çš„éŸµæ¯</span></span><br><span class="line">            <span class="keyword">if</span> (!st[i][j] &amp;&amp; mp.<span class="built_in">find</span>(v[i][j].<span class="built_in">substr</span>(<span class="number">1</span>)) != mp.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                ans[i][j] = v[i][j][<span class="number">0</span>];</span><br><span class="line">                ans[i][j] += mp[v[i][j].<span class="built_in">substr</span>(<span class="number">1</span>)];</span><br><span class="line">                st[i][j] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!st[i][j] &amp;&amp; mp.<span class="built_in">find</span>(v[i][j].<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">2</span>)) != mp.<span class="built_in">end</span>()) &#123;<span class="comment">//å£°æ¯æ˜¯ä¸¤ä¸ªçš„æƒ…å†µ ä¾‹å¦‚ch sh</span></span><br><span class="line">                ans[i][j] = mp[v[i][j].<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">2</span>)];</span><br><span class="line">                <span class="keyword">if</span> (v[i][j].<span class="built_in">size</span>() &lt;= <span class="number">3</span>) &#123; <span class="comment">//åªå‰©ä¸‹ä¸€ä¸ªéŸµæ¯ ç­”æ¡ˆç›´æ¥åŠ ä¸Šå®ƒ</span></span><br><span class="line">                    ans[i][j] += v[i][j][<span class="number">2</span>];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp.<span class="built_in">find</span>(v[i][j].<span class="built_in">substr</span>(<span class="number">2</span>)) != mp.<span class="built_in">end</span>()) &#123;<span class="comment">//å‰©ä¸‹ä¸¤ä¸ªéŸµæ¯</span></span><br><span class="line">                        ans[i][j] += mp[v[i][j].<span class="built_in">substr</span>(<span class="number">2</span>)];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                st[i][j] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; d ; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; v[i].<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            cout &lt;&lt; ans[i][j] ;</span><br><span class="line">            <span class="keyword">if</span>(j&lt;v[i].<span class="built_in">size</span>()<span class="number">-1</span>)cout&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;d<span class="number">-1</span>)<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h2><h2 id="çŸ©é˜µå¿«é€Ÿå¹‚"><a href="#çŸ©é˜µå¿«é€Ÿå¹‚" class="headerlink" title="çŸ©é˜µå¿«é€Ÿå¹‚"></a>çŸ©é˜µå¿«é€Ÿå¹‚</h2><h3 id="Matrix-Power-Series"><a href="#Matrix-Power-Series" class="headerlink" title="Matrix Power Series"></a><a href="http://poj.org/problem?id=3233">Matrix Power Series</a></h3><p>ç»™å®šçŸ©é˜µAï¼Œæ±‚çš„ç»“æœï¼ˆä¸¤ä¸ªçŸ©é˜µç›¸åŠ å°±æ˜¯å¯¹åº”ä½ç½®åˆ†åˆ«ç›¸åŠ ï¼‰ã€‚è¾“å‡ºçš„æ•°æ®ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050662.png" alt="image-20211124161736825"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line">ll tot,tota;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">mat</span> &#123;<span class="comment">//å®šä¹‰çŸ©é˜µç»“æ„ä½“</span></span><br><span class="line">    ll m[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">mat</span>() &#123;</span><br><span class="line">        <span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="built_in">sizeof</span>(m));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">ll n,k,mod;</span><br><span class="line">mat <span class="keyword">operator</span>*(mat a, mat b) &#123;<span class="comment">//å®šä¹‰çŸ©é˜µä¹˜æ³•</span></span><br><span class="line">    mat ans;</span><br><span class="line">    ll x = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; tot; j++) &#123;</span><br><span class="line">            x = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; tot; k++) &#123;</span><br><span class="line">                x = (x + a.m[i][k] * b.m[k][j])%mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans.m[i][j] = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">mat <span class="title">init</span><span class="params">(mat &amp;a)</span> </span>&#123;<span class="comment">//åˆå§‹åŒ–å•ä½çŸ©é˜µï¼ˆæŒ‰è¦æ±‚è‡ªå®šä¹‰ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;tot;j++)&#123;</span><br><span class="line">            a.m[i][j]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i++) &#123;</span><br><span class="line">        a.m[i][i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">mat <span class="title">mat_pow</span><span class="params">(mat a, ll k)</span> </span>&#123;<span class="comment">//çŸ©é˜µå¿«é€Ÿå¹‚</span></span><br><span class="line">    mat ans = <span class="built_in">init</span>(ans);</span><br><span class="line">    <span class="keyword">while</span> (k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = ans * a;</span><br><span class="line">        a = a * a;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mat a;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n=<span class="built_in">read</span>();</span><br><span class="line">    k=<span class="built_in">read</span>();</span><br><span class="line">    mod=<span class="built_in">read</span>();</span><br><span class="line">    tot=<span class="number">2</span>*n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            a.m[i][j]=<span class="built_in">read</span>();</span><br><span class="line">            a.m[i+n][j]=a.m[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mat bas;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            bas.m[i][i]=<span class="number">1</span>;</span><br><span class="line">            bas.m[i+n][j+n]=a.m[i][j];</span><br><span class="line">            bas.m[i][j+n]=a.m[i][j];</span><br><span class="line">            bas.m[i+n][j]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    bas= <span class="built_in">mat_pow</span>(bas,k<span class="number">-1</span>);</span><br><span class="line">    mat res=bas*a;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            cout&lt;&lt;((res.m[i][j])%mod+mod)%mod&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é«˜æ–¯æ¶ˆå…ƒ"><a href="#é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒ"></a>é«˜æ–¯æ¶ˆå…ƒ</h2><h3 id="Matrix-Equation"><a href="#Matrix-Equation" class="headerlink" title="Matrix Equation"></a><a href="https://ac.nowcoder.com/acm/contest/10662/A">Matrix Equation</a></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050257.png" alt="image-20211113225909286"></p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050880.png" alt="æˆªå±2021-11-10 23.08.34"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//define LOCAL</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL pair<span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">205</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a[N][N];</span><br><span class="line"><span class="type">int</span> origin_a[N][N];</span><br><span class="line"><span class="type">int</span> b[N][N];</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)res=(res*a)%mod;</span><br><span class="line">        a=(a*a)%mod;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            a[i][j]=origin_a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> c, r;</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c++) &#123;</span><br><span class="line">        <span class="type">int</span> t = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                t = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!a[t][c]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt; n + <span class="number">1</span>; i++) <span class="built_in">swap</span>(a[r][i], a[t][i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; i++)<span class="comment">//å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0</span></span><br><span class="line">            <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt;= c; j--)</span><br><span class="line">                    a[i][j] ^= a[r][j];<span class="comment">//è¯¥è¡Œç¬¬cåˆ—è‚¯å®šæ˜¯1ï¼Œæ‰€ä»¥ä¸‹é¢è¡Œå¼‚æˆ–è¯¥è¡Œç¬¬cåˆ—è‚¯å®šå¯ä»¥æ¶ˆæˆ0ï¼ˆä¸¤ä¸ª1å¼‚æˆ–ï¼‰</span></span><br><span class="line"></span><br><span class="line">        r++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span> (a[i][n])</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> n-r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">            a[i][n] ^= a[i][j] &amp; a[j][n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            cin&gt;&gt;origin_a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            cin&gt;&gt;b[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            a[j][j]=(origin_a[j][j]-b[j][i]+<span class="number">2</span>)%<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> d=<span class="built_in">gauss</span>();</span><br><span class="line">        <span class="comment">//debug(d)</span></span><br><span class="line">        <span class="keyword">if</span>(d==<span class="number">-1</span>)<span class="keyword">continue</span>;</span><br><span class="line">        ans=(ans* <span class="built_in">qpow</span>(<span class="number">2</span>,d))%mod;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ans%mod;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Acwing-207-çƒå½¢ç©ºé—´äº§ç”Ÿå™¨"><a href="#Acwing-207-çƒå½¢ç©ºé—´äº§ç”Ÿå™¨" class="headerlink" title="Acwing 207.çƒå½¢ç©ºé—´äº§ç”Ÿå™¨"></a><a href="https://www.acwing.com/problem/content/209/">Acwing 207.çƒå½¢ç©ºé—´äº§ç”Ÿå™¨</a></h3><p>ç»™ä¸€ä¸ªæ•´æ•°nå’Œn+1è¡Œ è¡¨ç¤ºä¸€ä¸ªnç»´çƒé¢ä¸Šçš„n+1ä¸ªnç»´åæ ‡,æ±‚çƒå¿ƒçš„åæ ‡.</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/20211116235931.jpg" alt="281637078228_.pic"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> origin_a[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"><span class="type">double</span> a[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> c, r;</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c ++ )<span class="comment">//æšä¸¾æ¯ä¸€åˆ—</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; <span class="built_in">fabs</span>(a[t][c]))<span class="comment">//æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„é‚£ä¸€è¡Œ</span></span><br><span class="line">                t = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[t][c]) &lt; eps) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt; n + <span class="number">1</span>; i ++ ) <span class="built_in">swap</span>(a[t][i], a[r][i]);<span class="comment">//æŠŠç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œæ¢åˆ°æœ€ä¸Šé¢</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= c; i -- ) a[r][i] /= a[r][c];<span class="comment">//æŠŠè¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1-&gt;å€’ç€æ›´æ–°,ä¸ç„¶ç¬¬ä¸€ä¸ªæ•°å…ˆè¢«æ›´æ–°æˆ1é™¤åé¢çš„æ•°å°±æ— æ•ˆäº†</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; eps)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt;= c; j -- )</span><br><span class="line">                    a[i][j] -= a[r][j] * a[i][c];<span class="comment">//æŠŠä¸‹è¾¹æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0</span></span><br><span class="line"></span><br><span class="line">        r ++ ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j ++ )<span class="comment">//å€’ç€æŠŠå…¶ä»–ç³»æ•°å…¨éƒ¨æ¶ˆæˆ0ï¼ˆè§£æ‰€åœ¨ä½ç½®çš„ç³»æ•°æ˜¯1ï¼‰</span></span><br><span class="line">            a[i][n] -= a[j][n] * a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//å”¯ä¸€è§£</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n+<span class="number">1</span>;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)cin&gt;&gt;origin_a[i][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="type">double</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            a[i][j]=<span class="number">2.0</span>*(origin_a[i+<span class="number">1</span>][j]-origin_a[<span class="number">0</span>][j]);</span><br><span class="line">            sum+=origin_a[i+<span class="number">1</span>][j]*origin_a[i+<span class="number">1</span>][j]-origin_a[<span class="number">0</span>][j]*origin_a[<span class="number">0</span>][j];</span><br><span class="line">        &#125;</span><br><span class="line">        a[i][n]=sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">gauss</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.3lf &quot;</span>,a[i][n]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Acwing-208-å¼€å…³é—®é¢˜"><a href="#Acwing-208-å¼€å…³é—®é¢˜" class="headerlink" title="Acwing 208.å¼€å…³é—®é¢˜"></a><a href="https://www.acwing.com/problem/content/210/">Acwing 208.å¼€å…³é—®é¢˜</a></h3><h4 id="é¢˜æ„-22"><a href="#é¢˜æ„-22" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/20211117141706.png" alt="image-20211117141706411"></p>
<h4 id="æ€è·¯-8"><a href="#æ€è·¯-8" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>è§£é›†çŸ©é˜µ:ç¬¬ä¸ªå¼€å…³åˆæ€å’Œç»ˆæ€ä¸€æ ·ç¬¬è¡Œçš„è§£é›†çŸ©é˜µå°±æ˜¯0,ä¸ä¸€æ ·å°±æ˜¯1</p>
<p>ä¸º1è¡¨ç¤ºç¬¬ä¸ªå¼€å…³ä¼šå¯¹ç¬¬ä¸ªå¼€å…³äº§ç”Ÿå½±å“</p>
<p>æœ€åè§£å‡ºè‡ªç”±å…ƒä¸ªæ•°,è¯´æ˜è¿™ä¸ªå¼€å…³å¯ä»¥æ˜¯ä»»æ„çš„çŠ¶æ€,æ‰€ä»¥æ–¹æ¡ˆæ•°ä¸º</p>
<h3 id="2021-ICPC-Asia-Jinan-Regional-Contest-J-Determinant"><a href="#2021-ICPC-Asia-Jinan-Regional-Contest-J-Determinant" class="headerlink" title="2021 ICPC Asia Jinan Regional Contest J Determinant"></a><a href="https://pintia.cn/problem-sets/1459829212832296960/problems/1459829264400629769">2021 ICPC Asia Jinan Regional Contest J Determinant</a></h3><h4 id="é¢˜æ„-23"><a href="#é¢˜æ„-23" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä½ ä¸€ä¸ªè¡Œåˆ—å¼ä»¥åŠè¡Œåˆ—å¼çš„å€¼çš„ç»å¯¹å€¼(é•¿åº¦å¯èƒ½æ˜¯)æ±‚è¿™ä¸ªè¡Œåˆ—å¼çš„å€¼æ˜¯æ­£è¿˜æ˜¯è´Ÿ</p>
<h4 id="æ€è·¯-9"><a href="#æ€è·¯-9" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>å…ˆè®©å¤§æ•°æ¨¡ä¸€ä¸ªå¤§ç´ æ•°(),ç„¶åæ±‚è¡Œåˆ—å¼å–æ¨¡çš„å€¼,åˆ¤æ–­ä¸¤ä¸ªæ•°ç›¸ä¸ç›¸ç­‰,å¦‚æœç›¸ç­‰å°±æ˜¯æ­£æ•°,ä¸ç›¸ç­‰å°±æ˜¯è´Ÿæ•°.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">105</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll A[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans = ans * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">quick_pow</span>(a, mod - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gauss</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A[j][i]) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt;= n; k++) <span class="built_in">swap</span>(A[i][k], A[j][k]);</span><br><span class="line">                <span class="keyword">if</span> (i != j) ans = -ans;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!A[i][i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = i + <span class="number">1</span>, iv = <span class="built_in">inv</span>(A[i][i]); j &lt;= n; j++) &#123;</span><br><span class="line">            ll t = A[j][i] * iv % mod;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt;= n; k++)</span><br><span class="line">                A[j][k] = (A[j][k] - t * A[i][k] % mod + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = (ans * A[i][i] % mod + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">string s;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="type">int</span> len = s.<span class="built_in">length</span>();</span><br><span class="line">    ll ans = s[<span class="number">0</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;len; i++) &#123;</span><br><span class="line">        ans = ((ans * <span class="number">10</span>)%mod + (s[i] - <span class="string">&#x27;0&#x27;</span>)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            cin &gt;&gt; A[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll res = <span class="built_in">gauss</span>(n);</span><br><span class="line"><span class="comment">//    debug(res)</span></span><br><span class="line"><span class="comment">//    debug(ans)</span></span><br><span class="line">    <span class="keyword">if</span> (res == ans)cout &lt;&lt; <span class="string">&#x27;+&#x27;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&#x27;-&#x27;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="äºŒåˆ†-ä¸‰åˆ†"><a href="#äºŒåˆ†-ä¸‰åˆ†" class="headerlink" title="äºŒåˆ†&#x2F;ä¸‰åˆ†"></a>äºŒåˆ†&#x2F;ä¸‰åˆ†</h2><h2 id="ä¸‰åˆ†"><a href="#ä¸‰åˆ†" class="headerlink" title="ä¸‰åˆ†"></a>ä¸‰åˆ†</h2><h3 id="P1883-å‡½æ•°"><a href="#P1883-å‡½æ•°" class="headerlink" title="P1883 å‡½æ•°"></a><a href="https://www.luogu.com.cn/problem/P1883">P1883 å‡½æ•°</a></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050010.png" alt="image-20211117195632379"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps=<span class="number">1e-9</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> a[<span class="number">10005</span>],b[<span class="number">10005</span>],c[<span class="number">10005</span>];</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">f</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        ans=<span class="built_in">max</span>(ans,a[i]*x*x+b[i]*x+c[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n=<span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">        a[i]=<span class="built_in">read</span>();</span><br><span class="line">        b[i]=<span class="built_in">read</span>();</span><br><span class="line">        c[i]=<span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> l = <span class="number">0</span>,r = <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">while</span>(r-l&gt;=eps)&#123;<span class="comment">//ç²¾åº¦é—®é¢˜</span></span><br><span class="line">        <span class="type">double</span> m1 = l + (r-l)/<span class="number">3.0</span>,m2 = r - (r-l)/<span class="number">3.0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))</span><br><span class="line">            r = m2;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = m1;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>,<span class="built_in">f</span>(l));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    T = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2020ICPCå—äº¬-F-Fireworks"><a href="#2020ICPCå—äº¬-F-Fireworks" class="headerlink" title="2020ICPCå—äº¬ F.Fireworks"></a><a href="https://ac.nowcoder.com/acm/contest/10272/F">2020ICPCå—äº¬ F.Fireworks</a></h3><h4 id="é¢˜æ„-24"><a href="#é¢˜æ„-24" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šnï¼Œmï¼Œpï¼Œåˆ¶ä½œä¸€ä¸ªçƒŸèŠ±éœ€è¦èŠ±è´¹nåˆ†é’Ÿï¼Œç‚¹ç‡ƒçš„æ—¶å€™åªæœ‰p&#x2F;1e4çš„æ¦‚ç‡å¯ä»¥åˆ¶ä½œæˆçœŸçƒŸèŠ±ï¼Œåœ¨åšå®Œä¸€ä¸ªçƒŸèŠ±åï¼Œä½ å¯ä»¥èŠ±è´¹måˆ†é’Ÿä¸€æ¬¡æ€§ç‚¹ç‡ƒä¹‹å‰æ‰€æœ‰çƒŸèŠ±ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªçƒŸèŠ±æˆåŠŸé‡Šæ”¾ï¼Œé‚£ä¹ˆç»“æŸï¼Œå¦åˆ™ç»§ç»­ï¼Œé—®å¦‚æœé‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œç»“æŸçš„æœ€å°æœŸæœ›æ—¶é—´ã€‚</p>
<h4 id="æ€è·¯-10"><a href="#æ€è·¯-10" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>è®¾pä¸ºåˆ¶ä½œæˆåŠŸçš„æ¦‚ç‡ è®¾ä¸ºåˆ¶ä½œå¤±è´¥çš„æ¦‚ç‡ è®¾æœ€ä¼˜è§£æƒ…å†µä¸‹æ˜¯åˆ¶ä½œä¸ªä¹‹åç‚¹ç‡ƒ, å¦‚æœé‡Šæ”¾æˆåŠŸé‚£ä¹ˆç»“æŸï¼Œå¦‚æœé‡Šæ”¾å¤±è´¥é‚£ä¹ˆä¸‹ä¸€æ¬¡è¿˜æ˜¯åˆ¶ä½œkä¸ªï¼Œ æœŸæœ›æ—¶é—´ä¸º ç°åœ¨è¦æ‰¾åˆ°æœ€å°çš„,å®¹æ˜“æ¨æµ‹å‡ºæ˜¯å•å³°å‡½æ•°ï¼Œ å› æ­¤ä¸‰åˆ†å³å¯.</p>
<ul>
<li>æ³¨æ„è°ƒç²¾åº¦</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">double</span> n,m,p;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll k)</span></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)res*=a;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        a*=a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">f</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n*(<span class="type">double</span>)x+m)/(<span class="number">1.0</span>- <span class="built_in">pow</span>(<span class="number">1.0</span>-p,(<span class="type">double</span>)x));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m&gt;&gt;p;</span><br><span class="line">    p/=<span class="number">10000.0</span>;</span><br><span class="line">    <span class="type">int</span> l=<span class="number">0</span>,r=<span class="number">1e9</span>;</span><br><span class="line">   <span class="comment">// cout&lt;&lt;f(1)&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    <span class="keyword">while</span>(r-l&gt;=<span class="number">10</span>)&#123;</span><br><span class="line">        <span class="type">int</span> m1=l+(r-l)/<span class="number">3</span>,m2=r-(r-l)/<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))&#123;</span><br><span class="line">            r=m2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l=m1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> ans=LLINF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;i++)&#123;</span><br><span class="line">        ans=<span class="built_in">min</span>(ans,<span class="built_in">f</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.10lf\n&quot;</span>,ans);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    cin&gt;&gt;T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒåˆ†"><a href="#äºŒåˆ†" class="headerlink" title="äºŒåˆ†"></a>äºŒåˆ†</h2><h3 id="P1843-å¥¶ç‰›æ™’è¡£æœ"><a href="#P1843-å¥¶ç‰›æ™’è¡£æœ" class="headerlink" title="P1843 å¥¶ç‰›æ™’è¡£æœ"></a><a href="https://www.luogu.com.cn/problem/P1843">P1843 å¥¶ç‰›æ™’è¡£æœ</a></h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050933.png" alt="image-20211117195828035"></p>
<ul>
<li>æ³¨æ„è¿™é‡Œçƒ˜å¹²æœºçš„æœ€å°ä½¿ç”¨å•ä½æ˜¯1s,é¢˜ç›®æ²¡è¯´</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a, b;</span><br><span class="line"><span class="type">int</span> w[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    ll cha = <span class="number">0</span>, cnt = x;</span><br><span class="line">    <span class="type">int</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (w[i] &gt; x * a) &#123;</span><br><span class="line">            cha = w[i] - x * a;</span><br><span class="line">            cnt -= (cha + b - <span class="number">1</span>) / b;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cnt&gt;=<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="type">int</span> ma = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; w[i];</span><br><span class="line">        ma = <span class="built_in">max</span>(ma, w[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    ma = (ma + a - <span class="number">1</span>) / a;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">1</span>, r = ma, mid;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid))r = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; l;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="G-Occupy-the-Cities"><a href="#G-Occupy-the-Cities" class="headerlink" title="G - Occupy the Cities"></a><a href="https://codeforces.com/gym/103409/problem/G">G - Occupy the Cities</a></h3><h4 id="é¢˜æ„-25"><a href="#é¢˜æ„-25" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™ä¸€ä¸ª01å­—ç¬¦ä¸²ï¼Œ1ä»£è¡¨è¢«å é¢†ã€‚æ¯ä¸€è½®æ‰€æœ‰çš„1å¯ä»¥å‘æŠŠç›¸é‚»çš„å…¶ä¸­ä¸€ä¸ªå˜æˆ1ï¼Œé—®è‡³å°‘å¤šå°‘è½®åå¯ä»¥ä½¿æ‰€æœ‰ä½ç½®éƒ½æ˜¯1ã€‚</p>
<h4 id="æ€è·¯-11"><a href="#æ€è·¯-11" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>å› ä¸ºè½®æ•°æœ€å°‘æ˜¯0æœ€å¤šæ˜¯ä¸²é•¿å‡1ï¼Œæ‰€ä»¥è€ƒè™‘äºŒåˆ†è½®æ•°ã€‚checkå‡½æ•°æœ‰ä¸€äº›ç»†èŠ‚ï¼šåœ¨ä¸­é—´çš„1ï¼Œå¯ä»¥å…ˆå‘å³æ‰©å±•ä¸€ä¸ª1ï¼ˆegï¼š00<strong>1</strong>10ï¼‰æˆ–è€…å…ˆå‘å·¦è¾¹æ‰©å±•ä¸€ä¸ª1ï¼ˆegï¼š01<strong>1</strong>00ï¼‰ç„¶åä¸¤è¾¹ä¸€èµ·æ‰©å±•ã€‚å‡è®¾äºŒåˆ†çš„ç­”æ¡ˆä¸ºxï¼Œå¦‚æœå¯¹äºä¸€ä¸ªæœ€å·¦è¾¹çš„1ï¼Œè¿™ä¸ª1å·¦è¾¹çš„0çš„ä¸ªæ•°éƒ½å¤§äºxäº†ï¼Œé‚£è‚¯å®šæ˜¯return falseã€‚ä½†å¦‚æœæ­£å¥½ç­‰äºxçš„è¯ï¼Œé‚£å°±åªèƒ½è€ƒè™‘å…ˆæŠŠå·¦è¾¹æ‰©å±•ä¸€ä¸ª1ï¼Œç„¶åä¸¤è¾¹ä¸€èµ·æ‰©å±•çš„æƒ…å†µã€‚å¦‚æœå¤§äºxï¼Œé‚£å°±å¯ä»¥å…ˆå‘å³è¾¹æ‰©å±•ä¸€ä¸ª1ï¼Œå†å‘ä¸¤è¾¹ä¸€èµ·æ‰©å±•ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¸¤ç§æƒ…å†µï¼š1.å·¦è¾¹æ‰©x-1ï¼Œå³è¾¹æ‰©x 2.å·¦è¾¹æ‰©xï¼Œå³è¾¹æ‰©x-1ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> ll maxn = <span class="number">1e6</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> ll N = <span class="number">5e6</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; a;</span><br><span class="line"><span class="type">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> now = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> sz = a.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; sz - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (now + x + <span class="number">1</span> &lt; a[i])<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (now + x &gt;= a[i]) &#123;</span><br><span class="line">            now = a[i] + x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            now = <span class="built_in">max</span>(a[i], a[i] + x - <span class="number">1</span>);<span class="comment">//å–maxæ˜¯é˜²æ­¢å½“xä¸º0æ—¶ï¼Œnowåè€Œè¿˜å‡å°çš„æƒ…å†µ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (now &gt;= a[i + <span class="number">1</span>]) &#123;<span class="comment">//å¦‚æœèƒ½æ‰©çš„æ¯”å³è¾¹é‚£ä¸ª1çš„ä½ç½®è¿˜å¤§ï¼Œé‚£å°±æŠŠnowç½®ä¸ºæ­£å¥½æŠŠa[i]~a[i+1]æ•´æ®µæ‰©å®Œ</span></span><br><span class="line">            now = a[i + <span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (now == n) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    a.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; s[i];</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">            a.<span class="built_in">push_back</span>(i + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    a.<span class="built_in">push_back</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) &#123;</span><br><span class="line">            r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, l);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="ç¬¬kä¸ªæ•°"><a href="#ç¬¬kä¸ªæ•°" class="headerlink" title="ç¬¬kä¸ªæ•°"></a><a href="https://www.acwing.com/problem/content/description/4083/">ç¬¬kä¸ªæ•°</a></h3><h4 id="é¢˜æ„-26"><a href="#é¢˜æ„-26" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å‡ºä¸€ä¸ªçŸ©é˜µï¼Œæ¯ä¸€ä¸ªä½ç½®ä¸Šçš„æ•°ï¼ŒæŠŠè¿™äº›æ•°æŒ‰ç…§éä¸¥æ ¼å•è°ƒé€’å¢çš„é¡ºåºï¼Œé—®ç¬¬kå¤§çš„æ•°æ˜¯å¤šå°‘ã€‚()</p>
<h4 id="æ€è·¯-12"><a href="#æ€è·¯-12" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>æ˜¯1e10çš„ï¼Œè€ƒè™‘äºŒåˆ†ã€‚æ¯æ¬¡äºŒåˆ†ä¸€ä¸ªæ•°xï¼Œcheckå°äºç­‰äºxçš„æ•°æœ‰å¤šå°‘ä¸ªï¼Œå¦‚æœä¸ªæ•°å¤§äºç­‰äºxè¿”å›trueï¼ˆå› ä¸ºå¯èƒ½æœ‰è¶…è¿‡1ä¸ªæ•°æ˜¯ç­‰äºxçš„ï¼Œé‚£å…¶å®ä¹Ÿæ˜¯ç¬¦åˆè¦æ±‚çš„ï¼‰ï¼Œç„¶åå‘ç°ç¬¬iè¡Œå°äºç­‰äºxçš„æ•°å°±æ˜¯,æ‰€ä»¥å¯ä»¥ç›´æ¥ï¼Œç®—å‡ºæ¥æ—¶é—´å¤æ‚åº¦å°±æ˜¯</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll n, m, k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ll a = x / i;</span><br><span class="line">        res += <span class="built_in">min</span>(a,m);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//debug(res);</span></span><br><span class="line">    <span class="keyword">if</span> (res &gt;= k)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    ll l = <span class="number">1</span>, r = n * m, mid;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        mid = l + r  &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//(mid);</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid))r= mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            l=mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt;l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="comment">//printf(&quot;Case #%d: &quot;, cas);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="P1182-æ•°åˆ—åˆ†æ®µ-Section-II"><a href="#P1182-æ•°åˆ—åˆ†æ®µ-Section-II" class="headerlink" title="P1182 æ•°åˆ—åˆ†æ®µ Section II"></a><a href="https://www.luogu.com.cn/problem/P1182">P1182 æ•°åˆ—åˆ†æ®µ Section II</a></h3><h4 id="é¢˜æ„-27"><a href="#é¢˜æ„-27" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>å¯¹äºç»™å®šçš„ä¸€ä¸ªé•¿åº¦ä¸ºNçš„æ­£æ•´æ•°æ•°åˆ— ï¼Œç°è¦å°†å…¶åˆ†æˆæ®µï¼Œå¹¶è¦æ±‚æ¯æ®µè¿ç»­ï¼Œä¸”æ¯æ®µå’Œçš„æœ€å¤§å€¼æœ€å°ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">bool</span> <span class="title">check</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>, cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sum + a[i] &lt;= x)sum += a[i];<span class="comment">//åˆ’åˆ†çš„æ¯ä¸€æ®µä¸èƒ½è¶…è¿‡x</span></span><br><span class="line">        <span class="keyword">else</span> sum = a[i], cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt &lt;= m;<span class="comment">//å¦‚æœåˆ’åˆ†çš„æ¯ä¸€æ®µéƒ½ä¸è¶…è¿‡midå¹¶ä¸”åˆ†çš„æ®µæ•°è¿˜å°äºmè¯´æ˜å¯ä»¥ç»§ç»­åˆ†</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    ll l = <span class="number">-1</span>, r = <span class="number">0</span>;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">        l = <span class="built_in">max</span>(l, a[i]);<span class="comment">//æ³¨æ„äºŒåˆ†çš„èŒƒå›´</span></span><br><span class="line">        r += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout&lt;&lt;l&lt;&lt;&#x27; &#x27;&lt;&lt;r&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        ll mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; mid &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid))r = mid;<span class="comment">//è¦ç»§ç»­åˆ†æ‰€ä»¥å‡å°mid</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            l = mid + <span class="number">1</span>;<span class="comment">//åˆ†å¾—æ®µå¤ªå¤š,è¯´æ˜ç­”æ¡ˆè¿˜å¯ä»¥ç»§ç»­å¢å¤§</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; l;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h3 id="ABC216-E-Amusement-Park"><a href="#ABC216-E-Amusement-Park" class="headerlink" title="ABC216 E Amusement Park"></a><a href="https://atcoder.jp/contests/abc216/tasks/abc216_e">ABC216 E Amusement Park</a></h3><h4 id="é¢˜æ„-28"><a href="#é¢˜æ„-28" class="headerlink" title="é¢˜æ„:"></a>é¢˜æ„:</h4><p>ç»™Nä¸ªç‚¹,Kæ¬¡è®¿é—®,æ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªå€¼,æ¯ä¸ªç‚¹å¯ä»¥è®¿é—®æ— é™æ¬¡,æ¯æ¬¡è®¿é—®å°±å¯ä»¥è·å¾—å…¶å€¼,ä½†æ¯è®¿é—®ä¸€æ¬¡è¿™ä¸ªç‚¹çš„å€¼å°±ä¼šå‡1.æœ€å¤§åŒ–Kæ¬¡è®¿é—®åå€¼çš„æ€»å’Œ.</p>
<h4 id="åšæ³•1-æ€ç»´-æ¨¡æ‹Ÿ"><a href="#åšæ³•1-æ€ç»´-æ¨¡æ‹Ÿ" class="headerlink" title="åšæ³•1:(æ€ç»´+æ¨¡æ‹Ÿ)"></a>åšæ³•1:(æ€ç»´+æ¨¡æ‹Ÿ)</h4><p>æˆ‘ä»¬éƒ½å¯ä»¥æƒ³åˆ°è¦ä¼˜å…ˆå–æœ€å¤§çš„å€¼,æ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯å°†æ•°ç»„ä»å¤§åˆ°å°æ’åº,ä½†æˆ‘ä»¬ä¸èƒ½ä¸€ç›´å–æœ€å¤§çš„é‚£ä¸ªå€¼,å› ä¸ºå®ƒæ˜¯éšç€å–å¾—æ¬¡æ•°å‡å°çš„.æ‰€ä»¥æˆ‘ä»¬èƒ½æƒ³åˆ°æŠŠæœ€å¤§çš„æ•°å–åˆ°å’Œç¬¬äºŒå¤§çš„æ•°ä¸€æ ·,ç„¶åå†å–ç¬¬äºŒå¤§çš„æ•°,å°†å…¶å–åˆ°å’Œç¬¬ä¸‰ä¸ªå¤§çš„æ•°ä¸€æ ·.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eg.</span><br><span class="line">10 9 5 4 3 -&gt; 9 9 5 4 3 -&gt; 5 5 5 4 3 -&gt; 4 4 4 4 3 -&gt; 3 3 3 3 3</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è§„å¾‹:ç¬¬iå¤§çš„æ•° å¯ä»¥è¢«å–iæ¬¡</p>
<p>æ­¤æ—¶æˆ‘ä»¬å†ç»“åˆç­‰å·®æ•°åˆ—çš„å…¬å¼å°±å¯ä»¥ç®—å‡ºç­”æ¡ˆ.</p>
<p>ç»†èŠ‚éƒ¨åˆ†ä¼šåœ¨ä»£ç ä¸­æ³¨é‡Šå‡ºæ¥</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL pair<span class="string">&lt;ull,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ull unsigned long long</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll n, m, k;</span><br><span class="line">PLL a[N];<span class="comment">//a[i].firstå­˜å€¼, a[i].secondå­˜ä»å¤§åˆ°å°æ’åºåå½“å‰æ•°å’Œåä¸€ä¸ªæ•°çš„å·®å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync._with_stdio(false);</span></span><br><span class="line">    n = <span class="built_in">read</span>(), k = <span class="built_in">read</span>();</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        a[i].fi = <span class="built_in">read</span>();</span><br><span class="line">        ans += a[i].fi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (k &gt;= ans) &#123;<span class="comment">//å¦‚æœkæ¯”æ‰€æœ‰æ•°å­—åŠ èµ·æ¥éƒ½å¤§,é‚£ç›´æ¥è®¡ç®—æ‰€æœ‰æ•°å­—1~a[i]çš„å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sum += (a[i].fi + <span class="number">1</span>) * a[i].fi / <span class="number">2</span>;<span class="comment">//ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">sort</span>(a, a + n);</span><br><span class="line">        <span class="built_in">reverse</span>(a, a + n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            a[i].se = (a[i].fi - a[i + <span class="number">1</span>].fi);</span><br><span class="line">        &#125;</span><br><span class="line">        a[n - <span class="number">1</span>].se = a[n - <span class="number">1</span>].fi;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i].se * (i + <span class="number">1</span>) &lt; k) &#123;<span class="comment">//ç¬¬iå¤§çš„æ•°æœ‰iä¸ª</span></span><br><span class="line">                k -= a[i].se * (i + <span class="number">1</span>);<span class="comment">//å…¨éƒ¨ç”¨å®Œ</span></span><br><span class="line">                sum += (a[i].se * a[i].fi - (a[i].se * (a[i].se - <span class="number">1</span>)) / <span class="number">2</span>) * (i + <span class="number">1</span>);</span><br><span class="line">                <span class="comment">//cout &lt;&lt; sum &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ll t = k / (i + <span class="number">1</span>);</span><br><span class="line">                ll left = k % (i + <span class="number">1</span>);<span class="comment">//è¿™iä¸ªæ•°åŒæ—¶ç­‰å·®æ•°åˆ—æ±‚å’Œåˆ°æœ€åä¸ä¸€å®šéƒ½èƒ½ç”¨å®Œ</span></span><br><span class="line">               <span class="comment">// cout&lt;&lt;a[i].fi&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">                sum += (a[i].fi * t - t * (t - <span class="number">1</span>) / <span class="number">2</span>) * (i + <span class="number">1</span>);</span><br><span class="line">                sum += left * (a[i].fi - t);</span><br><span class="line">                k = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (k == <span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="åšæ³•2-äºŒåˆ†"><a href="#åšæ³•2-äºŒåˆ†" class="headerlink" title="åšæ³•2:(äºŒåˆ†)"></a>åšæ³•2:(äºŒåˆ†)</h4><p>å…ˆæ‰¾å‡ºæ‰€æœ‰æ•°çš„æœ€å¤§å€¼,ç›´æ¥äºŒåˆ†ç­”æ¡ˆ.checkå‡½æ•°é‡Œåˆ¤æ–­<strong>å½“å‰æ¯”midå¤§çš„æ•°</strong>å’Œ<strong>midçš„å·®å€¼</strong>çš„<strong>å’Œ</strong>æ˜¯å¦å¤§äºk,å¦‚æœå¤§äºè¯´æ˜midå€¼å–å°äº†,å¦‚æœå°äºè¯´æ˜midå€¼å–å¤§äº†.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll n, m, k;</span><br><span class="line">ll a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(ll mid)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; </span><br><span class="line">    i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; mid)ans += a[i] - mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans&lt;=k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    ll maxx = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)cin &gt;&gt; a[i], maxx = <span class="built_in">max</span>(maxx, a[i]);</span><br><span class="line">    ll l = <span class="number">0</span>, r = maxx;</span><br><span class="line">    ll mid;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) &#123;</span><br><span class="line">            r = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">sort</span>(a, a + n);</span><br><span class="line">    <span class="built_in">reverse</span>(a, a + n);</span><br><span class="line">    <span class="comment">//cout &lt;&lt; l &lt;&lt; &#x27; &#x27; &lt;&lt; r &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; l) &#123;</span><br><span class="line">            ans += (a[i] + l) * (a[i] - l + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">            cnt += a[i] - l + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans -= (cnt - k) * l;<span class="comment">//æŠŠå¤šç®—çš„å‡æ‰</span></span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 10</span></span><br><span class="line"><span class="comment">10 9 5 4 3</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>



<h3 id="ABC192-D-Base-n"><a href="#ABC192-D-Base-n" class="headerlink" title="ABC192-D Base n"></a><a href="https://atcoder.jp/contests/abc192/tasks/abc192_d">ABC192-D Base n</a></h3><h4 id="é¢˜æ„-29"><a href="#é¢˜æ„-29" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”±â€˜0â€™~â€˜9â€™ç»„æˆï¼Œè®¾æ˜¯ä¸­æœ€å¤§çš„æ•°å­—ï¼Œæ±‚æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•´æ•°ï¼Œæ•´æ•°æœ‰ä»¥ä¸‹è¦æ±‚ï¼š</p>
<ul>
<li>æ˜¯ä¸€ä¸ªnè¿›åˆ¶æ•°</li>
<li>è¿™ä¸ªæ•°çš„nè¿›åˆ¶è¡¨ç¤ºæ˜¯</li>
<li>nè¿›åˆ¶å¯¹åº”çš„åè¿›åˆ¶æ•°</li>
</ul>
<h4 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">ll n, m;</span><br><span class="line">string s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(__int128 mid)</span> </span>&#123;</span><br><span class="line">    __int128 ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (__int128 i = s.<span class="built_in">length</span>() - <span class="number">1</span>, j = <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--, j *= mid) &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &gt; m)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        ans +=  (s[i] - <span class="string">&#x27;0&#x27;</span>) * j;</span><br><span class="line">        <span class="keyword">if</span> (ans &gt; m)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans &lt;= m)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; s &gt;&gt; m;</span><br><span class="line">    <span class="type">int</span> d = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: s) &#123;</span><br><span class="line">        d = <span class="built_in">max</span>(d, (i - <span class="string">&#x27;0&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">length</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] - <span class="string">&#x27;0&#x27;</span> &lt;= m) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ll l = d + <span class="number">1</span>, r = m;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            <span class="comment">//cout &lt;&lt; l &lt;&lt; &#x27; &#x27; &lt;&lt; r &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">            ll mid = l + r + <span class="number">1</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) &#123;</span><br><span class="line">                l = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; l &lt;&lt; &#x27; &#x27; &lt;&lt; r &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(l))cout &lt;&lt; l - d;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">0</span>;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="https-atcoder-jp-contests-abc215-tasks-abc215-f-äºŒåˆ†-åŒæŒ‡é’ˆ-è´ªå¿ƒ"><a href="#https-atcoder-jp-contests-abc215-tasks-abc215-f-äºŒåˆ†-åŒæŒ‡é’ˆ-è´ªå¿ƒ" class="headerlink" title="https://atcoder.jp/contests/abc215/tasks/abc215_f (äºŒåˆ†+åŒæŒ‡é’ˆ+è´ªå¿ƒ)"></a><a href="https://atcoder.jp/contests/abc215/tasks/abc215_f">https://atcoder.jp/contests/abc215/tasks/abc215_f</a> (äºŒåˆ†+åŒæŒ‡é’ˆ+è´ªå¿ƒ)</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">PLL a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(ll mid)</span> </span>&#123;</span><br><span class="line">    ll miny = INF, maxy = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; i &amp;&amp; a[i].fi - a[j].fi &gt;= mid) &#123;<span class="comment">//a[i].feå› ä¸ºæ’åºäº†æ‰€ä»¥å·®å€¼è‚¯å®šæ˜¯é€’å¢çš„</span></span><br><span class="line">            miny = <span class="built_in">min</span>(miny, a[j].se);</span><br><span class="line">            maxy = <span class="built_in">max</span>(maxy, a[j].se);</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (maxy != <span class="number">-1</span> &amp;&amp; miny != INF &amp;&amp; (<span class="built_in">abs</span>(a[i].se - miny) &gt;= mid || <span class="built_in">abs</span>(a[i].se - maxy) &gt;= mid))<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; a[i].fi &gt;&gt; a[i].se;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a, a + n);</span><br><span class="line">    ll l = <span class="number">0</span>, r = <span class="number">1e9</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        ll mid = l + r + <span class="number">1</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// cout &lt;&lt; mid &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">check</span>(mid))l = mid;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;l;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><h2 id="åç¼€è‡ªåŠ¨æœº-åç¼€æ•°ç»„"><a href="#åç¼€è‡ªåŠ¨æœº-åç¼€æ•°ç»„" class="headerlink" title="åç¼€è‡ªåŠ¨æœº&#x2F;åç¼€æ•°ç»„"></a>åç¼€è‡ªåŠ¨æœº&#x2F;åç¼€æ•°ç»„</h2><h3 id="String-Problem"><a href="#String-Problem" class="headerlink" title="String Problem"></a><a href="https://ac.nowcoder.com/acm/contest/24346/M">String Problem</a></h3><p>æ±‚ç»™å®šå­—ç¬¦ä¸²çš„æ‰€æœ‰å‰ç¼€ä¸­æœ€é•¿çš„å­—å…¸åºæœ€å¤§çš„ä¸²</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050948.png" alt="image-20211124213208730"></p>
<h4 id="åç¼€è‡ªåŠ¨æœºåšæ³•ï¼š"><a href="#åç¼€è‡ªåŠ¨æœºåšæ³•ï¼š" class="headerlink" title="åç¼€è‡ªåŠ¨æœºåšæ³•ï¼š"></a>åç¼€è‡ªåŠ¨æœºåšæ³•ï¼š</h4><p>ç”¨ä¸€ä¸ªposè®°å½•åç¼€è‡ªåŠ¨æœºä¸­çš„èŠ‚ç‚¹å¯¹åº”åŸä¸²ä¸­èŠ‚ç‚¹çš„ä½ç½®ï¼Œç„¶åç›´æ¥ä»â€™zâ€™åˆ°â€™aâ€™è´ªå¿ƒçš„åœ¨åç¼€è‡ªåŠ¨æœºä¸Šdfsï¼Œç¬¬ä¸€æ¬¡æœåˆ°çš„è‚¯å®šæ˜¯å­—å…¸åºæœ€å¤§çš„ï¼Œè®°å½•å…¶æ˜ å°„åœ¨åŸä¸²ä¸Šçš„ä½ç½®ä»¥åŠæ·±åº¦å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2000010</span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="type">int</span> len, fa;</span><br><span class="line">    <span class="type">int</span> ch[<span class="number">26</span>];</span><br><span class="line">&#125; node[N];</span><br><span class="line"><span class="type">char</span> str[N];</span><br><span class="line">LL f[N];</span><br><span class="line"><span class="type">int</span> h[N], e[N], ne[N], idx;</span><br><span class="line"><span class="type">int</span> pos[N];<span class="comment">//è®°å½•åç¼€è‡ªåŠ¨æœºä¸­çš„èŠ‚ç‚¹å¯¹åº”åŸä¸²ä¸­èŠ‚ç‚¹çš„ä½ç½®</span></span><br><span class="line"><span class="type">int</span> vis[N];</span><br><span class="line"><span class="type">int</span> ans[N];</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯¹äºèŠ‚ç‚¹uçš„å­ä¸²é›†åˆ æœ€é•¿çš„æ˜¯node[u].len ,æœ€çŸ­çš„æ˜¯node[node[u].fa].len+1</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c, <span class="type">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//faï¼šfailæ•°ç»„ chï¼štrieæ ‘ len:è¿™ä¸ªèŠ‚ç‚¹é›†åˆä¸­å­—ç¬¦ä¸²æœ€é•¿é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> p = last, np = last = ++tot;<span class="comment">//npï¼šåˆæ­¥å»ºç«‹çš„åç¼€è‡ªåŠ¨æœº</span></span><br><span class="line">    pos[np] = id;</span><br><span class="line">    f[tot] = <span class="number">1</span>;<span class="comment">//è®°å½•æ¯ä¸ªå­ä¸²å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">    node[np].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p &amp;&amp; !node[p].ch[c]; p = node[p].fa) node[p].ch[c] = np;</span><br><span class="line">    <span class="keyword">if</span> (!p) node[np].fa = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">int</span> q = node[p].ch[c];</span><br><span class="line">        <span class="keyword">if</span> (node[q].len == node[p].len + <span class="number">1</span>) node[np].fa = q;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> nq = ++tot;<span class="comment">//nqï¼šå½“æŸèŠ‚ç‚¹æ²¡æœ‰åˆé€‚çš„ç‚¹åšFailçš„çˆ¶äº²æ—¶ï¼Œéœ€è¦çš„æ·»åŠ å…¬å…±èŠ‚ç‚¹</span></span><br><span class="line">            pos[nq] = pos[q];<span class="comment">//!!!!æ³¨æ„è¿™é‡Œä¹Ÿè¦æ ‡è®°</span></span><br><span class="line">            node[nq] = node[q], node[nq].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">            node[q].fa = node[np].fa = nq;</span><br><span class="line">            <span class="keyword">for</span> (; p &amp;&amp; node[p].ch[c] == q; p = node[p].fa) node[p].ch[c] = nq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> dept)</span> </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">25</span>; i &gt;= <span class="number">0</span>; i--) &#123;<span class="comment">//ç›´æ¥ç¡¬æœ</span></span><br><span class="line">        <span class="keyword">if</span> (node[u].ch[i] &amp;&amp; !vis[node[u].ch[i]]) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(node[u].ch[i], dept + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ans[pos[u]])ans[pos[u]] = pos[u] - dept + <span class="number">1</span>;<span class="comment">//æœåˆ°åº•äº†ï¼Œå› ä¸ºæ˜¯ä»&#x27;z&#x27;åˆ°&#x27;a&#x27;æœï¼Œç¬¬ä¸€æ¬¡æœåˆ°çš„ä¸€å®šæ˜¯å­—å…¸åºæœ€å¤§çš„ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; str[i]; i++) <span class="built_in">extend</span>(str[i] - <span class="string">&#x27;a&#x27;</span>, i+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; str[i]; i++)<span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, ans[i+<span class="number">1</span>], i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="åç¼€æ•°ç»„åšæ³•ï¼š"><a href="#åç¼€æ•°ç»„åšæ³•ï¼š" class="headerlink" title="åç¼€æ•°ç»„åšæ³•ï¼š"></a>åç¼€æ•°ç»„åšæ³•ï¼š</h4><p>ä»åå¾€å‰æšä¸¾Saæ•°ç»„ï¼ˆå­—å…¸åºæ’åä»å¤§åˆ°å°ï¼‰ï¼Œå¯¹äºå½“å‰ï¼Œåœ¨ä¹‹åçš„ç­”æ¡ˆï¼ˆå¹¶ä¸”å°äºä¸Šä¸€ä¸ªæ’åå¤„ç†çš„æœ‰è¾¹ç•Œï¼‰å¯¹åº”ä¸€å®šæ˜¯è¯¥æ’åçš„åç¼€ï¼Œå¦‚æœå‰ä¸€ä¸ªsaæ•°ç»„çš„ä½ç½®åœ¨å½“å‰çš„åé¢ï¼Œå°±ä¸ç”¨ç®¡ï¼Œä¸€ç›´æ‰¾åˆ°åœ¨å½“å‰å‰é¢ä¸ºæ­¢ï¼Œå¦‚æœå°±è¯´æ˜å…¶å®å¦‚æœç»§ç»­å¾€å‰å–è¿˜èƒ½å–åˆ°æ›´é•¿çš„å¹¶ä¸”å­—å…¸åºæ’åä¸å°äºçš„åç¼€ï¼Œæ‰€ä»¥ç»§ç»­å¾€å‰æ‰¾</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> sa[N], x[N], y[N], c[N], rk[N], height[N];</span><br><span class="line"><span class="type">int</span> ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_sa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) c[x[i] = s[i]]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; i++) c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i--) sa[c[x[i]]--] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; i++) y[++num] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">                y[++num] = sa[i] - k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) c[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) c[x[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; i++) c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i--) sa[c[x[y[i]]]--] = y[i], y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">        x[sa[<span class="number">1</span>]] = <span class="number">1</span>, num = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">            x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++num;</span><br><span class="line">        <span class="keyword">if</span> (num == n) <span class="keyword">break</span>;</span><br><span class="line">        m = num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_height</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) rk[sa[i]] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (rk[i] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (k) k--;</span><br><span class="line">        <span class="type">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; s[i + k] == s[j + k]) k++;</span><br><span class="line">        height[rk[i]] = k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), m = <span class="string">&#x27;z&#x27;</span>;</span><br><span class="line">    <span class="built_in">get_sa</span>();</span><br><span class="line">    <span class="built_in">get_height</span>();</span><br><span class="line">    <span class="type">int</span> r=n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> st=sa[i];</span><br><span class="line">        <span class="type">int</span> pos=i<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(sa[pos]&gt;=sa[i])height[i]=<span class="built_in">min</span>(height[i],height[pos]),pos--;</span><br><span class="line">        <span class="keyword">if</span>(st+height[i]&gt;r)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=st+height[i];j&lt;=r;j++)ans[j]=sa[i];</span><br><span class="line">        r=st+height[i]<span class="number">-1</span>;</span><br><span class="line">        i=pos+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        cout&lt;&lt;ans[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;i&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="exkmp"><a href="#exkmp" class="headerlink" title="exkmp"></a>exkmp</h2><h3 id="D-Period"><a href="#D-Period" class="headerlink" title="D - Period"></a><a href="https://codeforces.com/gym/103428/problem/D">D - Period</a></h3><h3 id="é¢˜æ„-30"><a href="#é¢˜æ„-30" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™ä¸€ä¸ª1e6çš„å­—ç¬¦ä¸²ï¼Œ1e6ä¸ªè¯¢é—®ï¼šæŠŠç¬¬xä¸ªä½ç½®çš„å­—ç¬¦æ¢æˆâ€˜#â€™ï¼Œå­—ç¬¦ä¸²æœ‰å¤šå°‘ä¸ªä¸åŒçš„å‘¨æœŸï¼Ÿ</p>
<p>å¦‚å­—ç¬¦ä¸²é•¿åº¦ä¸º4 å°±æœ‰å¾ªç¯èŠ‚é•¿åº¦ä¸º1ï¼Œ2ï¼Œ3ç§å‘¨æœŸã€‚</p>
<h3 id="æ€è·¯-13"><a href="#æ€è·¯-13" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è¦æ±‚è¿™ä¸ªä¸²å¾ªç¯èŠ‚ä¸ºçš„å‘¨æœŸï¼Œå…¶å®å°±æ˜¯çœ‹æœ‰å¤šå°‘å‰ç¼€ä¸åç¼€ç›¸ç­‰ã€‚</p>
<p>å¯¹åŸä¸²æœ¬èº«æ±‚exkmpï¼Œå¾—åˆ°å…¶æ¯ä¸ªåç¼€å’ŒåŸä¸²èƒ½åŒ¹é…çš„æœ€é•¿å‰ç¼€çš„é•¿åº¦ï¼Œå¦‚æœè¿™ä¸ªé•¿åº¦ç­‰äºè¯¥åç¼€çš„é•¿åº¦ï¼Œé‚£å°±è¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¾ªç¯ã€‚æ‰¾åˆ°æ‰€æœ‰è¿™æ ·çš„å¾ªç¯æŠŠå¯¹åº”çš„å‰ç¼€çš„ä½ç½®ä¸Šæ‰“ä¸Šæ ‡è®°ï¼Œè¯´æ˜åˆ°è¿™é‡Œèƒ½æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œç„¶ååšå‰ç¼€å’Œï¼Œå°±èƒ½å¿«é€ŸæŸ¥è¯¢åˆ°ä¸²ä¸­ä»»æ„å‰ç¼€èƒ½æœ‰å¤šå°‘ä¸ªå¾ªç¯ã€‚æŠŠxä½ç½®æ›¿æ¢æˆ#ï¼Œè¿™æ—¶å€™çš„å‘¨æœŸæ•°å°±æ˜¯ï¼ˆæ³¨æ„x&#x3D;1æ—¶è¦ç‰¹åˆ¤ï¼Œå› ä¸ºå¦‚æœæŠŠç¬¬ä¸€ä¸ªä½ç½®æ¢æˆ#ä¹‹åä¸å¯èƒ½æœ‰å‘¨æœŸä¸å…¶åŒ¹é…ã€‚ï¼‰ä¸ºä»€ä¹ˆæ˜¯è¦æ˜¯å› ä¸º#å¯¹ä¸²çš„å½±å“æ˜¯è®©åˆ°è¿™ä¸ª#çš„å‘¨æœŸå…¨éƒ¨å¤±æ•ˆï¼Œæ‰€ä»¥è¦æ‰¾æœ€å°å€¼ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">char</span> p[N];</span><br><span class="line"><span class="type">int</span> nxt[N];<span class="comment">//p[i]...p[m - 1]ä¸Tçš„æœ€é•¿ç›¸åŒå‰ç¼€é•¿åº¦</span></span><br><span class="line"><span class="type">int</span> extend[N];</span><br><span class="line"><span class="type">int</span> n;<span class="comment">//sçš„é•¿</span></span><br><span class="line"><span class="type">int</span> m;<span class="comment">//pçš„é•¿</span></span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="type">int</span> tag[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetNext</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">    nxt[<span class="number">0</span>] = m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= pos || i + nxt[i - a] &gt;= pos)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= pos)</span><br><span class="line">                pos = i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; m &amp;&amp; p[pos] == p[pos - i])</span><br><span class="line">                pos++;</span><br><span class="line"></span><br><span class="line">            nxt[i] = pos - i;</span><br><span class="line">            a = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            nxt[i] = nxt[i - a];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ±‚è§£ extend[] */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetExtend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">GetNext</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= pos || i + nxt[i - a] &gt;= pos) <span class="comment">// i &gt;= p çš„ä½œç”¨ï¼šä¸¾ä¸ªå…¸å‹ä¾‹å­ï¼Œs å’Œ p æ— ä¸€å­—ç¬¦ç›¸åŒ</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= pos)</span><br><span class="line">                pos = i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; n &amp;&amp; pos - i &lt; m &amp;&amp; s[pos] == p[pos - i])</span><br><span class="line">                pos++;</span><br><span class="line"></span><br><span class="line">            extend[i] = pos - i;</span><br><span class="line">            a = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            extend[i] = nxt[i - a];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,s);</span><br><span class="line">    n=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="built_in">strcpy</span>(p,s);</span><br><span class="line">    m=n;</span><br><span class="line">    <span class="built_in">GetExtend</span>();</span><br><span class="line">    <span class="comment">//for(int i=0;i&lt;n;i++)cout&lt;&lt;extend[i]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(extend[i]==n-i)tag[n-i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//for(int i=0;i&lt;n;i++)cout&lt;&lt;tag[i]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">    <span class="comment">//cout&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)pre[i]=pre[i<span class="number">-1</span>]+tag[i];</span><br><span class="line">    <span class="comment">//for(int i=0;i&lt;n;i++)cout&lt;&lt;pre[i]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;q);</span><br><span class="line">    <span class="keyword">while</span>(q--)&#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">        <span class="comment">//cout&lt;&lt;min(x-1,n-x)&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">        cout&lt;&lt;pre[<span class="built_in">min</span>(x<span class="number">-1</span>,n-x)]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">   <span class="comment">// T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å‰ç¼€å’Œ-å·®åˆ†"><a href="#å‰ç¼€å’Œ-å·®åˆ†" class="headerlink" title="å‰ç¼€å’Œ&#x2F;å·®åˆ†"></a>å‰ç¼€å’Œ&#x2F;å·®åˆ†</h2><h2 id="ç¦»æ•£åŒ–-å·®åˆ†"><a href="#ç¦»æ•£åŒ–-å·®åˆ†" class="headerlink" title="ç¦»æ•£åŒ–+å·®åˆ†"></a>ç¦»æ•£åŒ–+å·®åˆ†</h2><h3 id="Acwing1987-ç²‰åˆ·æ …æ "><a href="#Acwing1987-ç²‰åˆ·æ …æ " class="headerlink" title="Acwing1987.ç²‰åˆ·æ …æ "></a><a href="#">Acwing1987.ç²‰åˆ·æ …æ </a></h3><h4 id="é¢˜æ„-31"><a href="#é¢˜æ„-31" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>è¾“å…¥nä¸ªæŒ‡ä»¤ï¼Œæ¯ä¸ªæŒ‡ä»¤ä»£è¡¨ä»å½“å‰ç‚¹å‘å·¦æˆ–å‘å³æŸ“è‰²xä¸ªåŒºé—´ï¼ˆä»0ç‚¹å¼€å§‹ï¼‰ï¼Œé—®æœ€åæœ‰å¤šå°‘åŒºé—´è¢«æŸ“è‰²è¶…è¿‡ä¸¤æ¬¡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201121656956.png" alt="image-20220112165157656"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">2 R</span><br><span class="line">6 L</span><br><span class="line">1 R</span><br><span class="line">8 L</span><br><span class="line">1 R</span><br><span class="line">2 R</span><br></pre></td></tr></table></figure>

<h4 id="é¢˜è§£-4"><a href="#é¢˜è§£-4" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201180050431.png" alt="image-20220112165808846"></p>
<p>å…ˆè¦è¿›è¡Œè½¬æ¢ï¼Œå› ä¸ºå·®åˆ†æ˜¯å¯¹ç‚¹è¿›è¡Œæ“ä½œï¼Œæˆ‘ä»¬å°±æŠŠ0çœ‹ä½œä»£è¡¨åŒºé—´ï¼Œ1ä»£è¡¨åŒºé—´ã€‚</p>
<p>ç„¶åç”¨mapç¦»æ•£åŒ–ï¼Œç„¶åæ ¹æ®å·®åˆ†æ•°ç»„æ±‚åŸæ•°ç»„ï¼Œæ³¨æ„è¿™é‡Œå› ä¸ºæ•°æ®èŒƒå›´å¤ªå¤§ä¸èƒ½æŠŠåŸæ•°ç»„æ¯ä¸ªä½ç½®çš„å€¼æ±‚å‡ºæ¥ï¼Œåªèƒ½å¾—åˆ°åŒºé—´ç«¯ç‚¹çš„å€¼ï¼Œç„¶åå°±ç”¨ä¸€ä¸ªç±»ä¼¼äºåŒæŒ‡é’ˆçš„æ–¹æ³•æ±‚ï¼Œå…·ä½“çœ‹ä»£ç ã€‚</p>
<h4 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp, sum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cha</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span> </span>&#123;</span><br><span class="line">    mp[l] += v;</span><br><span class="line">    mp[r + <span class="number">1</span>] -= v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">int</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//0ä»£è¡¨ï¼ˆ0ï¼Œ1ï¼‰åŒºé—´ï¼Œ1ä»£è¡¨ï¼ˆ1ï¼Œ2ï¼‰åŒºé—´</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="type">char</span> direction;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; direction;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (direction == <span class="string">&#x27;R&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">cha</span>(last, last + x - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="comment">//cout&lt;&lt;last&lt;&lt;&#x27; &#x27;&lt;&lt;last+x&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">            last = last + x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">cha</span>(last - x, last - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="comment">//cout&lt;&lt;last-x+1&lt;&lt;&#x27; &#x27;&lt;&lt;last&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">            last = last - x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout&lt;&lt;x&lt;&lt;&#x27; &#x27;&lt;&lt;direction&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: mp) &#123;</span><br><span class="line">        <span class="keyword">if</span> (flag == <span class="number">0</span>) &#123;</span><br><span class="line">            flag = <span class="number">1</span>;</span><br><span class="line">            sum[i.fi] += mp[i.fi];</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sum[i.fi] = sum[i.fi - <span class="number">1</span>] + mp[i.fi];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> l = mp.<span class="built_in">begin</span>()-&gt;fi, r = mp.<span class="built_in">begin</span>()-&gt;fi;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i: mp) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ans &lt;= <span class="number">1</span> &amp;&amp; ans + i.se &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            l = i.fi;<span class="comment">//æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„åŒºé—´çš„å·¦ç«¯ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ans &gt; <span class="number">1</span> &amp;&amp; ans + i.se &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            r = i.fi;<span class="comment">//æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„åŒºé—´çš„å³ç«¯ç‚¹</span></span><br><span class="line">            cnt += r - l;<span class="comment">//å€¼</span></span><br><span class="line">        &#125;</span><br><span class="line">        ans += i.se;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/17/Reinhart's%20problem%20set/" data-id="cmb2ap95c000q48uc6atjdyab" data-title="Reinhart&#39;s problem set" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">ä¸ªäºº</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Reinhart&#39;s algorithm template" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/15/Reinhart's%20algorithm%20template/" class="article-date">
  <time class="dt-published" datetime="2021-01-15T12:34:50.000Z" itemprop="datePublished">2021-01-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/15/Reinhart's%20algorithm%20template/">Reinhart&#39;s algorithm template</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Dijkstra"><a href="#Dijkstra" class="headerlink" title="Dijkstra"></a>Dijkstra</h2><h3 id="æœ´ç´ -O-N-2"><a href="#æœ´ç´ -O-N-2" class="headerlink" title="æœ´ç´  $O(N^2)$"></a>æœ´ç´  $O(N^2)$</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">510</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> g[N][N];<span class="comment">//é‚»æ¥çŸ©é˜µå­˜ç¨ å¯†å›¾</span></span><br><span class="line"><span class="type">int</span> dis[N];<span class="comment">//è¯¥ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»</span></span><br><span class="line"><span class="type">bool</span> st[N];<span class="comment">//æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æ˜¯å¦å·²ç»ç¡®å®š</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">	  <span class="built_in">memset</span>(st,<span class="literal">false</span>,<span class="keyword">sizeof</span> st);</span><br><span class="line">    dis[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> t = <span class="number">-1</span>;<span class="comment">//å°†tè®¾ç½®ä¸º-1 å› ä¸ºDijkstraç®—æ³•é€‚ç”¨äºä¸å­˜åœ¨è´Ÿæƒè¾¹çš„å›¾</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!st[j] &amp;&amp; (t == <span class="number">-1</span> || dis[t] &gt; dis[j]))t = j;<span class="comment">//è¯¥æ­¥éª¤å³å¯»æ‰¾è¿˜æœªç¡®å®šæœ€çŸ­è·¯çš„ç‚¹ä¸­è·¯å¾„æœ€çŸ­çš„ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        st[t] = <span class="literal">true</span>;<span class="comment">//ç¬¬tä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„å·²ç»ç¡®å®š</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            dis[j] = <span class="built_in">min</span>(dis[j], dis[t] + g[t][j]); <span class="comment">//ç”¨tå»æ›´æ–°tèƒ½è¾¾åˆ°çš„ç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">memset</span>(g, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> g);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å †ä¼˜åŒ–-O-NlogN"><a href="#å †ä¼˜åŒ–-O-NlogN" class="headerlink" title="å †ä¼˜åŒ– $O(NlogN)$"></a>å †ä¼˜åŒ– $O(NlogN)$</h3><h4 id="é“¾æ˜Ÿç‰ˆ"><a href="#é“¾æ˜Ÿç‰ˆ" class="headerlink" title="é“¾æ˜Ÿç‰ˆ"></a>é“¾æ˜Ÿç‰ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">150010</span>;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;PII;</span><br><span class="line"><span class="type">int</span> h[N],e[N],ne[N],idx=<span class="number">0</span>,w[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> c)</span></span>&#123;</span><br><span class="line">    w[idx]=c;</span><br><span class="line">    e[idx]=b;</span><br><span class="line">    ne[idx]=h[a];</span><br><span class="line">    h[a]=idx++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,<span class="keyword">sizeof</span> dis);</span><br><span class="line">    <span class="built_in">memset</span>(st,<span class="literal">false</span>,<span class="keyword">sizeof</span> st);</span><br><span class="line">    priority_queue&lt;PII,vector&lt;PII&gt;,greater&lt;PII&gt;&gt;heap;</span><br><span class="line">    dis[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>,<span class="number">1</span>&#125;);</span><br><span class="line">    <span class="keyword">while</span>(heap.<span class="built_in">size</span>())&#123;</span><br><span class="line">        <span class="keyword">auto</span> t=heap.<span class="built_in">top</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> ver=t.second,distance=t.first;</span><br><span class="line">        <span class="keyword">if</span>(st[ver])<span class="keyword">continue</span>;</span><br><span class="line">        st[ver]=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=h[ver];~i;i=ne[i])&#123;</span><br><span class="line">            <span class="type">int</span> j=e[i];</span><br><span class="line">            <span class="keyword">if</span>(dis[j]&gt;distance+w[i]) &#123;</span><br><span class="line">                dis[j] = distance + w[i];</span><br><span class="line">                heap.<span class="built_in">push</span>(&#123;dis[j], j&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span> h);</span><br><span class="line"></span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        <span class="type">int</span> a,b,c;</span><br><span class="line">        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">        <span class="built_in">add</span>(a,b,c);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="vectoræ•°ç»„ç‰ˆ"><a href="#vectoræ•°ç»„ç‰ˆ" class="headerlink" title="vectoræ•°ç»„ç‰ˆ"></a>vectoræ•°ç»„ç‰ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;PII &gt; g[N];</span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt; heap;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dis);</span><br><span class="line">    heap.<span class="built_in">push</span>(&#123;<span class="number">0</span>, T&#125;);</span><br><span class="line">    dis[T]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = heap.<span class="built_in">top</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> ver = t.se, distance = t.fi;</span><br><span class="line">        <span class="keyword">if</span> (st[ver])<span class="keyword">continue</span>;</span><br><span class="line">        st[ver] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; g[ver].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">auto</span> j = g[ver][i];</span><br><span class="line">            <span class="keyword">if</span> (dis[j.fi] &gt; distance + j.se) &#123;</span><br><span class="line">                dis[j.fi] = distance + j.se;</span><br><span class="line">                heap.<span class="built_in">push</span>(&#123;dis[j.fi], j.fi&#125;);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¿«æ’"><a href="#å¿«æ’" class="headerlink" title="å¿«æ’"></a>å¿«æ’</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">quick_sort</span><span class="params">(<span class="type">int</span> q[], <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> x = q[l + r &gt;&gt; <span class="number">1</span>];<span class="comment">//ç¡®å®šåˆ†ç•Œç‚¹</span></span><br><span class="line">    <span class="type">int</span> i = l - <span class="number">1</span>, j = r + <span class="number">1</span>;<span class="comment">//å› ä¸ºæ˜¯å…ˆç§»åŠ¨å†äº¤æ¢</span></span><br><span class="line">    <span class="keyword">while</span> (i &lt; j)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">do</span> i ++ ; <span class="keyword">while</span> (q[i] &lt; x);</span><br><span class="line">        <span class="keyword">do</span> j -- ; <span class="keyword">while</span> (q[j] &gt; x);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) <span class="built_in">swap</span>(q[i], q[j]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">quick_sort</span>(q, l, j);</span><br><span class="line">    <span class="built_in">quick_sort</span>(q, j + <span class="number">1</span>, r);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŸƒæ°ç­›"><a href="#åŸƒæ°ç­›" class="headerlink" title="åŸƒæ°ç­›"></a>åŸƒæ°ç­›</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> prime[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Egypt_Prime</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n/i;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!st[i])&#123;</span><br><span class="line">            prime[cnt++]=i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+i;j&lt;=n;j+=i)st[j]= <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">x	</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çº¿æ€§ç­›"><a href="#çº¿æ€§ç­›" class="headerlink" title="çº¿æ€§ç­›"></a>çº¿æ€§ç­›</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> prime[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_prime</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!st[i])prime[cnt++]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;prime[j]&lt;=n/i;j++)&#123;</span><br><span class="line">            st[prime[j]*i]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>)<span class="keyword">break</span>;<span class="comment">//å› ä¸ºprimeæ˜¯ä»å°åˆ°å¤§æšä¸¾ï¼Œæ‰€ä»¥å¦‚æœi%prime[j]==0è¯´æ˜prime[j]æ˜¯içš„æœ€å°è´¨å› å­</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¤§æ•°åŠ "><a href="#å¤§æ•°åŠ " class="headerlink" title="å¤§æ•°åŠ "></a>å¤§æ•°åŠ </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">add</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;A, vector&lt;<span class="type">int</span>&gt; &amp;B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A.<span class="built_in">size</span>() &lt; B.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="built_in">add</span>(B, A);</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; C;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; A.<span class="built_in">size</span>(); i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        t += A[i];</span><br><span class="line">        <span class="keyword">if</span> (i &lt; B.<span class="built_in">size</span>()) t += B[i];</span><br><span class="line">        C.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t) C.<span class="built_in">push_back</span>(t);</span><br><span class="line">    <span class="keyword">return</span> C;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string a, b;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; A, B;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = a.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) A.<span class="built_in">push_back</span>(a[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = b.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) B.<span class="built_in">push_back</span>(b[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> C = <span class="built_in">add</span>(A, B);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = C.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) cout &lt;&lt; C[i];</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> p[N]; <span class="comment">//å­˜å‚¨æ¯ä¸ªç‚¹çš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›xçš„ç¥–å®—èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p[x] != x) p[x] = <span class="built_in">find</span>(p[x]);</span><br><span class="line">    <span class="keyword">return</span> p[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ï¼Œå‡å®šèŠ‚ç‚¹ç¼–å·æ˜¯1~n</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) p[i] = i;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå¹¶aå’Œbæ‰€åœ¨çš„ä¸¤ä¸ªé›†åˆï¼š</span></span><br><span class="line">p[<span class="built_in">find</span>(a)] = <span class="built_in">find</span>(b);</span><br></pre></td></tr></table></figure>

<p>â€‹	</p>
<h2 id="gcd"><a href="#gcd" class="headerlink" title="gcd"></a>gcd</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b, a % b) : a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‰©å±•gcd"><a href="#æ‰©å±•gcd" class="headerlink" title="æ‰©å±•gcd"></a>æ‰©å±•gcd</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)&#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll d = <span class="built_in">exgcd</span>(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¿«é€Ÿå¹‚"><a href="#å¿«é€Ÿå¹‚" class="headerlink" title="å¿«é€Ÿå¹‚"></a>å¿«é€Ÿå¹‚</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">qmi</span><span class="params">(ll a,ll k,ll p)</span></span>&#123;</span><br><span class="line">    ll res=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)res=(res*a)%p;</span><br><span class="line">        k=k&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        a=(a*a)%p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¿«é€Ÿå¹‚æ±‚é€†å…ƒ"><a href="#å¿«é€Ÿå¹‚æ±‚é€†å…ƒ" class="headerlink" title="å¿«é€Ÿå¹‚æ±‚é€†å…ƒ"></a>å¿«é€Ÿå¹‚æ±‚é€†å…ƒ</h2><p><strong>æ ¹æ®è´¹é©¬å°å®šç†$b^{p-1}\equiv1\mod{p}\to b*b^{p-2}\equiv 1 \mod{p}$å¯å¾—$b$çš„é€†å…ƒä¸º$b^{p-2}$</strong></p>
<p>$(pæ˜¯è´¨æ•°)$</p>
<h2 id="çŸ©é˜µå¿«é€Ÿå¹‚"><a href="#çŸ©é˜µå¿«é€Ÿå¹‚" class="headerlink" title="çŸ©é˜µå¿«é€Ÿå¹‚"></a>çŸ©é˜µå¿«é€Ÿå¹‚</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Mat</span></span><br><span class="line">&#123;</span><br><span class="line">    ll m[<span class="number">101</span>][<span class="number">101</span>];</span><br><span class="line">&#125;;<span class="comment">//å­˜å‚¨ç»“æ„ä½“</span></span><br><span class="line">Mat a,e; <span class="comment">//aæ˜¯è¾“å…¥çš„çŸ©é˜µï¼Œeæ˜¯è¾“å‡ºçš„çŸ©é˜µ</span></span><br><span class="line"><span class="function">Mat <span class="title">Mul</span><span class="params">(Mat x,Mat y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">            c.m[i][j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;++k)&#123;</span><br><span class="line">                c.m[i][j] = c.m[i][j]%mod + x.m[i][k]*y.m[k][j]%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Mat <span class="title">pow</span><span class="params">(Mat x,ll y)</span><span class="comment">//çŸ©é˜µå¿«é€Ÿå¹‚</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Mat ans = e;</span><br><span class="line">    <span class="keyword">while</span>(y)&#123;</span><br><span class="line">        <span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans = <span class="built_in">Mul</span>(ans,x);</span><br><span class="line">        x = <span class="built_in">Mul</span>(x,x);</span><br><span class="line">        y&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ll a;</span><br><span class="line">ll res = a;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= a / i; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a % i == <span class="number">0</span>) &#123;</span><br><span class="line">                res = res * (i - <span class="number">1</span>) / i;<span class="comment">//ç­‰ä»·äº(1-1/i)</span></span><br><span class="line">                <span class="keyword">while</span> (a % i == <span class="number">0</span>)a /= i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (a &gt; <span class="number">1</span>)res = res * (a - <span class="number">1</span>) / a;</span><br><span class="line">        cout&lt;&lt;res&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h2 id="æ¬§æ‹‰ç­›"><a href="#æ¬§æ‹‰ç­›" class="headerlink" title="æ¬§æ‹‰ç­›"></a>æ¬§æ‹‰ç­›</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1000005</span>;</span><br><span class="line"><span class="type">int</span> euler[N];<span class="comment">//å­˜æ¬§æ‹‰å‡½æ•°å€¼</span></span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> primes[N];</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function">ll <span class="title">get_euler</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    euler[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!st[i])&#123;</span><br><span class="line">            primes[cnt++]=i;</span><br><span class="line">            euler[i]=i<span class="number">-1</span>;<span class="comment">//è´¨æ•°nçš„å‰n-1ä¸ªæ•°å­—éƒ½ä¸ä»–äº’è´¨</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;=n/i ; ++j) &#123;</span><br><span class="line">            st[primes[j]*i]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>)&#123;</span><br><span class="line">                euler[i*primes[j]]=euler[i]*primes[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            euler[i*primes[j]]=euler[i]*(primes[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) res+=euler[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¿«è¯»"><a href="#å¿«è¯»" class="headerlink" title="å¿«è¯»"></a>å¿«è¯»</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‰©å±•ä¸­å›½å‰©ä½™å®šç†-æ¨¡æ•°ä¸äº’è´¨"><a href="#æ‰©å±•ä¸­å›½å‰©ä½™å®šç†-æ¨¡æ•°ä¸äº’è´¨" class="headerlink" title="æ‰©å±•ä¸­å›½å‰©ä½™å®šç†(æ¨¡æ•°ä¸äº’è´¨)"></a>æ‰©å±•ä¸­å›½å‰©ä½™å®šç†(æ¨¡æ•°ä¸äº’è´¨)</h2><h5 id="tips"><a href="#tips" class="headerlink" title="tips:"></a>tips:</h5><p><strong>1.æ£€æŸ¥é¢˜ç›®çš„aæ˜¯å¦æ˜¯æ­£æ•´æ•°ï¼Œè‹¥ä¸æ˜¯åˆ™éœ€è¦é¢„å¤„ç†aï¼ˆæ¨¡æ•°mä¸€å®šæ˜¯æ­£æ•´æ•°ï¼‰</strong>	</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) a[i]=<span class="built_in">mod</span>(a[i],m[i]); <span class="comment">//è¾“å…¥å¯èƒ½ä¸ºè´Ÿæ•°</span></span><br></pre></td></tr></table></figure>

<p><strong>2.æ£€æŸ¥$\prod_{i&#x3D;0}^{n-1}{b[i]}$æ˜¯å¦ä¼šçˆ†long long</strong></p>
<ul>
<li>int  $[ -2147483648,2147483647]$</li>
<li>unsigned  int $[ 0,4294967295]$</li>
<li>long $[-2147483648,2147483647]$</li>
<li>unsigned long $ [0,4294967295]$</li>
<li>long long $[-9223372036854775808,9223372036854775807]$</li>
<li>unsigned long long $[0,18446744073709551615]$</li>
<li>__int64 $[-9223372036854775808,9223372036854775807]$</li>
<li>unsigned __int64 $[0,18446744073709551615]$</li>
<li>floatï¼ˆ32ä½ï¼‰ç²¾ç¡®åˆ°å°æ•°ç‚¹å6~7ä½<ul>
<li>doubleï¼ˆ64ä½ï¼‰ç²¾ç¡®åˆ°å°æ•°ç‚¹å15~16ä½</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ll d = <span class="built_in">exgcd</span>(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="keyword">inline</span> <span class="title">mod</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((a % b) + b) % b;<span class="comment">//è¿”å›æ­£ä½™æ•°çš„å°æŠ€å·§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll a[N];</span><br><span class="line">ll m[N];<span class="comment">//æ¨¡æ•°</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">exCNRemainder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        ll k1, k2;</span><br><span class="line">        ll d = <span class="built_in">exgcd</span>(m[i], -m[i + <span class="number">1</span>], k1, k2);</span><br><span class="line">        <span class="keyword">if</span> ((a[i + <span class="number">1</span>] - a[i]) % d)<span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//æ— è§£</span></span><br><span class="line">        k1 = <span class="built_in">mod</span>(k1 * (a[i + <span class="number">1</span>] - a[i]) / d, <span class="built_in">abs</span>(m[i + <span class="number">1</span>] / d));</span><br><span class="line">        a[i+<span class="number">1</span>] = k1 * m[i] + a[i];</span><br><span class="line">        m[i+<span class="number">1</span>] = <span class="built_in">abs</span>(m[i] / d * m[i + <span class="number">1</span>]);<span class="comment">//m1,m2çš„æœ€å¤§å…¬çº¦æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;n ; ++i) &#123;</span><br><span class="line">        cin&gt;&gt;m[i]&gt;&gt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">exCNRemainder</span>())cout&lt;&lt;a[n<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cout&lt;&lt;<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//https://www.acwing.com/solution/content/3539/</span></span><br></pre></td></tr></table></figure>



<h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>, M = <span class="number">100010</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> nxt[M];</span><br><span class="line"><span class="type">char</span> s[N];<span class="comment">//ä¸»ä¸²</span></span><br><span class="line"><span class="type">char</span> p[M];<span class="comment">//å­ä¸²</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">kmp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//æ±‚nxtæ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>, j = <span class="number">0</span>; i &lt;= m; i ++ )<span class="comment">//æ‰¾ä»¥iç»“å°¾çš„Pçš„ç›¸ç­‰çš„å‰ç¼€ä¸åç¼€æœ€é•¿é•¿åº¦</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; p[i] != p[j + <span class="number">1</span>]) j = nxt[j];</span><br><span class="line">        <span class="keyword">if</span> (p[i] == p[j + <span class="number">1</span>]) j ++ ;</span><br><span class="line">        nxt[i] = j;</span><br><span class="line">    &#125;	</span><br><span class="line">    <span class="comment">//kmpåŒ¹é…</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = <span class="number">0</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; s[i] != p[j + <span class="number">1</span>]) j = nxt[j];<span class="comment">//pè¿˜æ²¡é€€åˆ°èµ·ç‚¹å¹¶ä¸”ä¸èƒ½åŒ¹é…</span></span><br><span class="line">        <span class="keyword">if</span> (s[i] == p[j + <span class="number">1</span>]) j ++ ;</span><br><span class="line">        <span class="keyword">if</span> (j == m)<span class="comment">//åŒ¹é…æˆåŠŸ</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, i - m);<span class="comment">//è¾“å‡ºæ¯æ¬¡åŒ¹é…æˆåŠŸçš„èµ·å§‹ä½ç½®çš„ä¸‹æ ‡</span></span><br><span class="line">            j = nxt[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; m &gt;&gt; p + <span class="number">1</span> &gt;&gt; n &gt;&gt; s + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">kmp</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€å°å¾ªç¯èŠ‚çš„é•¿åº¦</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int cir = n - nxt[n];</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ<code>n</code>å¯ä»¥è¢«<code>n - nxt[n]</code>æ•´é™¤ï¼Œåˆ™è¡¨æ˜å­—ç¬¦ä¸²Så¯ä»¥å®Œå…¨ç”±å¾ªç¯èŠ‚å¾ªç¯ç»„æˆï¼Œå¾ªç¯å‘¨æœŸ<code>T=n/cir</code>ã€‚</p>
<p>å¦‚æœä¸èƒ½ï¼Œè¯´æ˜è¿˜éœ€è¦å†æ·»åŠ å‡ ä¸ªå­—æ¯æ‰èƒ½è¡¥å…¨ã€‚éœ€è¦è¡¥çš„ä¸ªæ•°æ˜¯å¾ªç¯ä¸ªæ•°<code>cir-n%cir=cir-(n-cir)%cir=cir-nxt[n]%cir</code></p>
<h2 id="EXKMP"><a href="#EXKMP" class="headerlink" title="EXKMP"></a>EXKMP</h2><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201172258059.webp" alt="1664523306-5b8b351da943a_fix732"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">https://segmentfault.com/a/1190000008663857</span></span><br><span class="line"><span class="comment">å®šä¹‰sï¼Œpï¼Œè®¾sçš„é•¿åº¦ä¸ºnï¼Œpçš„é•¿åº¦ä¸ºmï¼Œæ±‚pä¸sçš„æ¯ä¸€ä¸ªåç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè®¾extendæ•°ç»„,extend[i]è¡¨ç¤ºpä¸s[i,n-1]çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œè¦æ±‚å‡ºæ‰€æœ‰extend[i](0&lt;=i&lt;n)ã€‚</span></span><br><span class="line"><span class="comment">æ³¨æ„åˆ°ï¼Œå¦‚æœæœ‰ä¸€ä¸ªä½ç½®extend[i]=m,åˆ™è¡¨ç¤ºTåœ¨Sä¸­å‡ºç°ï¼Œè€Œä¸”æ˜¯åœ¨ä½ç½®iå‡ºç°ï¼Œè¿™å°±æ˜¯æ ‡å‡†çš„KMPé—®é¢˜ï¼Œæ‰€ä»¥è¯´æ‹“å±•kmpæ˜¯å¯¹KMPç®—æ³•çš„æ‰©å±•ï¼Œæ‰€ä»¥ä¸€èˆ¬å°†å®ƒç§°ä¸ºæ‰©å±•KMPç®—æ³•ã€‚</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment">æ³¨æ„ï¼ï¼ï¼ï¼šæ­¤æ¨¡ç‰ˆçš„nxt[i]æ˜¯i-m-1çš„æœ€é•¿ç›¸åŒå‰ç¼€ï¼Œä¹‹å‰çš„kmpæ¨¡ç‰ˆçš„nxt[i]æ˜¯1-i</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»0å¼€å§‹</span></span><br><span class="line"><span class="comment">/* æ±‚è§£ T ä¸­ next[]ï¼Œæ³¨é‡Šå‚è€ƒ GetExtend() */</span></span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">char</span> p[N];</span><br><span class="line"><span class="type">int</span> nxt[N];<span class="comment">//p[i]...p[m - 1]ä¸Tçš„æœ€é•¿ç›¸åŒå‰ç¼€é•¿åº¦</span></span><br><span class="line"><span class="type">int</span> extend[N];</span><br><span class="line"><span class="type">int</span> n;<span class="comment">//sçš„é•¿</span></span><br><span class="line"><span class="type">int</span> m;<span class="comment">//pçš„é•¿</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetNext</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">    nxt[<span class="number">0</span>] = m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= pos || i + nxt[i - a] &gt;= pos)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= pos)</span><br><span class="line">                pos = i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; m &amp;&amp; p[pos] == p[pos - i])</span><br><span class="line">                pos++;</span><br><span class="line"></span><br><span class="line">            nxt[i] = pos - i;</span><br><span class="line">            a = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            nxt[i] = nxt[i - a];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ±‚è§£ extend[] */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetExtend</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, pos = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">GetNext</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= pos || i + nxt[i - a] &gt;= pos) <span class="comment">// i &gt;= p çš„ä½œç”¨ï¼šä¸¾ä¸ªå…¸å‹ä¾‹å­ï¼Œs å’Œ p æ— ä¸€å­—ç¬¦ç›¸åŒ</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= pos)</span><br><span class="line">                pos = i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (pos &lt; n &amp;&amp; pos - i &lt; m &amp;&amp; s[pos] == p[pos - i])</span><br><span class="line">                pos++;</span><br><span class="line"></span><br><span class="line">            extend[i] = pos - i;</span><br><span class="line">            a = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            extend[i] = nxt[i - a];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="æœ€å°è¡¨ç¤ºæ³•"><a href="#æœ€å°è¡¨ç¤ºæ³•" class="headerlink" title="æœ€å°è¡¨ç¤ºæ³•"></a>æœ€å°è¡¨ç¤ºæ³•</h2><ul>
<li>æ‰¾ä¸€ä¸ªå¾ªç¯å­—ç¬¦ä¸²çš„å­—å…¸åºæœ€å°çš„è¡¨ç¤ºæ–¹æ³•</li>
</ul>
<p>å¯¹äºä¸¤ä¸ªå¾ªç¯çš„å­—ç¬¦ä¸²å¦‚æœèƒ½è¡¨ç¤ºåŒä¸€ä¸ªå­—ç¬¦ä¸²è¾“å‡º<code>Yes</code>å¦åˆ™è¾“å‡º<code>No</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_min</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt; n &amp;&amp; j &lt; n) &#123;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (k &lt; n &amp;&amp; s[i + k] == s[j + k])k++;</span><br><span class="line">        <span class="keyword">if</span> (k &gt;= n)<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (s[i + k] &gt; s[j + k])i += k + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            j += k + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i == j)j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> idx = <span class="built_in">min</span>(i, j);<span class="comment">//iå’Œjåˆä¸€ä¸ªè¶Šç•Œäº†æ‰ä¼šé€€å‡ºä¸Šé¢çš„å¾ªç¯ æ‰€ä»¥è¿™é‡Œå–æ²¡æœ‰è¶Šç•Œçš„é‚£ä¸ªè‚¯å®šæ˜¯æœ€å°çš„;</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; idx&lt;&lt; &#x27;\n&#x27;;//è¿”å›æœ€å°è¡¨ç¤ºçš„èµ·å§‹ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> idx ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    n = a.<span class="built_in">length</span>();</span><br><span class="line">    a += a, b += b;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> sta = <span class="built_in">get_min</span>(a), stb = <span class="built_in">get_min</span>(b);</span><br><span class="line">    <span class="comment">//cout&lt;&lt;a.substr(sta,n/2)&lt;&lt;&#x27; &#x27;&lt;&lt;b.substr(stb,n/2)&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    <span class="keyword">if</span> (a.<span class="built_in">substr</span>(sta, n) == b.<span class="built_in">substr</span>(stb, n)) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        cout &lt;&lt; a.<span class="built_in">substr</span>(sta,n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Manacher"><a href="#Manacher" class="headerlink" title="Manacher"></a>Manacher</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> a[N];<span class="comment">//åŸä¸²</span></span><br><span class="line"><span class="type">char</span> s[N * <span class="number">2</span>];<span class="comment">//å¤„ç†è¿‡çš„ä¸²</span></span><br><span class="line"><span class="type">int</span> p[N * <span class="number">2</span>];<span class="comment">//p[i]æ˜¯ä»¥iä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡ä¸²åŠå¾„</span></span><br><span class="line"><span class="comment">//å› ä¸ºp[i]æ˜¯ç›¸è¾ƒäºå¤„ç†è¿‡çš„ä¸²è€Œè¨€çš„ï¼Œæ‰€ä»¥p[i]-1å³ä¸ºä»¥iä¸ºä¸­å¿ƒçš„æœ€é•¿å›æ–‡ä¸²çš„é•¿åº¦</span></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    s[idx++] = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    s[idx++] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        s[idx++] = a[i], s[idx++] = <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s[idx++] = <span class="string">&#x27;^&#x27;</span>;</span><br><span class="line">    n = idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">manacher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> mr = <span class="number">0</span>;<span class="comment">//æœ€é•¿å›æ–‡çš„æœ€å³è¾¹ç•Œ</span></span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; mr)p[i] = <span class="built_in">min</span>(p[i - (i - mid) * <span class="number">2</span>], mr - i);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            p[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (s[i - p[i]] == s[i + p[i]]) &#123;</span><br><span class="line">            p[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i + p[i] &gt; mr) &#123;</span><br><span class="line">            mr = i + p[i];</span><br><span class="line">            mid = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å­—å…¸æ ‘"><a href="#å­—å…¸æ ‘" class="headerlink" title="å­—å…¸æ ‘"></a>å­—å…¸æ ‘</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">const int N = 100010;</span><br><span class="line">int son[N][26];//ä¸‹æ ‡æ˜¯0çš„ç‚¹æ—¢æ˜¯æ ¹èŠ‚ç‚¹åˆæ˜¯ç©ºèŠ‚ç‚¹</span><br><span class="line">int cnt[N];//ä»¥å½“å‰è¿™ä¸ªç‚¹ç»“å°¾çš„å•è¯æœ‰å¤šå°‘ä¸ª</span><br><span class="line">int idx;//å½“å‰ç”¨åˆ°äº†å“ªä¸ªä¸‹æ ‡</span><br><span class="line">char str[N];</span><br><span class="line"></span><br><span class="line">void insert()</span><br><span class="line">&#123;</span><br><span class="line">    int p = 0;</span><br><span class="line">    for (int i = 0; str[i]; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        int u = str[i] - &#x27;a&#x27;;//å­—æ¯æ˜ å°„æˆæ•°å­—</span><br><span class="line">        if (!son[p][u]) son[p][u] = ++ idx;//å¦‚æœä¸å­˜åœ¨å°±æŠŠå®ƒåˆ›å»ºå‡ºæ¥</span><br><span class="line">        p = son[p][u];</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[p] ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int query()</span><br><span class="line">&#123;</span><br><span class="line">    int p = 0;</span><br><span class="line">    for (int i = 0; str[i]; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        int u = str[i] - &#x27;a&#x27;;</span><br><span class="line">        if (!son[p][u]) return 0;</span><br><span class="line">        p = son[p][u];</span><br><span class="line">    &#125;</span><br><span class="line">    return cnt[p];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PIII pair<span class="string">&lt;int,PII&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLLL pair<span class="string">&lt;ll,PLL&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10010</span>, S = <span class="number">55</span>, M = <span class="number">1000010</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> s[M];</span><br><span class="line"><span class="type">int</span> tr[N * S][<span class="number">26</span>], cnt[N * S], idx;</span><br><span class="line"><span class="type">int</span> ne[N * S];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">()</span> </span>&#123;<span class="comment">//trieæ ‘æ’å…¥æ¨¡ç‰ˆ</span></span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; s[i]; i++) &#123;</span><br><span class="line">        <span class="type">int</span> t = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (!tr[p][t])tr[p][t] = ++idx;</span><br><span class="line">        p = tr[p][t];</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[p]++;<span class="comment">//pä½ç½®ä¸Šçš„å­—ç¬¦ä¸²å¤šäº†ä¸€ä¸ª</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;<span class="comment">//æ„å»ºacè‡ªåŠ¨æœºï¼ˆbfsï¼‰</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//å› ä¸ºç¬¬ä¸€å±‚ä¹Ÿæ˜¯å…¨éƒ¨è¿åˆ°æ ¹èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥æŠŠç¬¬ä¸€å±‚å…ˆå…¨éƒ¨å…¥é˜Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> (tr[<span class="number">0</span>][i])q.<span class="built_in">push</span>(tr[<span class="number">0</span>][i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®½æœ</span></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> t = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="comment">//éå†tçš„æ‰€æœ‰å„¿å­</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> p = tr[t][i];</span><br><span class="line">            <span class="comment">// if(p)</span></span><br><span class="line">            <span class="comment">// &#123;</span></span><br><span class="line">            <span class="comment">//     int j = ne[t];</span></span><br><span class="line">            <span class="comment">//     while(j &amp;&amp; !tr[j][i]) j = ne[j];</span></span><br><span class="line">            <span class="comment">//     if(tr[j][i]) j = tr[j][i];</span></span><br><span class="line">            <span class="comment">//     ne[p] = j;</span></span><br><span class="line">            <span class="comment">//     q[++tt] = p;</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä¼˜åŒ–æ€è·¯ åœ¨æ²¡æœ‰åŒ¹é…æ—¶ æŠŠwhileå¾ªç¯å¤šæ¬¡è·³ ä¼˜åŒ–ä¸º ç›´æ¥è·³åˆ°neæŒ‡é’ˆæœ€ç»ˆè·³åˆ°çš„ä½ç½®</span></span><br><span class="line">            <span class="comment">// å¦‚æœä¸å­˜åœ¨å„¿å­tr[t][i]çš„è¯å°±è®©å½“å‰èŠ‚ç‚¹çš„è¿™ä¸ªå­èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹æŒ‡é’ˆçš„å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (!p) tr[t][i] = tr[ne[t]][i];</span><br><span class="line">                <span class="comment">// å¦‚æœå­˜åœ¨å„¿å­èŠ‚ç‚¹ è®©è¿™ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆæŒ‡å‘(((ä»–çˆ¶äº²èŠ‚ç‚¹)çš„å¤±è´¥æŒ‡é’ˆæ‰€æŒ‡å‘çš„é‚£ä¸ªèŠ‚ç‚¹)çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹)</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ne[p] = tr[ne[t]][i];</span><br><span class="line">                q.<span class="built_in">push</span>(p);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(tr, <span class="number">0</span>, <span class="keyword">sizeof</span> tr);</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span> cnt);</span><br><span class="line">    <span class="built_in">memset</span>(ne, <span class="number">0</span>, <span class="keyword">sizeof</span> ne);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">insert</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">build</span>();</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; s[i]; i++) &#123;</span><br><span class="line">        <span class="type">int</span> t = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        while(j &amp;&amp; !tr[j][t]) j = ne[j];</span></span><br><span class="line"><span class="comment">        if(tr[j][t]) j=tr[j][t];</span></span><br><span class="line"><span class="comment">        int p = j;</span></span><br><span class="line"><span class="comment">         // she å’Œ he çš„ eç»“ç‚¹éƒ½æœ‰cnt[e]=1</span></span><br><span class="line"><span class="comment">            éå†åˆ°sheçš„åç¼€heçš„æ—¶å€™ herçš„ç›¸åŒå‰ç¼€heè‚¯å®šæ˜¯é€å±‚éå†åˆ°äº†çš„ len(he)&lt;len(she) é€å±‚éå†</span></span><br><span class="line"><span class="comment">            æŠŠæ‰€æœ‰ne æŒ‡é’ˆå…¨éƒ¨åŠ ä¸€é  æ¯”å¦‚å½“å‰påˆ°äº†sheçš„e  æŠŠcnt[p]+è¿›reså</span></span><br><span class="line"><span class="comment">            æŠŠpé€šè¿‡ne[p]è·³åˆ°heçš„e å†åŠ ä¸Šæ­¤æ—¶æŒ‡å‘heä¸­eçš„pçš„cnt[p]</span></span><br><span class="line"><span class="comment">        while(p)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            res += cnt[p];</span></span><br><span class="line"><span class="comment">            cnt[p] = 0;</span></span><br><span class="line"><span class="comment">            p = ne[p];</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        j = tr[j][t];</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> p = j;</span><br><span class="line">        <span class="keyword">while</span> (p) &#123;</span><br><span class="line">            res += cnt[p];</span><br><span class="line">            cnt[p] = <span class="number">0</span>;<span class="comment">//she he æŠŠcnt[e]çš„ç”¨è¿‡äº†ä¹‹å res=2 æ­¤æ—¶å†è¿›æ¥ä¸€ä¸ªher å°±ä¸èƒ½å†+heçš„cntäº†,æ‰€ä»¥cnt[e]ç”¨è¿‡ä¹‹åè¦ç½®0</span></span><br><span class="line">            p = ne[p];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;res&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="åç¼€æ•°ç»„"><a href="#åç¼€æ•°ç»„" class="headerlink" title="åç¼€æ•°ç»„"></a>åç¼€æ•°ç»„</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> sa[N], x[N], y[N], c[N], rk[N], height[N];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">åç¼€æ•°ç»„sa[i]å°±è¡¨ç¤ºæ’åä¸ºiçš„åç¼€çš„èµ·å§‹ä½ç½®çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">è€Œå®ƒçš„æ˜ å°„æ•°ç»„rak[i]å°±è¡¨ç¤ºèµ·å§‹ä½ç½®çš„ä¸‹æ ‡ä¸ºiçš„åç¼€çš„æ’å</span></span><br><span class="line"><span class="comment">Height[i]è¡¨ç¤ºLCP(i,i-1)</span></span><br><span class="line"><span class="comment">LCP(i,j)è¡¨ç¤ºsuff(sa[i])ä¸suff(sa[j])çš„æœ€é•¿å…¬å…±å‰ç¼€</span></span><br><span class="line"><span class="comment">LCP(i,j)=LCP(j,i);</span></span><br><span class="line"><span class="comment">LCP(i,i)=len(sa[i])=n-sa[i]+1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">ababca</span></span><br><span class="line"><span class="comment">åç¼€æŒ‰ç…§å­—å…¸åºæ’åºå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment">ababca</span></span><br><span class="line"><span class="comment">abca</span></span><br><span class="line"><span class="comment">babca</span></span><br><span class="line"><span class="comment">bca</span></span><br><span class="line"><span class="comment">ca</span></span><br><span class="line"><span class="comment">Heightæ•°ç»„</span></span><br><span class="line"><span class="comment">0 1 2 0 1 0</span></span><br><span class="line"><span class="comment">Saæ•°ç»„</span></span><br><span class="line"><span class="comment">6 1 3 2 4 5</span></span><br><span class="line"><span class="comment">Rakæ•°ç»„</span></span><br><span class="line"><span class="comment">2 4 3 5 6 1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_sa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) c[x[i] = s[i]] ++ ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; i ++ ) c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i -- ) sa[c[x[i]] -- ] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n - k + <span class="number">1</span>; i &lt;= n; i ++ ) y[ ++ num] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (sa[i] &gt; k)</span><br><span class="line">                y[ ++ num] = sa[i] - k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++ ) c[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) c[x[i]] ++ ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= m; i ++ ) c[i] += c[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i; i -- ) sa[c[x[y[i]]] -- ] = y[i], y[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">swap</span>(x, y);</span><br><span class="line">        x[sa[<span class="number">1</span>]] = <span class="number">1</span>, num = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">            x[sa[i]] = (y[sa[i]] == y[sa[i - <span class="number">1</span>]] &amp;&amp; y[sa[i] + k] == y[sa[i - <span class="number">1</span>] + k]) ? num : ++ num;</span><br><span class="line">        <span class="keyword">if</span> (num == n) <span class="keyword">break</span>;</span><br><span class="line">        m = num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_height</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) rk[sa[i]] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (rk[i] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (k) k -- ;</span><br><span class="line">        <span class="type">int</span> j = sa[rk[i] - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">while</span> (i + k &lt;= n &amp;&amp; j + k &lt;= n &amp;&amp; s[i + k] == s[j + k]) k ++ ;</span><br><span class="line">        height[rk[i]] = k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), m = <span class="string">&#x27;z&#x27;</span>;</span><br><span class="line">    <span class="built_in">get_sa</span>();</span><br><span class="line">    <span class="built_in">get_height</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, sa[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ ) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, height[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li><p>æ±‚æ’åiå’Œæ’åjçš„å­—ç¬¦ä¸²çš„lcs</p>
<p>$lcs(i,j)&#x3D;min(height[i],height[i+1],â€¦,height[j])$</p>
</li>
</ul>
<h2 id="åç¼€è‡ªåŠ¨æœº"><a href="#åç¼€è‡ªåŠ¨æœº" class="headerlink" title="åç¼€è‡ªåŠ¨æœº"></a>åç¼€è‡ªåŠ¨æœº</h2><ul>
<li>Nodeçš„å¤§å°è¦å¼€å­—ç¬¦ä¸²é•¿åº¦çš„ä¸¤å€</li>
<li>å­˜failæ ‘çš„å¤§å°è¦å¼€å­—ç¬¦ä¸²é•¿åº¦çš„ä¸‰å€</li>
<li>å¤šç»„åˆå§‹åŒ–</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">idx=ans=<span class="number">0</span>;</span><br><span class="line">        tot=<span class="number">1</span>,last=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">        <span class="built_in">memset</span>(node,<span class="number">0</span>,<span class="keyword">sizeof</span> node);</span><br><span class="line">        <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span> f);<span class="comment">//ï¼</span></span><br></pre></td></tr></table></figure>



<ul>
<li><p>æ±‚æ¯ä¸ªå­ä¸²å‡ºç°çš„æ¬¡æ•°</p>
</li>
<li><p>å¯¹äºæ‰€æœ‰ S çš„<strong>å‡ºç°æ¬¡æ•°ä¸ä¸º 1</strong> çš„å­ä¸²ï¼Œè®¾å…¶ valueå€¼ä¸ºè¯¥å­ä¸²å‡ºç°çš„æ¬¡æ•°*è¯¥å­ä¸²çš„é•¿åº¦ã€‚è¯·è®¡ç®—,value çš„æœ€å¤§å€¼æ˜¯å¤šå°‘ã€‚</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2000010</span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len, fa;</span><br><span class="line">    <span class="type">int</span> ch[<span class="number">26</span>];</span><br><span class="line">&#125;node[N];</span><br><span class="line"><span class="type">char</span> str[N];</span><br><span class="line">LL f[N], ans;</span><br><span class="line"><span class="type">int</span> h[N], e[N], ne[N], idx;</span><br><span class="line"><span class="comment">//å¯¹äºèŠ‚ç‚¹uçš„å­ä¸²é›†åˆ æœ€é•¿çš„æ˜¯node[u].len ,æœ€çŸ­çš„æ˜¯node[node[u].fa].len+1</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//faï¼šfailæ•°ç»„ chï¼štrieæ ‘ len:è¿™ä¸ªèŠ‚ç‚¹é›†åˆä¸­å­—ç¬¦ä¸²æœ€é•¿é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> p = last, np = last = ++ tot;<span class="comment">//npï¼šåˆæ­¥å»ºç«‹çš„åç¼€è‡ªåŠ¨æœº</span></span><br><span class="line">    f[tot] = <span class="number">1</span>;<span class="comment">//è®°å½•æ¯ä¸ªå­ä¸²å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">    node[np].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p &amp;&amp; !node[p].ch[c]; p = node[p].fa) node[p].ch[c] = np;</span><br><span class="line">    <span class="keyword">if</span> (!p) node[np].fa = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> q = node[p].ch[c];</span><br><span class="line">        <span class="keyword">if</span> (node[q].len == node[p].len + <span class="number">1</span>) node[np].fa = q;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nq = ++ tot;<span class="comment">//nqï¼šå½“æŸèŠ‚ç‚¹æ²¡æœ‰åˆé€‚çš„ç‚¹åšFailçš„çˆ¶äº²æ—¶ï¼Œéœ€è¦çš„æ·»åŠ å…¬å…±èŠ‚ç‚¹</span></span><br><span class="line">            node[nq] = node[q], node[nq].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">            node[q].fa = node[np].fa = nq;</span><br><span class="line">            <span class="keyword">for</span> (; p &amp;&amp; node[p].ch[c] == q; p = node[p].fa) node[p].ch[c] = nq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = h[u]; ~i; i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(e[i]);</span><br><span class="line">        f[u] += f[e[i]];<span class="comment">//æ ¹æ®failæ ‘çš„æ€§è´¨å¯ä»¥ç›´æ¥é€’å½’æ±‚å‡ºç°æ¬¡æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f[u] &gt; <span class="number">1</span>) ans = <span class="built_in">max</span>(ans, f[u] * node[u].len);<span class="comment">//å‡ºç°æ¬¡æ•°å¤§äº1çš„è®°å½•ä¸€ä¸‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; str[i]; i++) <span class="built_in">extend</span>(str[i] - <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="keyword">sizeof</span> h);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= tot; i++) <span class="built_in">add</span>(node[i].fa, i);<span class="comment">//æ„å»ºfailæ ‘</span></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li><p>ç»™ä¸€ä¸ªæ–‡æœ¬ä¸²så’Œå¤šä¸ªæ¨¡å¼ä¸²t ï¼Œæˆ‘ä»¬è¦æ£€æŸ¥å­—ç¬¦ä¸²tæ˜¯å¦ä½œä¸ºsçš„ä¸€ä¸ªå­ä¸²å‡ºç°ã€‚ä¹Ÿå¯ä»¥æ±‚æ¨¡å¼ä¸²tåœ¨æ–‡æœ¬ä¸²ä¸­å‡ºç°çš„æœ€å¤§å‰ç¼€é•¿åº¦</p>
</li>
<li><p>ç»™ä¸€ä¸ªä¸»ä¸²så’Œmä¸ªå­ä¸²t,æ±‚æ¯ä¸€ä¸ªtåœ¨sä¸­å‡ºç°çš„æœ€å¤§å‰ç¼€é•¿åº¦ så’Œtéƒ½æ˜¯ç”±ESWNè¿™å‡ ä¸ªå­—ç¬¦æ„æˆ.</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e7</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len, fa;</span><br><span class="line">    <span class="type">int</span> ch[<span class="number">4</span>];</span><br><span class="line">&#125;node[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">change</span><span class="params">(<span class="type">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c==<span class="string">&#x27;E&#x27;</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(c==<span class="string">&#x27;S&#x27;</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(c==<span class="string">&#x27;W&#x27;</span>)<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(c==<span class="string">&#x27;N&#x27;</span>)<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line">string s;</span><br><span class="line">string t;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//faï¼šfailæ•°ç»„ chï¼štrieæ ‘ len:è¿™ä¸ªèŠ‚ç‚¹é›†åˆä¸­å­—ç¬¦ä¸²æœ€é•¿é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> p = last, np = last = ++ tot;<span class="comment">//npï¼šåˆæ­¥å»ºç«‹çš„åç¼€è‡ªåŠ¨æœº</span></span><br><span class="line">    node[np].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p &amp;&amp; !node[p].ch[c]; p = node[p].fa) node[p].ch[c] = np;</span><br><span class="line">    <span class="keyword">if</span> (!p) node[np].fa = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> q = node[p].ch[c];</span><br><span class="line">        <span class="keyword">if</span> (node[q].len == node[p].len + <span class="number">1</span>) node[np].fa = q;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nq = ++ tot;<span class="comment">//nqï¼šå½“æŸèŠ‚ç‚¹æ²¡æœ‰åˆé€‚çš„ç‚¹åšFailçš„çˆ¶äº²æ—¶ï¼Œéœ€è¦çš„æ·»åŠ å…¬å…±èŠ‚ç‚¹</span></span><br><span class="line">            node[nq] = node[q], node[nq].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">            node[q].fa = node[np].fa = nq;</span><br><span class="line">            <span class="keyword">for</span> (; p &amp;&amp; node[p].ch[c] == q; p = node[p].fa) node[p].ch[c] = nq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> p=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;t.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> u=<span class="built_in">change</span>(t[i]);</span><br><span class="line">        <span class="keyword">if</span>(!node[p].ch[u])<span class="keyword">return</span> cnt;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            p=node[p].ch[u];</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    cin&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)<span class="built_in">extend</span>(<span class="built_in">change</span>(s[i]));</span><br><span class="line">    <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">        cin&gt;&gt;t;</span><br><span class="line">        cout&lt;&lt;<span class="built_in">query</span>()&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>ç»™ä¸€ä¸ªæ•°å­—ä¸², æ¯åŠ å…¥ä¸€ä¸ªå­—ç¬¦,æ±‚å½“å‰æ‰€æœ‰å­ä¸²ä¸ªæ•°</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(2)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;inline&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC target(&quot;avx&quot;,&quot;sse2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fgcse-lm&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fipa-sra&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-pre&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ftree-vrp&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fpeephole2&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-ffast-math&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;-fsched-spec&quot;)</span></span><br><span class="line"><span class="comment">//#pragma GCC optimize(&quot;unroll-loops&quot;)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PLL pair<span class="string">&lt;ll,ll&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(a) cout &lt;&lt; #a &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LLINF =<span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">1</span>, last = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len, fa;</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;ch;</span><br><span class="line">&#125;node[N];</span><br><span class="line"></span><br><span class="line">ll ans=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//faï¼šfailæ•°ç»„ chï¼štrieæ ‘ len:è¿™ä¸ªèŠ‚ç‚¹é›†åˆä¸­å­—ç¬¦ä¸²æœ€é•¿é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> p = last, np = last = ++ tot;<span class="comment">//npï¼šåˆæ­¥å»ºç«‹çš„åç¼€è‡ªåŠ¨æœº</span></span><br><span class="line">    node[np].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p &amp;&amp; !node[p].ch[c]; p = node[p].fa) node[p].ch[c] = np;</span><br><span class="line">    <span class="keyword">if</span> (!p) node[np].fa = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> q = node[p].ch[c];</span><br><span class="line">        <span class="keyword">if</span> (node[q].len == node[p].len + <span class="number">1</span>) node[np].fa = q;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> nq = ++ tot;<span class="comment">//nqï¼šå½“æŸèŠ‚ç‚¹æ²¡æœ‰åˆé€‚çš„ç‚¹åšFailçš„çˆ¶äº²æ—¶ï¼Œéœ€è¦çš„æ·»åŠ å…¬å…±èŠ‚ç‚¹</span></span><br><span class="line">            node[nq] = node[q], node[nq].len = node[p].len + <span class="number">1</span>;</span><br><span class="line">            node[q].fa = node[np].fa = nq;</span><br><span class="line">            <span class="keyword">for</span> (; p &amp;&amp; node[p].ch[c] == q; p = node[p].fa) node[p].ch[c] = nq;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//debug(last)</span></span><br><span class="line">    <span class="comment">//debug(tot)</span></span><br><span class="line">    ans+=node[last].len-node[node[last].fa].len;<span class="comment">//lastæ˜¯åŠ çš„è¿™ä¸ªcçš„ä½ç½®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">          <span class="type">int</span> x;</span><br><span class="line">        cin&gt;&gt;x;</span><br><span class="line">        <span class="built_in">extend</span>(x);</span><br><span class="line">        cout&lt;&lt;ans&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ios::sync_with_stdio(false);</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> begin_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;../input.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line"><span class="comment">//    freopen(&quot;../output.txt&quot;, &quot;w&quot;, stdout);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    <span class="type">int</span> T = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//T = read();</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, cas);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> LOCAL</span></span><br><span class="line">    <span class="type">int</span> end_time = <span class="built_in">clock</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nRun time: %.2lf ms&quot;</span>, (<span class="type">double</span>) (end_time - begin_time) / CLOCKS_PER_SEC * <span class="number">1000</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> ch = <span class="built_in">getchar</span>();</span><br><span class="line">    ll p = <span class="number">1</span>, data = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;-&#x27;</span>)p = <span class="number">-1</span>;</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) &#123;</span><br><span class="line">        data = data * <span class="number">10</span> + (ch ^ <span class="number">48</span>);</span><br><span class="line">        ch = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p * data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ•‘æ€¥å¤§æ¿å­"><a href="#æ•‘æ€¥å¤§æ¿å­" class="headerlink" title="æ•‘æ€¥å¤§æ¿å­"></a>æ•‘æ€¥å¤§æ¿å­</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  pi    acos(-1.0)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  eps   1e-9</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  fi    first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  se    second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  rtl   rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  rtr   rt&lt;&lt;1|1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  bug                printf(<span class="string">&quot;******\n&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  mem(a, b)          memset(a,b,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  name2str(x)        #x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  fuck(x)            cout&lt;&lt;#x<span class="string">&quot; = &quot;</span>&lt;&lt;x&lt;&lt;endl</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfi(a)             scanf(<span class="string">&quot;%d&quot;</span>, &amp;a)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffi(a, b)         scanf(<span class="string">&quot;%d %d&quot;</span>, &amp;a, &amp;b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfffi(a, b, c)     scanf(<span class="string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffffi(a, b, c, d) scanf(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfL(a)             scanf(<span class="string">&quot;%lld&quot;</span>, &amp;a)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffL(a, b)         scanf(<span class="string">&quot;%lld %lld&quot;</span>, &amp;a, &amp;b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfffL(a, b, c)     scanf(<span class="string">&quot;%lld %lld %lld&quot;</span>, &amp;a, &amp;b, &amp;c)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffffL(a, b, c, d) scanf(<span class="string">&quot;%lld %lld %lld %lld&quot;</span>, &amp;a, &amp;b, &amp;c, &amp;d)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfs(a)             scanf(<span class="string">&quot;%s&quot;</span>, a)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffs(a, b)         scanf(<span class="string">&quot;%s %s&quot;</span>, a, b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sfffs(a, b, c)     scanf(<span class="string">&quot;%s %s %s&quot;</span>, a, b, c)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  sffffs(a, b, c, d) scanf(<span class="string">&quot;%s %s %s %s&quot;</span>, a, b,c, d)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  FIN                freopen(<span class="string">&quot;../in.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  gcd(a, b)          __gcd(a,b)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  lowbit(x)          x&amp;-x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span>  IO                 iOS::sync_with_stdio(false)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ULL;</span><br><span class="line"><span class="type">const</span> ULL seed = <span class="number">13331</span>;</span><br><span class="line"><span class="type">const</span> LL INFLL = <span class="number">0x3f3f3f3f3f3f3f3f</span>LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxm = <span class="number">8e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">2012</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e6</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Suffix_Automaton</span> &#123;</span><br><span class="line">    <span class="type">int</span> last, tot, nxt[maxn &lt;&lt; <span class="number">1</span>][<span class="number">26</span>], fail[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">//lastæ˜¯æœªåŠ å…¥æ­¤å­—ç¬¦å‰æœ€é•¿çš„å‰ç¼€ï¼ˆæ•´ä¸ªä¸²ï¼‰æ‰€å±çš„èŠ‚ç‚¹çš„ç¼–å·</span></span><br><span class="line">    <span class="type">int</span> len[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">// æœ€é•¿å­ä¸²çš„é•¿åº¦ (è¯¥èŠ‚ç‚¹å­ä¸²æ•°é‡ = len[x] - len[fa[x]])</span></span><br><span class="line">    <span class="type">int</span> sz[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">// è¢«åç¼€é“¾æ¥çš„ä¸ªæ•°ï¼Œæ–¹ä¾¿æ±‚èŠ‚ç‚¹å­—ç¬¦ä¸²çš„ä¸ªæ•°</span></span><br><span class="line">    LL num[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">// è¯¥çŠ¶æ€å­ä¸²çš„æ•°é‡</span></span><br><span class="line">    LL maxx[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">// é•¿åº¦ä¸ºxçš„å­ä¸²å‡ºç°æ¬¡æ•°æœ€å¤šçš„å­ä¸²çš„æ•°ç›®</span></span><br><span class="line">    LL sum[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">// è¯¥èŠ‚ç‚¹åé¢æ‰€å½¢æˆçš„è‡ªå­—ç¬¦ä¸²çš„æ€»æ•°</span></span><br><span class="line">    LL subnum, sublen;<span class="comment">// subnumè¡¨ç¤ºä¸åŒå­—ç¬¦ä¸²æ•°ç›®,sublenè¡¨ç¤ºä¸åŒå­—ç¬¦ä¸²æ€»é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span> X[maxn &lt;&lt; <span class="number">1</span>], Y[maxn &lt;&lt; <span class="number">1</span>]; <span class="comment">// Yè¡¨ç¤ºæ’åä¸ºxçš„èŠ‚ç‚¹ï¼ŒXè¡¨ç¤ºè¯¥é•¿åº¦å‰é¢è¿˜æœ‰å¤šå°‘ä¸ª</span></span><br><span class="line">    <span class="type">int</span> minn[maxn &lt;&lt; <span class="number">1</span>], mx[maxn &lt;&lt; <span class="number">1</span>];<span class="comment">//minn[i]è¡¨ç¤ºå¤šä¸ªä¸²åœ¨åç¼€è‡ªåŠ¨æœºièŠ‚ç‚¹æœ€é•¿å…¬å…±å­ä¸²ï¼Œmx[i]è¡¨ç¤ºå•ä¸ªä¸²çš„æœ€é•¿å…¬å…±å­ä¸²</span></span><br><span class="line">    <span class="type">int</span> L[maxn &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        tot = last = <span class="number">1</span>;</span><br><span class="line">        fail[<span class="number">1</span>] = len[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) nxt[<span class="number">1</span>][i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(<span class="type">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> u = ++tot, v = last;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">25</span>; i++) nxt[u][i] = <span class="number">0</span>;</span><br><span class="line">        fail[u] = <span class="number">0</span>;</span><br><span class="line">        L[u] = len[u] = len[v] + <span class="number">1</span>;</span><br><span class="line">        num[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; v &amp;&amp; !nxt[v][c]; v = fail[v]) nxt[v][c] = u;</span><br><span class="line">        <span class="keyword">if</span> (!v) fail[u] = <span class="number">1</span>, sz[<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (len[nxt[v][c]] == len[v] + <span class="number">1</span>) fail[u] = nxt[v][c], sz[nxt[v][c]]++;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">int</span> now = ++tot, cur = nxt[v][c];</span><br><span class="line">            len[now] = len[v] + <span class="number">1</span>;</span><br><span class="line">            L[now] = L[cur];</span><br><span class="line">            <span class="built_in">memcpy</span>(nxt[now], nxt[cur], <span class="built_in">sizeof</span>(nxt[cur]));</span><br><span class="line">            fail[now] = fail[cur];</span><br><span class="line">            fail[cur] = fail[u] = now;</span><br><span class="line">            <span class="keyword">for</span> (; v &amp;&amp; nxt[v][c] == cur; v = fail[v]) nxt[v][c] = now;</span><br><span class="line">        &#125;</span><br><span class="line">        last = u;</span><br><span class="line">        <span class="comment">//return len[last] - len[fail[last]];//å¤šæ·»åŠ ä¸€ä¸ªå­ä¸²æ‰€äº§ç”Ÿä¸åŒå­ä¸²çš„ä¸ªæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_num</span><span class="params">()</span> </span>&#123;<span class="comment">// æ¯ä¸ªèŠ‚ç‚¹å­ä¸²å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) X[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) X[len[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) X[i] += X[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) Y[X[len[i]]--] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = tot; i &gt;= <span class="number">1</span>; i--) num[fail[Y[i]]] += num[Y[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_maxx</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;<span class="comment">// é•¿åº¦ä¸ºxçš„å­ä¸²å‡ºç°æ¬¡æ•°æœ€å¤šçš„å­ä¸²çš„æ•°ç›®</span></span><br><span class="line">        <span class="built_in">get_num</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) maxx[len[i]] = <span class="built_in">max</span>(maxx[len[i]], num[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_sum</span><span class="params">()</span> </span>&#123;<span class="comment">// è¯¥èŠ‚ç‚¹åé¢æ‰€å½¢æˆçš„è‡ªå­—ç¬¦ä¸²çš„æ€»æ•°</span></span><br><span class="line">        <span class="built_in">get_num</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = tot; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">            sum[Y[i]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">25</span>; j++)</span><br><span class="line">                sum[Y[i]] += sum[nxt[Y[i]][j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_subnum</span><span class="params">()</span> </span>&#123;<span class="comment">//æœ¬è´¨ä¸åŒçš„å­ä¸²çš„ä¸ªæ•°</span></span><br><span class="line">        subnum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) subnum += len[i] - len[fail[i]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_sublen</span><span class="params">()</span> </span>&#123;<span class="comment">//æœ¬è´¨ä¸åŒçš„å­ä¸²çš„æ€»é•¿åº¦</span></span><br><span class="line">        sublen = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) sublen += <span class="number">1LL</span> * (len[i] + len[fail[i]] + <span class="number">1</span>) * (len[i] - len[fail[i]]) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_sa</span><span class="params">()</span> </span>&#123; <span class="comment">// Yè¡¨ç¤ºæ’åä¸ºxçš„èŠ‚ç‚¹ï¼ŒXè¡¨ç¤ºè¯¥é•¿åº¦å‰é¢è¿˜æœ‰å¤šå°‘ä¸ª</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= tot; i++) X[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) X[len[i]]++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) X[i] += X[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) Y[X[len[i]]--] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">match</span><span class="params">(<span class="type">char</span> s[])</span> </span>&#123;<span class="comment">//å¤šä¸ªä¸²çš„æœ€é•¿å…¬å…±å­ä¸²</span></span><br><span class="line">        <span class="built_in">mem</span>(mx, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> n = <span class="built_in">strlen</span>(s), p = <span class="number">1</span>, maxlen = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> c = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (nxt[p][c]) p = nxt[p][c], maxlen++;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (; p &amp;&amp; !nxt[p][c]; p = fail[p]);</span><br><span class="line">                <span class="keyword">if</span> (!p) p = <span class="number">1</span>, maxlen = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">else</span> maxlen = len[p] + <span class="number">1</span>, p = nxt[p][c];</span><br><span class="line">            &#125;</span><br><span class="line">            mx[p] = <span class="built_in">max</span>(mx[p], maxlen);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = tot; i; i--)</span><br><span class="line">            mx[fail[i]] = <span class="built_in">max</span>(mx[fail[i]], <span class="built_in">min</span>(len[fail[i]], mx[i]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = tot; i; i--)</span><br><span class="line">            <span class="keyword">if</span> (minn[i] == <span class="number">-1</span> || minn[i] &gt; maxx[i]) minn[i] = mx[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">get_kth</span><span class="params">(<span class="type">int</span> k)</span> </span>&#123;<span class="comment">//æ±‚å‡ºå­—å…¸åºç¬¬Kçš„å­ä¸²</span></span><br><span class="line">        <span class="type">int</span> pos = <span class="number">1</span>, cnt;</span><br><span class="line">        string s = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> (k) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">25</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nxt[pos][i] &amp;&amp; k) &#123;</span><br><span class="line">                    cnt = nxt[pos][i];</span><br><span class="line">                    <span class="keyword">if</span> (sum[cnt] &lt; k) k -= sum[cnt];</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        k--;</span><br><span class="line">                        pos = cnt;</span><br><span class="line">                        s += (<span class="type">char</span>) (i + <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; sam;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> T, cas = <span class="number">1</span>;</span><br><span class="line"><span class="type">char</span> s[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">sfi</span>(T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">sfs</span>(s);</span><br><span class="line">        <span class="type">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">        sam.<span class="built_in">init</span>();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d:\n&quot;</span>, cas++);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len;) &#123;</span><br><span class="line">            <span class="type">int</span> p, maxlen;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">1</span>, maxlen = <span class="number">0</span>; i &lt; len;) &#123;</span><br><span class="line">                <span class="type">int</span> c = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (!sam.nxt[p][c]) <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    p = sam.nxt[p][c];</span><br><span class="line">                    sam.<span class="built_in">extend</span>((s[i] - <span class="string">&#x27;a&#x27;</span>));</span><br><span class="line">                    i++, maxlen++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (maxlen) <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, maxlen, sam.L[p] - maxlen);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;-1 %d\n&quot;</span>, s[i]), sam.<span class="built_in">extend</span>((s[i] - <span class="string">&#x27;a&#x27;</span>)), i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> stk[N], tt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span> (n -- )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">        <span class="keyword">while</span> (tt &amp;&amp; stk[tt] &gt;= x) tt -- ;</span><br><span class="line">        <span class="keyword">if</span> (!tt) <span class="built_in">printf</span>(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, stk[tt]);</span><br><span class="line">        stk[ ++ tt] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å•è°ƒé˜Ÿåˆ—"><a href="#å•è°ƒé˜Ÿåˆ—" class="headerlink" title="å•è°ƒé˜Ÿåˆ—"></a>å•è°ƒé˜Ÿåˆ—</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[N], q[N];</span><br><span class="line"><span class="comment">//é˜Ÿåˆ—å­˜açš„ä¸‹æ ‡</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, k;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    <span class="comment">//æ±‚çª—å£æœ€å°å€¼</span></span><br><span class="line">    <span class="type">int</span> hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (hh &lt;= tt &amp;&amp; i - k + <span class="number">1</span> &gt; q[hh]) hh ++ ;<span class="comment">// å½“å‰é˜Ÿå¤´ä¸åœ¨çª—å£å†…éƒ¨ï¼Œå°†å…¶åˆ æ‰ï¼ˆå½“å‰çª—å£[i-k+1,i]ï¼‰</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (hh &lt;= tt &amp;&amp; a[q[tt]] &gt;= a[i]) tt -- ;<span class="comment">//è‹¥å½“å‰é˜Ÿå°¾æ¯”è¯¥æ•°è¿˜å¤§è¯´æ˜æ˜¯æ²¡ç”¨çš„ï¼Œæ‰€ä»¥æŠŠå®ƒå‡ºé˜Ÿ</span></span><br><span class="line">        q[ ++ tt] = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i &gt;= k - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[q[hh]]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">//æ±‚çª—å£æœ€å¤§å€¼</span></span><br><span class="line">    hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (hh &lt;= tt &amp;&amp; i - k + <span class="number">1</span> &gt; q[hh]) hh ++ ; </span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (hh &lt;= tt &amp;&amp; a[q[tt]] &lt;= a[i]) tt -- ;</span><br><span class="line">        q[ ++ tt] = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (i &gt;= k - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, a[q[hh]]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ±‚ç»„åˆæ•°"><a href="#æ±‚ç»„åˆæ•°" class="headerlink" title="æ±‚ç»„åˆæ•°"></a>æ±‚ç»„åˆæ•°</h2><h3 id="å¤šæ¬¡è¯¢é—®"><a href="#å¤šæ¬¡è¯¢é—®" class="headerlink" title="å¤šæ¬¡è¯¢é—®"></a>å¤šæ¬¡è¯¢é—®</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> c[N][N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j ++ )</span><br><span class="line">            <span class="keyword">if</span> (!j) c[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> c[i][j] = (c[i - <span class="number">1</span>][j] + c[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (n -- )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, c[a][b]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="è¯¢é—®ç¨å°‘-a-bç¨å¤§"><a href="#è¯¢é—®ç¨å°‘-a-bç¨å¤§" class="headerlink" title="è¯¢é—®ç¨å°‘ a,bç¨å¤§"></a>è¯¢é—®ç¨å°‘ a,bç¨å¤§</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fact[N], infact[N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % p;</span><br><span class="line">        a = (LL)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        fact[i] = (LL)fact[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">        infact[i] = (LL)infact[i - <span class="number">1</span>] * <span class="built_in">qmi</span>(i, mod - <span class="number">2</span>, mod) % mod;<span class="comment">//æ±‚é€†å…ƒ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">while</span> (n -- )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (LL)fact[a] * infact[b] % mod * infact[a - b] % mod);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="è¯¢é—®å¾ˆå°‘-a-bå¾ˆå¤§-lucaså®šç†"><a href="#è¯¢é—®å¾ˆå°‘-a-bå¾ˆå¤§-lucaså®šç†" class="headerlink" title="è¯¢é—®å¾ˆå°‘ a,bå¾ˆå¤§(lucaså®šç†)"></a>è¯¢é—®å¾ˆå°‘ a,bå¾ˆå¤§(lucaså®šç†)</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % p;</span><br><span class="line">        a = (LL)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b &gt; a) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, j = a; i &lt;= b; i ++, j -- )</span><br><span class="line">    &#123;</span><br><span class="line">        res = (LL)res * j % p;</span><br><span class="line">        res = (LL)res * <span class="built_in">qmi</span>(i, p - <span class="number">2</span>, p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lucas</span><span class="params">(LL a, LL b, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="keyword">return</span> <span class="built_in">C</span>(a, b, p);</span><br><span class="line">    <span class="keyword">return</span> (LL)<span class="built_in">C</span>(a % p, b % p, p) * <span class="built_in">lucas</span>(a / p, b / p, p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (n -- )</span><br><span class="line">    &#123;</span><br><span class="line">        LL a, b;</span><br><span class="line">        <span class="type">int</span> p;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; p;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">lucas</span>(a, b, p) &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ç­”æ¡ˆå¾ˆå¤§ä½†ä¸èƒ½æ±‚æ¨¡"><a href="#ç­”æ¡ˆå¾ˆå¤§ä½†ä¸èƒ½æ±‚æ¨¡" class="headerlink" title="ç­”æ¡ˆå¾ˆå¤§ä½†ä¸èƒ½æ±‚æ¨¡"></a>ç­”æ¡ˆå¾ˆå¤§ä½†ä¸èƒ½æ±‚æ¨¡</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> primes[N], cnt;</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="comment">//çº¿æ€§ç­›æ¨¡ç‰ˆ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt ++ ] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; j ++ )</span><br><span class="line">        &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ±‚nçš„é˜¶ä¹˜é‡Œè´¨å› å­pçš„ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        res += n / p;</span><br><span class="line">        n /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é«˜ç²¾åº¦æ¨¡ç‰ˆ</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        t += a[i] * b;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (t)</span><br><span class="line">    &#123;</span><br><span class="line">        c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">get_primes</span>(a);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )<span class="comment">//æšä¸¾æ¯ä¸€ä¸ªè´¨æ•°</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> p = primes[i];</span><br><span class="line">        sum[i] = <span class="built_in">get</span>(a, p) - <span class="built_in">get</span>(a - b, p) - <span class="built_in">get</span>(b, p);<span class="comment">//å½“å‰è´¨æ•°çš„ä¸ªæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">    res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”¨é«˜ç²¾åº¦ä¹˜æ³•æŠŠè´¨å› å­ä¹˜èµ·æ¥</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )<span class="comment">//æšä¸¾æ‰€æœ‰è´¨æ•°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; sum[i]; j ++ )<span class="comment">//æšä¸¾æ‰€æœ‰è´¨æ•°çš„æ¬¡æ•°</span></span><br><span class="line">            res = <span class="built_in">mul</span>(res, primes[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = res.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, res[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å¡ç‰¹å…°æ•°"><a href="#å¡ç‰¹å…°æ•°" class="headerlink" title="å¡ç‰¹å…°æ•°"></a>å¡ç‰¹å…°æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">100010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % p;</span><br><span class="line">        a = (LL)a * a % p;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> a = n * <span class="number">2</span>, b = n;</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = a; i &gt; a - b; i -- ) res = (LL)res * i % mod;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= b; i ++ ) res = (LL)res * <span class="built_in">qmi</span>(i, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line"></span><br><span class="line">    res = (LL)res * <span class="built_in">qmi</span>(n + <span class="number">1</span>, mod - <span class="number">2</span>, mod) % mod;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ”¾çƒé—®é¢˜"><a href="#æ”¾çƒé—®é¢˜" class="headerlink" title="æ”¾çƒé—®é¢˜"></a>æ”¾çƒé—®é¢˜</h3><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201172258072.png" alt="image-20211203091207912"></p>
<h2 id="é«˜æ–¯æ¶ˆå…ƒ"><a href="#é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒ"></a>é«˜æ–¯æ¶ˆå…ƒ</h2><h3 id="æ•´å‹"><a href="#æ•´å‹" class="headerlink" title="æ•´å‹"></a>æ•´å‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[N][N];<span class="comment">//å¢å¹¿çŸ©é˜µ</span></span><br><span class="line"><span class="type">int</span> x[N];<span class="comment">//è§£é›†</span></span><br><span class="line"><span class="type">bool</span> freeX[N];<span class="comment">//æ ‡è®°æ˜¯å¦ä¸ºè‡ªç”±å˜å…ƒ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GCD</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !b?a:<span class="built_in">GCD</span>(b,a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCM</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a/<span class="built_in">GCD</span>(a,b)*b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Gauss</span><span class="params">(<span class="type">int</span> equ,<span class="type">int</span> var)</span></span>&#123;<span class="comment">//è¿”å›è‡ªç”±å˜å…ƒä¸ªæ•°</span></span><br><span class="line">    <span class="comment">/*åˆå§‹åŒ–*/</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=var;i++)&#123;</span><br><span class="line">        x[i]=<span class="number">0</span>;</span><br><span class="line">        freeX[i]=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*è½¬æ¢ä¸ºé˜¶æ¢¯é˜µ*/</span></span><br><span class="line">    <span class="type">int</span> col=<span class="number">0</span>;<span class="comment">//å½“å‰å¤„ç†çš„åˆ—</span></span><br><span class="line">    <span class="type">int</span> row;<span class="comment">//å½“å‰å¤„ç†çš„è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span>(row=<span class="number">0</span>;row&lt;equ&amp;&amp;col&lt;var;row++,col++)&#123;<span class="comment">//æšä¸¾å½“å‰å¤„ç†çš„è¡Œ</span></span><br><span class="line">        <span class="type">int</span> maxRow=row;<span class="comment">//å½“å‰åˆ—ç»å¯¹å€¼æœ€å¤§çš„è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=row+<span class="number">1</span>;i&lt;equ;i++)&#123;<span class="comment">//å¯»æ‰¾å½“å‰åˆ—ç»å¯¹å€¼æœ€å¤§çš„è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(a[i][col])&gt;<span class="built_in">abs</span>(a[maxRow][col]))</span><br><span class="line">                maxRow=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(maxRow!=row)&#123;<span class="comment">//ä¸ç¬¬rowè¡Œäº¤æ¢</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=row;j&lt;var+<span class="number">1</span>;j++)</span><br><span class="line">                <span class="built_in">swap</span>(a[row][j],a[maxRow][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a[row][col]==<span class="number">0</span>)&#123;<span class="comment">//colåˆ—ç¬¬rowè¡Œä»¥ä¸‹å…¨æ˜¯0ï¼Œå¤„ç†å½“å‰è¡Œçš„ä¸‹ä¸€åˆ—</span></span><br><span class="line">            row--;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=row+<span class="number">1</span>;i&lt;equ;i++)&#123;<span class="comment">//æšä¸¾è¦åˆ å»çš„è¡Œ</span></span><br><span class="line">            <span class="keyword">if</span>(a[i][col]!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="type">int</span> lcm=<span class="built_in">LCM</span>(<span class="built_in">abs</span>(a[i][col]),<span class="built_in">abs</span>(a[row][col]));</span><br><span class="line">                <span class="type">int</span> ta=lcm/<span class="built_in">abs</span>(a[i][col]);</span><br><span class="line">                <span class="type">int</span> tb=lcm/<span class="built_in">abs</span>(a[row][col]);</span><br><span class="line">                <span class="keyword">if</span>(a[i][col]*a[row][col]&lt;<span class="number">0</span>)<span class="comment">//å¼‚å·æƒ…å†µç›¸åŠ </span></span><br><span class="line">                    tb=-tb;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=col;j&lt;var+<span class="number">1</span>;j++) &#123;</span><br><span class="line">                    a[i][j]=a[i][j]*ta-a[row][j]*tb;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/*æ±‚è§£*/</span></span><br><span class="line">    <span class="comment">//æ— è§£ï¼šåŒ–ç®€çš„å¢å¹¿é˜µä¸­å­˜åœ¨(0,0,...,a)è¿™æ ·çš„è¡Œï¼Œä¸”a!=0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=row;i&lt;equ;i++)</span><br><span class="line">        <span class="keyword">if</span> (a[i][col]!=<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//æ— ç©·è§£: åœ¨var*(var+1)çš„å¢å¹¿é˜µä¸­å‡ºç°(0,0,...,0)è¿™æ ·çš„è¡Œ</span></span><br><span class="line">    <span class="type">int</span> temp=var-row;<span class="comment">//è‡ªç”±å˜å…ƒæœ‰var-rowä¸ª</span></span><br><span class="line">    <span class="keyword">if</span>(row&lt;var)<span class="comment">//è¿”å›è‡ªç”±å˜å…ƒæ•°</span></span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//å”¯ä¸€è§£: åœ¨var*(var+1)çš„å¢å¹¿é˜µä¸­å½¢æˆä¸¥æ ¼çš„ä¸Šä¸‰è§’é˜µ</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=var<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;<span class="comment">//è®¡ç®—è§£é›†</span></span><br><span class="line">        <span class="type">int</span> temp=a[i][var];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;var;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i][j]!=<span class="number">0</span>)</span><br><span class="line">                temp-=a[i][j]*x[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(temp%a[i][i]!=<span class="number">0</span>)<span class="comment">//æœ‰æµ®ç‚¹æ•°è§£ï¼Œæ— æ•´æ•°è§£</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">-2</span>;</span><br><span class="line">        x[i]=temp/a[i][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> equ,var;<span class="comment">//equä¸ªæ–¹ç¨‹ï¼Œvarä¸ªå˜å…ƒ</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;equ,&amp;var)!=EOF) &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="built_in">sizeof</span>(a));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;equ;i++)<span class="comment">//è¾“å…¥å¢å¹¿çŸ©é˜µ</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;var+<span class="number">1</span>;j++)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i][j]);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        <span class="type">int</span> freeNum=<span class="built_in">Gauss</span>(equ,var);<span class="comment">//è‡ªç”±å…ƒä¸ªæ•°</span></span><br><span class="line">        <span class="keyword">if</span>(freeNum==<span class="number">-1</span>)<span class="comment">//æ— è§£</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ— è§£\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(freeNum==<span class="number">-2</span>)<span class="comment">//æœ‰æµ®ç‚¹æ•°è§£æ— æ•´æ•°è§£</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ— æ•´æ•°è§£\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(freeNum&gt;<span class="number">0</span>)&#123;<span class="comment">//æœ‰æ— ç©·å¤šè§£</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æœ‰æ— ç©·å¤šè§£ï¼Œè‡ªç”±å˜å…ƒä¸ªæ•°ä¸º%d\n&quot;</span>,freeNum);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;var;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(freeX[i])</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;x%dæ˜¯è‡ªç”±å˜å…ƒ\n&quot;</span>,i+<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;x%d=%d\n&quot;</span>,i+<span class="number">1</span>,x[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;<span class="comment">//æœ‰å”¯ä¸€è§£</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;var;i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;x%d=%d\n&quot;</span>,i+<span class="number">1</span>,x[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="æµ®ç‚¹å‹"><a href="#æµ®ç‚¹å‹" class="headerlink" title="æµ®ç‚¹å‹"></a>æµ®ç‚¹å‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">double</span> a[N][N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> c, r;</span><br><span class="line">  <span class="comment">//æ¶ˆæˆä¸Šä¸‰è§’çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c ++ )<span class="comment">//æšä¸¾æ¯ä¸€åˆ—</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; <span class="built_in">fabs</span>(a[t][c]))<span class="comment">//æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„é‚£ä¸€è¡Œ</span></span><br><span class="line">                t = i;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[t][c]) &lt; eps) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt; n + <span class="number">1</span>; i ++ ) <span class="built_in">swap</span>(a[t][i], a[r][i]);<span class="comment">//æŠŠç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œæ¢åˆ°æœ€ä¸Šé¢</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n; i &gt;= c; i -- ) a[r][i] /= a[r][c];<span class="comment">//æŠŠè¯¥è¡Œç¬¬ä¸€ä¸ªæ•°å˜æˆ1-&gt;å€’ç€æ›´æ–°,ä¸ç„¶ç¬¬ä¸€ä¸ªæ•°å…ˆè¢«æ›´æ–°æˆ1é™¤åé¢çš„æ•°å°±æ— æ•ˆäº†</span></span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][c]) &gt; eps)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt;= c; j -- )</span><br><span class="line">                    a[i][j] -= a[r][j] * a[i][c];<span class="comment">//æŠŠä¸‹è¾¹æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0</span></span><br><span class="line"></span><br><span class="line">        r ++ ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i ++ )</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(a[i][n]) &gt; eps)<span class="comment">//å‡ºç°äº†0=é0çš„æƒ…å†µ</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//æ— è§£</span></span><br><span class="line">        <span class="keyword">return</span> n-r;<span class="comment">//å¤šç»„è§£,è¿”å›è‡ªç”±å…ƒä¸ªæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">		<span class="comment">//æ¶ˆæˆå¯¹è§’çº¿çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j ++ )<span class="comment">//å€’ç€æŠŠå…¶ä»–ç³»æ•°å…¨éƒ¨æ¶ˆæˆ0ï¼ˆè§£æ‰€åœ¨ä½ç½®çš„ç³»æ•°æ˜¯1ï¼‰</span></span><br><span class="line">            a[i][n] -= a[j][n] * a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//å”¯ä¸€è§£</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j ++ )</span><br><span class="line">            cin &gt;&gt; a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, a[i][n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (t == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Infinite group solutions&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„"><a href="#é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„"></a>é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[N][N];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> c, r;</span><br><span class="line">    <span class="keyword">for</span> (c = <span class="number">0</span>, r = <span class="number">0</span>; c &lt; n; c++) &#123;</span><br><span class="line">        <span class="type">int</span> t = r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                t = i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!a[t][c]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = c; i &lt; n + <span class="number">1</span>; i++) <span class="built_in">swap</span>(a[r][i], a[t][i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; i++)<span class="comment">//å°†ä¸‹é¢æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—æ¶ˆæˆ0</span></span><br><span class="line">            <span class="keyword">if</span> (a[i][c])</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = n; j &gt;= c; j--)</span><br><span class="line">                    a[i][j] ^= a[r][j];<span class="comment">//è¯¥è¡Œç¬¬cåˆ—è‚¯å®šæ˜¯1ï¼Œæ‰€ä»¥ä¸‹é¢è¡Œå¼‚æˆ–è¯¥è¡Œç¬¬cåˆ—è‚¯å®šå¯ä»¥æ¶ˆæˆ0ï¼ˆä¸¤ä¸ª1å¼‚æˆ–ï¼‰</span></span><br><span class="line"></span><br><span class="line">        r++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (r &lt; n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span> (a[i][n])</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//æ— è§£</span></span><br><span class="line">        <span class="keyword">return</span> n-r;<span class="comment">//å¤šç»„è§£,è¿”å›è‡ªç”±å…ƒä¸ªæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">            a[i][n] ^= a[i][j] &amp; a[j][n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//å”¯ä¸€è§£</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j++)</span><br><span class="line">            cin &gt;&gt; a[i][j];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) cout &lt;&lt; a[i][n] &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t &gt;<span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">&quot;Multiple sets of solutions&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="ç”¨é«˜æ–¯æ¶ˆå…ƒæŠŠè¡Œåˆ—å¼åŒ–æˆä¸Šä¸‰è§’è¡Œåˆ—å¼å†æ±‚è§£-O-N-3"><a href="#ç”¨é«˜æ–¯æ¶ˆå…ƒæŠŠè¡Œåˆ—å¼åŒ–æˆä¸Šä¸‰è§’è¡Œåˆ—å¼å†æ±‚è§£-O-N-3" class="headerlink" title="ç”¨é«˜æ–¯æ¶ˆå…ƒæŠŠè¡Œåˆ—å¼åŒ–æˆä¸Šä¸‰è§’è¡Œåˆ—å¼å†æ±‚è§£$O(N^3)$"></a>ç”¨é«˜æ–¯æ¶ˆå…ƒæŠŠè¡Œåˆ—å¼åŒ–æˆä¸Šä¸‰è§’è¡Œåˆ—å¼å†æ±‚è§£$O(N^3)$</h3><h4 id="å–æ¨¡-æ²¡æœ‰è´Ÿæ•°è§£"><a href="#å–æ¨¡-æ²¡æœ‰è´Ÿæ•°è§£" class="headerlink" title="å–æ¨¡(æ²¡æœ‰è´Ÿæ•°è§£)"></a>å–æ¨¡(æ²¡æœ‰è´Ÿæ•°è§£)</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">ll A[<span class="number">110</span>][<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll n, ll mod)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>) ans = ans * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">quick_pow</span>(a, mod - <span class="number">2</span>, mod);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gauss</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(A[j][i])&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = i; k &lt;= n; k++) <span class="built_in">swap</span>(A[i][k], A[j][k]);</span><br><span class="line">                <span class="keyword">if</span>(i != j) ans = -ans;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!A[i][i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll j = i + <span class="number">1</span>, iv = <span class="built_in">inv</span>(A[i][i]); j &lt;= n; j++) &#123;</span><br><span class="line">                ll t = A[j][i] * iv % mod;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = i; k &lt;= n; k++)</span><br><span class="line">                    A[j][k] = (A[j][k] - t * A[i][k] % mod + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = (ans * A[i][i] % mod + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="double-æœ‰è´Ÿæ•°è§£"><a href="#double-æœ‰è´Ÿæ•°è§£" class="headerlink" title="double(æœ‰è´Ÿæ•°è§£)"></a>double(æœ‰è´Ÿæ•°è§£)</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Gauss1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="type">int</span> p=i;</span><br><span class="line">        <span class="keyword">while</span>(!f[p][i] <span class="keyword">and</span> p&lt;=n)p++;</span><br><span class="line">        <span class="keyword">if</span>(p&gt;=n+<span class="number">1</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(p!=i)<span class="built_in">swap</span>(f[i],f[p]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">double</span> tmp=f[j][i]/f[i][i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=i;k&lt;=n;k++)</span><br><span class="line">            f[j][k]-=f[i][k]*tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    ans*=f[i][i];</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">int</span>)(ans+<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="äºŒåˆ†æ¨¡ç‰ˆ"><a href="#äºŒåˆ†æ¨¡ç‰ˆ" class="headerlink" title="äºŒåˆ†æ¨¡ç‰ˆ"></a>äºŒåˆ†æ¨¡ç‰ˆ</h2><h3 id="ç­”æ¡ˆåœ¨å·¦åŒºé—´ä¸­"><a href="#ç­”æ¡ˆåœ¨å·¦åŒºé—´ä¸­" class="headerlink" title="ç­”æ¡ˆåœ¨å·¦åŒºé—´ä¸­"></a>ç­”æ¡ˆåœ¨å·¦åŒºé—´ä¸­</h3><ul>
<li>å½“æˆ‘ä»¬å°†åŒºé—´$[l, r]$åˆ’åˆ†æˆ$[l, mid]$å’Œ$[mid + 1, r]$æ—¶ï¼Œå…¶æ›´æ–°æ“ä½œæ˜¯$r &#x3D; mid$æˆ–è€…$l &#x3D; mid + 1$;ï¼Œè®¡ç®—midæ—¶ä¸éœ€è¦åŠ 1ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (l &lt; r)</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) r = mid;</span><br><span class="line">       <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h3 id="ç­”æ¡ˆåœ¨å³åŒºé—´ä¸­"><a href="#ç­”æ¡ˆåœ¨å³åŒºé—´ä¸­" class="headerlink" title="ç­”æ¡ˆåœ¨å³åŒºé—´ä¸­"></a>ç­”æ¡ˆåœ¨å³åŒºé—´ä¸­</h3><ul>
<li>å½“æˆ‘ä»¬å°†åŒºé—´$[l, r]$åˆ’åˆ†æˆ$[l, mid - 1]$å’Œ$[mid, r]$æ—¶ï¼Œå…¶æ›´æ–°æ“ä½œæ˜¯$r &#x3D; mid - 1$æˆ–è€…$l &#x3D; mid$;ï¼Œæ­¤æ—¶ä¸ºäº†é˜²æ­¢æ­»å¾ªç¯ï¼Œè®¡ç®—midæ—¶éœ€è¦åŠ 1ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (l &lt; r)</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="type">int</span> mid = l + r + <span class="number">1</span> &gt;&gt; <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">if</span> (<span class="built_in">check</span>(mid)) l = mid;</span><br><span class="line">       <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201172258069.png" alt="image-20210507215948279"></p>
<p>çº¢è‰²åŒºé—´</p>
<h2 id="ä¸‰åˆ†"><a href="#ä¸‰åˆ†" class="headerlink" title="ä¸‰åˆ†"></a>ä¸‰åˆ†</h2><p><a href="https://blog.csdn.net/deletewo/article/details/104102359">https://blog.csdn.net/deletewo/article/details/104102359</a></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p>ä¸‰åˆ†ç®—æ³•é€‚ç”¨äºæ±‚è§£å‡¸æ€§å‡½æ•°çš„æå€¼é—®é¢˜ï¼ŒäºŒæ¬¡å‡½æ•°å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å•å³°å‡½æ•°ã€‚</p>
<p>äºŒåˆ†åˆ©ç”¨çš„æ˜¯å‡½æ•°çš„å•è°ƒæ€§ï¼Œä¸‰åˆ†ç®—æ³•åˆ©ç”¨çš„æ˜¯å‡½æ•°çš„å•å³°æ€§ã€‚</p>
<img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/20211108215723.png" alt="20200128205206158" style="zoom:50%;" />

<p>åœ¨åŒºé—´$[l,r]$ï¼Œä»¤$m1 &#x3D; l + (r-l)&#x2F;3, m2 &#x3D; r - (r-l)&#x2F;3$ï¼Œåˆ†åˆ«ä½äº1&#x2F;3ã€2&#x2F;3å¤„ï¼Œæ¥ç€è®¡ç®—è¿™ä¸¤ä¸ªç‚¹çš„å‡½æ•°å€¼ï¼Œ</p>
<p>å¦‚æœ$f(m1)&gt;f(m2)$,æ±‚è§£åŒºé—´æœ‰$[l,r]$å˜ä¸º$[l,m2]$ã€‚ï¼ˆå°±æ˜¯å°†æœ€æ¥è¿‘æå€¼ç‚¹é‚£ä¸ªmç‚¹ä¿ç•™ï¼Œç„¶å é‡æ–°åˆ’åˆ†åŒºé—´ï¼‰</p>
<p><strong>æ­¤å¤–ä¸‰åˆ†ç®—æ³•ä¹Ÿå¼ºè°ƒä¸¥æ ¼çš„å•è°ƒæ€§ï¼Œå‡ºç°å‡½æ•°å€¼ç›¸ç­‰çš„åŒºé—´å°±ä¸é€‚ç”¨äº†ã€‚</strong></p>
<h3 id="æµ®ç‚¹æ•°"><a href="#æµ®ç‚¹æ•°" class="headerlink" title="æµ®ç‚¹æ•°"></a>æµ®ç‚¹æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> l = <span class="number">0</span>,r = <span class="number">10000</span>;</span><br><span class="line"><span class="keyword">while</span>(r-l&gt;=<span class="number">1e-9</span>)&#123;<span class="comment">//ç²¾åº¦é—®é¢˜</span></span><br><span class="line">    <span class="type">double</span> m1 = l + (r-l)/<span class="number">3.0</span>,m2 = r - (r-l)/<span class="number">3.0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))<span class="comment">//å‡¸å‡½æ•°ï¼Œå‡¹å‡½æ•°æŠŠç¬¦å·åè¿‡æ¥å°±è¡Œ</span></span><br><span class="line">        l = m1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r = m2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ•´æ•°"><a href="#æ•´æ•°" class="headerlink" title="æ•´æ•°"></a>æ•´æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(r-l&gt;=<span class="number">10</span>)&#123;</span><br><span class="line">    <span class="type">int</span> m1=l+(r-l)/<span class="number">3</span>,m2=r-(r-l)/<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">f</span>(m1)&lt;<span class="built_in">f</span>(m2))&#123;</span><br><span class="line">        l = m1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r = m2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;i++)&#123;<span class="comment">//æš´åŠ›æšä¸¾ç²¾åº¦åŒºé—´</span></span><br><span class="line">    ans=<span class="built_in">min</span>(ans,<span class="built_in">f</span>(i));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="ä¸€äº›ç»“è®º"><a href="#ä¸€äº›ç»“è®º" class="headerlink" title="ä¸€äº›ç»“è®º"></a>ä¸€äº›ç»“è®º</h2><p>a+b&#x3D;(a&amp;b)+(a|b)</p>
<h2 id="Miller-Rabin"><a href="#Miller-Rabin" class="headerlink" title="Miller- Rabin"></a>Miller- Rabin</h2><p>ä¸€èˆ¬åº•æ•°ä»ç„¶æ˜¯éšæœºé€‰å–ï¼Œä½†å½“å¾…æµ‹æ•°ä¸å¤ªå¤§æ—¶ï¼Œé€‰æ‹©æµ‹è¯•åº•æ•°å°±æœ‰ä¸€äº›æŠ€å·§äº†ã€‚æ¯”å¦‚ï¼Œå¦‚æœ è¢«æµ‹æ•°å°äº4 759 123 141ï¼Œé‚£ä¹ˆåªéœ€è¦æµ‹è¯•ä¸‰ä¸ªåº•æ•°2,  7å’Œ61å°±è¶³å¤Ÿäº†ã€‚å½“ç„¶ï¼Œä½ æµ‹è¯•çš„è¶Šå¤šï¼Œæ­£ç¡®çš„èŒƒå›´è‚¯å®šä¹Ÿè¶Šå¤§ã€‚å¦‚æœä½ æ¯æ¬¡éƒ½ç”¨å‰7ä¸ªç´ æ•°(2, 3, 5, 7, 11,  13å’Œ17)è¿›è¡Œæµ‹è¯•ï¼Œæ‰€æœ‰ä¸è¶…è¿‡341 550 071 728 320çš„æ•°éƒ½æ˜¯æ­£ç¡®çš„ã€‚å¦‚æœé€‰ç”¨2, 3, 7,  61å’Œ24251ä½œä¸ºåº•æ•°ï¼Œé‚£ä¹ˆ10^16å†…å”¯ä¸€çš„å¼ºä¼ªç´ æ•°ä¸º46 856 248 255  981ã€‚è¿™æ ·çš„ä¸€äº›ç»“è®ºä½¿å¾—Miller-Rabinç®—æ³•åœ¨OIä¸­éå¸¸å®ç”¨ã€‚é€šå¸¸è®¤ä¸ºï¼ŒMiller-Rabinç´ æ€§æµ‹è¯•çš„æ­£ç¡®ç‡å¯ä»¥ä»¤äººæ¥å—ï¼Œéšæœºé€‰å– kä¸ªåº•æ•°è¿›è¡Œæµ‹è¯•ç®—æ³•çš„å¤±è¯¯ç‡å¤§æ¦‚ä¸º4^(-k)ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/15/Reinhart's%20algorithm%20template/" data-id="cmb2ap95b000n48uc4jnl6opd" data-title="Reinhart&#39;s algorithm template" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">ä¸ªäºº</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-èƒŒåŒ…é—®é¢˜æ±‡æ€»" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/21/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/" class="article-date">
  <time class="dt-published" datetime="2020-11-21T05:41:25.000Z" itemprop="datePublished">2020-11-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/11/21/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/">èƒŒåŒ…é—®é¢˜æ±‡æ€»</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="0-1èƒŒåŒ…"><a href="#0-1èƒŒåŒ…" class="headerlink" title="0-1èƒŒåŒ…"></a>0-1èƒŒåŒ…</h2><h4 id="é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-2"><a href="#é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-2" class="headerlink" title="é¢˜ç›®ï¼šhttps://www.acwing.com/problem/content/2/"></a>é¢˜ç›®ï¼š<a href="https://www.acwing.com/problem/content/2/">https://www.acwing.com/problem/content/2/</a></h4><h4 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><p>$$<br>dp[i][j]æ„æ€æ˜¯åªæ”¾å‰iä¸ªç‰©å“åœ¨æ€»ä½“ç§¯æ˜¯jçš„æƒ…å†µä¸‹çš„ç‰©å“çš„è´¡çŒ®<br>$$</p>
<ul>
<li>æ˜“å¾—çŠ¶æ€æ–¹ç¨‹ä¸ºï¼š</li>
</ul>
<p>$$<br>dp[i][j]&#x3D;max(dp[i-1][j],dp[i-1][j-v[i]+w[i]])<br>$$</p>
<p>$$<br>dp[i][j]&#x3D;dp[i-1][j]æ„æ€æ˜¯ä¸é€‰ç¬¬iä¸ªç‰©å“ï¼ˆdp[i][j]ç›´æ¥åŸå°ä¸åŠ¨ä¿ç•™ä¸Šä¸€ä¸ªiçš„çŠ¶æ€ï¼‰<br>$$</p>
<h4 id="ä»£ç å¦‚ä¸‹ï¼š"><a href="#ä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="ä»£ç å¦‚ä¸‹ï¼š"></a>ä»£ç å¦‚ä¸‹ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> n,m,v[<span class="number">1005</span>],w[<span class="number">1005</span>],dp[<span class="number">1005</span>][<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j =<span class="number">0</span>; j &lt;=m ; ++j) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];<span class="comment">//ä¸æ”¾</span></span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v[i]) <span class="comment">//è¦å½“å‰èƒŒåŒ…çš„æ€»ä½“ç§¯å¤§äºv[i]æ‰èƒ½æŠŠiç‰©å“æ”¾è¿›èƒŒåŒ…</span></span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[i - <span class="number">1</span>][j - v[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    for (int i = 1; i &lt;=n ; ++i) &#123;</span></span><br><span class="line"><span class="comment">//        for (int j = 0; j &lt;=m ; ++j) &#123;</span></span><br><span class="line"><span class="comment">//            cout&lt;&lt;dp[i][j]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        cout&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;=m ; ++i) &#123;</span><br><span class="line">        res=<span class="built_in">max</span>(res,dp[n][i]); <span class="comment">//dp[n]æ„æ€æ˜¯å°†nä¸ªç‰©å“éƒ½æƒè¡¡åˆ©å¼Šåé€‰æ‹©nä¸ªç‰©å“ä¸­çš„éƒ¨åˆ†æ”¾å…¥èƒŒåŒ…ï¼ˆä¸è¶…è¿‡èƒŒåŒ…æœ€å¤§å®¹é‡ï¼‰,</span></span><br><span class="line">    &#125;													 <span class="comment">//ä½†ä¸çŸ¥é“è¿™äº›ç‰©å“çš„æ€»ä½“ç§¯æ˜¯å¤šå°‘ï¼Œæ‰€ä»¥éå†æ‰€æœ‰å¯èƒ½çš„ä½“ç§¯è¾“å‡ºä»·å€¼æœ€å¤§å€¼å³ä¸ºç­”æ¡ˆã€‚</span></span><br><span class="line">    cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>æµ‹è¯•æ•°æ®ï¼š</li>
</ul>
<p><strong>4 5</strong><br><strong>1 2</strong><br><strong>2 4</strong><br><strong>3 4</strong><br><strong>4 5</strong></p>
<ul>
<li>dpæ•°ç»„å†…å®¹ï¼š</li>
</ul>
<p><strong>0 2 2 2 2 2</strong><br><strong>0 2 4 6 6 6</strong><br><strong>0 2 4 6 6 8</strong><br><strong>0 2 4 6 6 8</strong></p>
<ul>
<li>æœ€åè¾“å‡ºï¼š8</li>
</ul>
<h4 id="ä¼˜åŒ–åçš„ä»£ç ï¼š"><a href="#ä¼˜åŒ–åçš„ä»£ç ï¼š" class="headerlink" title="ä¼˜åŒ–åçš„ä»£ç ï¼š"></a>ä¼˜åŒ–åçš„ä»£ç ï¼š</h4><p>&#x3D;&#x3D;åªç”¨äº†ä¸€ç»´&#x3D;&#x3D;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> n,m,v[<span class="number">1005</span>],w[<span class="number">1005</span>],dp[<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j =m; j &gt;=v[i] ; --j) &#123; <span class="comment">//jä»å¤§åˆ°å°å¾ªç¯æ˜¯ä¸ºäº†è®©dp[j-v[i]]çš„å€¼æ˜¯ä¸Šä¸€å±‚içš„å€¼</span></span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j], dp[j - v[i]] + w[i]);<span class="comment">//(dp[j-v[i]]åäºdp[j]æ›´æ–°)</span></span><br><span class="line">            <span class="comment">//cout&lt;&lt;dp[j]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout&lt;&lt;endl;</span></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[m];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>dpæ•°ç»„å†…å®¹ï¼š</li>
</ul>
<p><strong>2 2 2 2 2</strong><br><strong>6 6 6 4</strong><br><strong>8 6 6</strong><br><strong>8 6</strong><br><strong>8</strong></p>
<p>&#x3D;&#x3D;æ³¨:è‹¥è¦æ±‚è¾¾åˆ°æœ€å¤§ä»·å€¼æ—¶çš„æœ€å¤§ä½“ç§¯(æ°å¥½)éœ€å°†åˆå§‹åŒ–dp[N]&#x3D;{0}æ”¹ä¸ºdp[0]&#x3D;0ï¼Œå‰©ä½™dpä¸º-INF;	ansä»ç›´æ¥è¾“å‡ºdp[m]å˜ä¸ºmax(dp[0â€¦m]).&#x3D;&#x3D;</p>
<p>â€‹	</p>
<h4 id="çŠ¶æ€æ–¹ç¨‹çš„è¯¦ç»†æ±‚è§£è¿‡ç¨‹ï¼š"><a href="#çŠ¶æ€æ–¹ç¨‹çš„è¯¦ç»†æ±‚è§£è¿‡ç¨‹ï¼š" class="headerlink" title="çŠ¶æ€æ–¹ç¨‹çš„è¯¦ç»†æ±‚è§£è¿‡ç¨‹ï¼š"></a>çŠ¶æ€æ–¹ç¨‹çš„è¯¦ç»†æ±‚è§£è¿‡ç¨‹ï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181346007.jpg" alt="acwingç®—æ³•ç¬”è®°æœ¬-2"></p>
<h4 id="äºŒç»´ä¼˜åŒ–æˆä¸€ç»´çš„æ¨å¯¼ï¼š"><a href="#äºŒç»´ä¼˜åŒ–æˆä¸€ç»´çš„æ¨å¯¼ï¼š" class="headerlink" title="äºŒç»´ä¼˜åŒ–æˆä¸€ç»´çš„æ¨å¯¼ï¼š"></a>äºŒç»´ä¼˜åŒ–æˆä¸€ç»´çš„æ¨å¯¼ï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181346017.jpeg" alt="IMG_988F8EF4F15E-1"></p>
<h2 id="å®Œå…¨èƒŒåŒ…"><a href="#å®Œå…¨èƒŒåŒ…" class="headerlink" title="å®Œå…¨èƒŒåŒ…"></a>å®Œå…¨èƒŒåŒ…</h2><h4 id="é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-3"><a href="#é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-3" class="headerlink" title="é¢˜ç›®ï¼šhttps://www.acwing.com/problem/content/3/"></a>é¢˜ç›®ï¼š<a href="https://www.acwing.com/problem/content/3/">https://www.acwing.com/problem/content/3/</a></h4><p>$dp[i][j]$åŒæ ·ä¹Ÿæ˜¯è¡¨ç¤ºä»å‰iä¸ªç‰©å“ä¸­é€‰ï¼Œæ€»ä½“ç§¯ä¸è¶…è¿‡jçš„æ–¹æ¡ˆé›†åˆï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å®Œå…¨èƒŒåŒ…é—®é¢˜ä¸­æ¯ä¸ªç‰©å“éƒ½å¯ä»¥å–æ— é™ä¸ª</p>
<p>æ‰€ä»¥å¯å¾—åˆ°ï¼š<br>$$<br>dp[i][j]&#x3D;max(dp[i-1][j],dp[i-1][j-v[i]]+w[i],dp[i-1][j-2<em>v[i]]+2</em>w[i],â€¦)â€‹<br>$$<br>æŒ‰é“ç†æ¥è¯´éœ€è¦ä¸‰å±‚å¾ªç¯ï¼Œä½†æ˜¯å¯ä»¥è¢«ä¼˜åŒ–æˆäºŒå±‚å¾ªç¯ï¼š<br>$$<br>dp[i][j]&#x3D;max(dp[i-1][j],dp[i][j-v[i]]+w[i]ï¼‰â€‹<br>$$</p>
<h4 id="å…·ä½“è¯æ˜ï¼š"><a href="#å…·ä½“è¯æ˜ï¼š" class="headerlink" title="å…·ä½“è¯æ˜ï¼š"></a>å…·ä½“è¯æ˜ï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181346600.jpg"></p>
<h4 id="ä»£ç å¦‚ä¸‹ï¼š-1"><a href="#ä»£ç å¦‚ä¸‹ï¼š-1" class="headerlink" title="ä»£ç å¦‚ä¸‹ï¼š"></a>ä»£ç å¦‚ä¸‹ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">ll n,m,dp[<span class="number">1005</span>][<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n,m,v[<span class="number">1005</span>],w[<span class="number">1005</span>];</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=m;j++)&#123;</span><br><span class="line">            dp[i][j]=dp[i<span class="number">-1</span>][j];</span><br><span class="line">            <span class="keyword">if</span>(j&gt;=v[i])dp[i][j]=<span class="built_in">max</span>(dp[i][j],dp[i][j-v[i]]+w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[n][m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="äºŒç»´ä¼˜åŒ–æˆä¸€ç»´ï¼š"><a href="#äºŒç»´ä¼˜åŒ–æˆä¸€ç»´ï¼š" class="headerlink" title="äºŒç»´ä¼˜åŒ–æˆä¸€ç»´ï¼š"></a>äºŒç»´ä¼˜åŒ–æˆä¸€ç»´ï¼š</h4><p>$$<br>dp[i][j]&#x3D;max(dp[i-1][j],dp[i][j-v[i]]+w[i]ï¼‰â€‹\to dp[j]&#x3D;max(dp[j],dp[j-v[i]]+w[i])<br>$$</p>
<p>ä¸0-1èƒŒåŒ…ä¸åŒçš„æ˜¯ï¼Œ0-1èƒŒåŒ…çš„$dp[j-v[i]]$å¯¹åº”çš„æ˜¯iä¸Šä¸€å±‚ä¹Ÿå°±æ˜¯i-1å±‚çš„å€¼ï¼Œè€Œè¿™é‡Œçš„$dp[i][j-v[i]]$è¦æ±‚å¯¹åº”æœ¬å±‚içš„å€¼ï¼Œä¹Ÿå°±æ˜¯è®©$dp[j-v[i]]$å…ˆæ›´æ–°å†æ›´æ–°$dp[j]$ï¼Œæ‰€ä»¥æŠŠjä»å¤§åˆ°å°å¾ªç¯æ”¹ä¸ºä»å°åˆ°å¤§å¾ªç¯å³å¯ã€‚</p>
<h4 id="ä¼˜åŒ–åçš„ä»£ç ï¼š-1"><a href="#ä¼˜åŒ–åçš„ä»£ç ï¼š-1" class="headerlink" title="ä¼˜åŒ–åçš„ä»£ç ï¼š"></a>ä¼˜åŒ–åçš„ä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">ll n,m,dp[<span class="number">1005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n,m,v[<span class="number">1005</span>],w[<span class="number">1005</span>];</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)cin&gt;&gt;v[i]&gt;&gt;w[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=v[i];j&lt;=m;j++)&#123;</span><br><span class="line">            dp[j]=<span class="built_in">max</span>(dp[j],dp[j-v[i]]+w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="å¤šé‡èƒŒåŒ…"><a href="#å¤šé‡èƒŒåŒ…" class="headerlink" title="å¤šé‡èƒŒåŒ…"></a>å¤šé‡èƒŒåŒ…</h2><h4 id="é¢˜ç›®-æ•°æ®èŒƒå›´å°-ï¼šhttps-www-acwing-com-problem-content-4"><a href="#é¢˜ç›®-æ•°æ®èŒƒå›´å°-ï¼šhttps-www-acwing-com-problem-content-4" class="headerlink" title="é¢˜ç›®(æ•°æ®èŒƒå›´å°)ï¼šhttps://www.acwing.com/problem/content/4/"></a>é¢˜ç›®(æ•°æ®èŒƒå›´å°)ï¼š<a href="https://www.acwing.com/problem/content/4/">https://www.acwing.com/problem/content/4/</a></h4><h4 id="æœ´ç´ åšæ³•-ä¸‰ç»´-ï¼š"><a href="#æœ´ç´ åšæ³•-ä¸‰ç»´-ï¼š" class="headerlink" title="æœ´ç´ åšæ³•(ä¸‰ç»´)ï¼š"></a>æœ´ç´ åšæ³•(ä¸‰ç»´)ï¼š</h4><p>å¤šä¸€ç»´éå†ç¬¬iä¸ªç‰©å“é€‰$0ï½s[i]$ä¸ªçš„æ‰€æœ‰æƒ…å†µ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="type">int</span> v[<span class="number">105</span>],w[<span class="number">105</span>],s[<span class="number">105</span>],dp[<span class="number">105</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="comment">//memset(dp,0,105);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        cin&gt;&gt;v[i]&gt;&gt;w[i]&gt;&gt;s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = m; j &gt;=v[i] ; --j) &#123;</span><br><span class="line">            <span class="comment">//cout&lt;&lt;dp[j]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;=s[i] ; ++k) &#123;</span><br><span class="line">                <span class="keyword">if</span>(j&gt;=k*v[i])dp[j]=<span class="built_in">max</span>(dp[j],dp[j-k*v[i]]+k*w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout&lt;&lt;&#x27;\n&#x27;;</span></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[m]&lt;&lt;endl;</span><br><span class="line"><span class="comment">//    for (int i = 0; i &lt;=m ; ++i) &#123;</span></span><br><span class="line"><span class="comment">//        cout&lt;&lt;dp[i]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="é¢˜ç›®-æ•°æ®èŒƒå›´å¤§-ï¼šhttps-www-acwing-com-problem-content-5"><a href="#é¢˜ç›®-æ•°æ®èŒƒå›´å¤§-ï¼šhttps-www-acwing-com-problem-content-5" class="headerlink" title="é¢˜ç›®(æ•°æ®èŒƒå›´å¤§)ï¼šhttps://www.acwing.com/problem/content/5/"></a>é¢˜ç›®(æ•°æ®èŒƒå›´å¤§)ï¼š<a href="https://www.acwing.com/problem/content/5/">https://www.acwing.com/problem/content/5/</a></h4><p>æ€è€ƒåˆ°å¤šé‡èƒŒåŒ…é—®é¢˜å¯ä»¥å°†æ¯ä¸ªç‰©å“æ‹†å¼€ç„¶åé‡æ–°å­˜å…¥æ•°ç»„é‡Œï¼Œä½†å¦‚æœç›´æ¥æ‹†å¼€æ ¹æ®æ•°æ®èŒƒå›´$s<em>N</em>V&#x3D;2000<em>1000</em>2000&#x3D;2*10^9$</p>
<p>è¿˜æ˜¯ä¼šè¶…è¿‡æ—¶é—´é™åˆ¶ï¼Œæ‰€ä»¥è€ƒè™‘åˆ°å°†ç‰©å“é€šè¿‡äºŒè¿›åˆ¶çš„æ–¹æ³•æ‹†è§£ï¼šå‡å¦‚æŸç‰©å“æœ‰7ä»¶ç”¨1ï¼Œ2ï¼Œ4å°±å¯ä»¥è¡¨ç¤ºå…¨éƒ¨å¯èƒ½ã€‚æ‰€ä»¥å¾—å‡ºsä»¶ç‰©å“åªéœ€è¦$\lceil log(s) \rceil$çš„æ—¶é—´ï¼Œæ‰€ä»¥å°±æ˜¯$11<em>1000</em>2000\approx2*10^7$ï¼Œå¯ä»¥åœ¨è§„å®šæ—¶é—´å†…é€šè¿‡ã€‚ä½†åœ¨å…·ä½“å®ç°ä¸­è¿˜ä¼šæœ‰é—®é¢˜ï¼Œå‡å¦‚æŸç‰©å“æœ‰10ä»¶ï¼Œä¸èƒ½ç›´æ¥ç”¨1ï¼Œ2ï¼Œ4ï¼Œ8è¡¨ç¤ºï¼Œå› ä¸º1ï¼Œ2ï¼Œ4ï¼Œ8å¯ä»¥è¡¨ç¤º1ï½15ï¼Œè€Œ11ï½15ä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚æ‰€ä»¥é‡‡å–ä¸€ä¸ªç­–ç•¥ï¼šç”¨så‡å»1ï¼Œ2ï¼Œ4â€¦å½“s&lt;0çš„æ—¶å€™åœæ­¢ï¼Œå¹¶å°†æœ€åå‰©ä½™çš„é‚£ä¸ªæ•°å­˜è¿›æ•°ç»„ã€‚å‡å¦‚10ï¼Œ$10-1-2-4&#x3D;3$ï¼Œæ‰€ä»¥å°±å°†1ï¼Œ2ï¼Œ4ï¼Œ3å­˜å…¥æ•°ç»„ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">struc</span> &#123;</span><br><span class="line">    <span class="type">int</span> v, w;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> v[<span class="number">2005</span>], w[<span class="number">2005</span>], s[<span class="number">2005</span>], dp[<span class="number">2005</span>];</span><br><span class="line">vector&lt;struc&gt; vec;  <span class="comment">//ç”¨ç»“æ„ä½“çŸ¢é‡å­˜æ‹†å¼€çš„ç‰©å“çš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="comment">//memset(dp,0,105);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cin &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= s[i]; k *= <span class="number">2</span>) &#123;</span><br><span class="line">            s[i] -= k;</span><br><span class="line">            vec.<span class="built_in">push_back</span>(&#123;k * v[i], k * w[i]&#125;);</span><br><span class="line">            <span class="comment">//cout&lt;&lt;k&lt;&lt;&#x27; &#x27;&lt;&lt;&quot;s[i]&quot;&lt;&lt;s[i]&lt;&lt;&#x27; &#x27;;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//cout&lt;&lt;endl;</span></span><br><span class="line">        <span class="keyword">if</span> (s[i] &gt; <span class="number">0</span>)vec.<span class="built_in">push_back</span>(&#123;s[i] * v[i], s[i] * w[i]&#125;);  <span class="comment">//å°†å‰©ä¸‹çš„é‚£ä¸ªæ•°å­˜è¿›çŸ¢é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vec.<span class="built_in">size</span>(); ++i) &#123;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = m; j &gt;= vec[i].v; --j) &#123;</span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j], dp[j - vec[i].v] + vec[i].w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; dp[m] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="åˆ†ç»„èƒŒåŒ…"><a href="#åˆ†ç»„èƒŒåŒ…" class="headerlink" title="åˆ†ç»„èƒŒåŒ…"></a>åˆ†ç»„èƒŒåŒ…</h2><h4 id="é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-9"><a href="#é¢˜ç›®ï¼šhttps-www-acwing-com-problem-content-9" class="headerlink" title="é¢˜ç›®ï¼šhttps://www.acwing.com/problem/content/9/"></a>é¢˜ç›®ï¼š<a href="https://www.acwing.com/problem/content/9/">https://www.acwing.com/problem/content/9/</a></h4><h4 id="è§£æï¼š"><a href="#è§£æï¼š" class="headerlink" title="è§£æï¼š"></a>è§£æï¼š<img src="https://cdn.jsdelivr.net/gh/reinhart-l/FigureBed/2021/202201181346823.jpeg" alt="701A36AD-E016-4371-A8B8-E8A9C82BC085_1_105_c"></h4><h4 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> n,m,dp[<span class="number">105</span>],s[<span class="number">105</span>],v[<span class="number">105</span>][<span class="number">105</span>],w[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        cin&gt;&gt;s[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;=s[i] ; ++j) &#123;</span><br><span class="line">            cin&gt;&gt;v[i][j]&gt;&gt;w[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;=n ; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = m; j &gt;=<span class="number">0</span> ; --j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;=s[i] ; ++k) &#123;</span><br><span class="line">                <span class="keyword">if</span>(v[i][k]&lt;=j)dp[j]=<span class="built_in">max</span>(dp[j],dp[j-v[i][k]]+w[i][k]); <span class="comment">//éå†ç¬¬iç»„ç‰©å“ä¸­çš„æ‰€æœ‰å¯èƒ½</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;dp[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/21/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/" data-id="cmb2ap95p001y48uc1pqyc8ik" data-title="èƒŒåŒ…é—®é¢˜æ±‡æ€»" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">æ•™ç¨‹</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPC/" rel="tag">NPC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA/" rel="tag">ä¸ªäºº</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">æ•™ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">è®¡ç®—æœºç½‘ç»œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A2%98%E8%A7%A3/" rel="tag">é¢˜è§£</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 14px;">AI</a> <a href="/tags/NPC/" style="font-size: 14px;">NPC</a> <a href="/tags/hexo/" style="font-size: 12px;">hexo</a> <a href="/tags/%E4%B8%AA%E4%BA%BA/" style="font-size: 18px;">ä¸ªäºº</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 16px;">æ•™ç¨‹</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 14px;">ç®—æ³•</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">è®¡ç®—æœºç½‘ç»œ</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 20px;">é¢˜è§£</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/05/">May 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/01/">January 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/05/24/LARP%20LANGUAGE-AGENT%20ROLE%20PLAY%20FOR%20OPEN-WORLD%20GAMES/">LARP LANGUAGE-AGENT ROLE PLAY FOR OPEN-WORLD GAMES</a>
          </li>
        
          <li>
            <a href="/2025/05/24/saga_translation_with_images/">SAGA é¢å‘ä»£ç†çš„æŠ€èƒ½åˆ°è¡ŒåŠ¨ç”Ÿæˆæ¡†æ¶</a>
          </li>
        
          <li>
            <a href="/2025/01/16/%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%B0%8F%E9%95%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">æ–¯å¦ç¦å°é•‡é˜…è¯»ç¬”è®°</a>
          </li>
        
          <li>
            <a href="/2023/11/08/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86%E7%82%B9/">è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ç‚¹</a>
          </li>
        
          <li>
            <a href="/2023/11/08/%E6%B8%B8%E6%88%8F%E7%A0%94%E5%8F%91%E5%9C%BA%E6%99%AF%E9%A2%98/">æ¸¸æˆç ”å‘åœºæ™¯é¢˜</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Reinhart<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>